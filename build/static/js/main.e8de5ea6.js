/*! For license information please see main.e8de5ea6.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,r)=>{var n=r(853),a=r(43),s=r(950);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(l(e)!==e)throw Error(i(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var f=Object.assign,m=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),x=Symbol.for("react.consumer"),w=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),T=Symbol.for("react.lazy");Symbol.for("react.scope");var N=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var j=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var A=Symbol.iterator;function C(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=A&&e[A]||e["@@iterator"])?e:null}var O=Symbol.for("react.client.reference");function P(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===O?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case v:return"Fragment";case y:return"Profiler";case b:return"StrictMode";case _:return"Suspense";case E:return"SuspenseList";case N:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case w:return e.displayName||"Context";case x:return(e._context.displayName||"Context")+".Consumer";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case k:return null!==(t=e.displayName||null)?t:P(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return P(e(t))}catch(r){}}return null}var R=Array.isArray,I=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},M=[],F=-1;function U(e){return{current:e}}function z(e){0>F||(e.current=M[F],M[F]=null,F--)}function B(e,t){F++,M[F]=e.current,e.current=t}var H,W,V=U(null),G=U(null),q=U(null),K=U(null);function $(e,t){switch(B(q,t),B(G,e),B(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?vd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=bd(t=vd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}z(V),B(V,e)}function Y(){z(V),z(G),z(q)}function J(e){null!==e.memoizedState&&B(K,e);var t=V.current,r=bd(t,e.type);t!==r&&(B(G,e),B(V,r))}function X(e){G.current===e&&(z(V),z(G)),K.current===e&&(z(K),uh._currentValue=L)}function Q(e){if(void 0===H)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);H=t&&t[1]||"",W=-1<r.stack.indexOf("\n    at")?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+H+e+W}var Z=!1;function ee(e,t){if(!e||Z)return"";Z=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(t){var r=function(){throw Error()};if(Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(r,[])}catch(a){var n=a}Reflect.construct(e,[],r)}else{try{r.call()}catch(s){n=s}e.call(r.prototype)}}else{try{throw Error()}catch(i){n=i}(r=e())&&"function"===typeof r.catch&&r.catch(function(){})}}catch(o){if(o&&n&&"string"===typeof o.stack)return[o.stack,n.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=n.DetermineComponentFrameRoot(),i=s[0],o=s[1];if(i&&o){var l=i.split("\n"),c=o.split("\n");for(a=n=0;n<l.length&&!l[n].includes("DetermineComponentFrameRoot");)n++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(n===l.length||a===c.length)for(n=l.length-1,a=c.length-1;1<=n&&0<=a&&l[n]!==c[a];)a--;for(;1<=n&&0<=a;n--,a--)if(l[n]!==c[a]){if(1!==n||1!==a)do{if(n--,0>--a||l[n]!==c[a]){var u="\n"+l[n].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=n&&0<=a);break}}}finally{Z=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?Q(r):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return Q(e.type);case 16:return Q("Lazy");case 13:return e.child!==t&&null!==t?Q("Suspense Fallback"):Q("Suspense");case 19:return Q("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return Q("Activity");default:return""}}function re(e){try{var t="",r=null;do{t+=te(e,r),r=e,e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}var ne=Object.prototype.hasOwnProperty,ae=n.unstable_scheduleCallback,se=n.unstable_cancelCallback,ie=n.unstable_shouldYield,oe=n.unstable_requestPaint,le=n.unstable_now,ce=n.unstable_getCurrentPriorityLevel,ue=n.unstable_ImmediatePriority,de=n.unstable_UserBlockingPriority,he=n.unstable_NormalPriority,fe=n.unstable_LowPriority,me=n.unstable_IdlePriority,pe=n.log,ge=n.unstable_setDisableYieldValue,ve=null,be=null;function ye(e){if("function"===typeof pe&&ge(e),be&&"function"===typeof be.setStrictMode)try{be.setStrictMode(ve,e)}catch(t){}}var xe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(we(e)/Se|0)|0},we=Math.log,Se=Math.LN2;var _e=256,Ee=262144,ke=4194304;function Te(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ne(e,t,r){var n=e.pendingLanes;if(0===n)return 0;var a=0,s=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var o=134217727&n;return 0!==o?0!==(n=o&~s)?a=Te(n):0!==(i&=o)?a=Te(i):r||0!==(r=o&~e)&&(a=Te(r)):0!==(o=n&~s)?a=Te(o):0!==i?a=Te(i):r||0!==(r=n&~e)&&(a=Te(r)),0===a?0:0!==t&&t!==a&&0===(t&s)&&((s=a&-a)>=(r=t&-t)||32===s&&0!==(4194048&r))?t:a}function je(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Ae(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ce(){var e=ke;return 0===(62914560&(ke<<=1))&&(ke=4194304),e}function Oe(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Pe(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Re(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var n=31-xe(t);e.entangledLanes|=t,e.entanglements[n]=1073741824|e.entanglements[n]|261930&r}function Ie(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-xe(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}function De(e,t){var r=t&-t;return 0!==((r=0!==(42&r)?1:Le(r))&(e.suspendedLanes|t))?0:r}function Le(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Me(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Fe(){var e=D.p;return 0!==e?e:void 0===(e=window.event)?32:Th(e.type)}function Ue(e,t){var r=D.p;try{return D.p=e,t()}finally{D.p=r}}var ze=Math.random().toString(36).slice(2),Be="__reactFiber$"+ze,He="__reactProps$"+ze,We="__reactContainer$"+ze,Ve="__reactEvents$"+ze,Ge="__reactListeners$"+ze,qe="__reactHandles$"+ze,Ke="__reactResources$"+ze,$e="__reactMarker$"+ze;function Ye(e){delete e[Be],delete e[He],delete e[Ve],delete e[Ge],delete e[qe]}function Je(e){var t=e[Be];if(t)return t;for(var r=e.parentNode;r;){if(t=r[We]||r[Be]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=Ld(e);null!==e;){if(r=e[Be])return r;e=Ld(e)}return t}r=(e=r).parentNode}return null}function Xe(e){if(e=e[Be]||e[We]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Qe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(i(33))}function Ze(e){var t=e[Ke];return t||(t=e[Ke]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[$e]=!0}var tt=new Set,rt={};function nt(e,t){at(e,t),at(e+"Capture",t)}function at(e,t){for(rt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var st=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),it={},ot={};function lt(e,t,r){if(a=t,ne.call(ot,a)||!ne.call(it,a)&&(st.test(a)?ot[a]=!0:(it[a]=!0,0)))if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var n=t.toLowerCase().slice(0,5);if("data-"!==n&&"aria-"!==n)return void e.removeAttribute(t)}e.setAttribute(t,""+r)}var a}function ct(e,t,r){if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+r)}}function ut(e,t,r,n){if(null===n)e.removeAttribute(r);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(r)}e.setAttributeNS(t,r,""+n)}}function dt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ft(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=function(e,t,r){var n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function mt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=ht(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function pt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function vt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function bt(e,t,r,n,a,s,i,o){e.name="",null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i?e.type=i:e.removeAttribute("type"),null!=t?"number"===i?(0===t&&""===e.value||e.value!=t)&&(e.value=""+dt(t)):e.value!==""+dt(t)&&(e.value=""+dt(t)):"submit"!==i&&"reset"!==i||e.removeAttribute("value"),null!=t?xt(e,i,dt(t)):null!=r?xt(e,i,dt(r)):null!=n&&e.removeAttribute("value"),null==a&&null!=s&&(e.defaultChecked=!!s),null!=a&&(e.checked=a&&"function"!==typeof a&&"symbol"!==typeof a),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+dt(o):e.removeAttribute("name")}function yt(e,t,r,n,a,s,i,o){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=r){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return void ft(e);r=null!=r?""+dt(r):"",t=null!=t?""+dt(t):r,o||t===e.value||(e.value=t),e.defaultValue=t}n="function"!==typeof(n=null!=n?n:a)&&"symbol"!==typeof n&&!!n,e.checked=o?e.checked:!!n,e.defaultChecked=!!n,null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.name=i),ft(e)}function xt(e,t,r){"number"===t&&pt(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function wt(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+dt(r),t=null,a=0;a<e.length;a++){if(e[a].value===r)return e[a].selected=!0,void(n&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function St(e,t,r){null==t||((t=""+dt(t))!==e.value&&(e.value=t),null!=r)?e.defaultValue=null!=r?""+dt(r):"":e.defaultValue!==t&&(e.defaultValue=t)}function _t(e,t,r,n){if(null==t){if(null!=n){if(null!=r)throw Error(i(92));if(R(n)){if(1<n.length)throw Error(i(93));n=n[0]}r=n}null==r&&(r=""),t=r}r=dt(t),e.defaultValue=r,(n=e.textContent)===r&&""!==n&&null!==n&&(e.value=n),ft(e)}function Et(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var kt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tt(e,t,r){var n=0===t.indexOf("--");null==r||"boolean"===typeof r||""===r?n?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":n?e.setProperty(t,r):"number"!==typeof r||0===r||kt.has(t)?"float"===t?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function Nt(e,t,r){if(null!=t&&"object"!==typeof t)throw Error(i(62));if(e=e.style,null!=r){for(var n in r)!r.hasOwnProperty(n)||null!=t&&t.hasOwnProperty(n)||(0===n.indexOf("--")?e.setProperty(n,""):"float"===n?e.cssFloat="":e[n]="");for(var a in t)n=t[a],t.hasOwnProperty(a)&&r[a]!==n&&Tt(e,a,n)}else for(var s in t)t.hasOwnProperty(s)&&Tt(e,s,t[s])}function jt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var At=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ct=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ot(e){return Ct.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Pt(){}var Rt=null;function It(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Dt=null,Lt=null;function Mt(e){var t=Xe(e);if(t&&(e=t.stateNode)){var r=e[He]||null;e:switch(e=t.stateNode,t.type){case"input":if(bt(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+vt(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=n[He]||null;if(!a)throw Error(i(90));bt(n,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<r.length;t++)(n=r[t]).form===e.form&&mt(n)}break e;case"textarea":St(e,r.value,r.defaultValue);break e;case"select":null!=(t=r.value)&&wt(e,!!r.multiple,t,!1)}}}var Ft=!1;function Ut(e,t,r){if(Ft)return e(t,r);Ft=!0;try{return e(t)}finally{if(Ft=!1,(null!==Dt||null!==Lt)&&(Zc(),Dt&&(t=Dt,e=Lt,Lt=Dt=null,Mt(t),e)))for(t=0;t<e.length;t++)Mt(e[t])}}function zt(e,t){var r=e.stateNode;if(null===r)return null;var n=r[He]||null;if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(i(231,t,typeof r));return r}var Bt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Ht=!1;if(Bt)try{var Wt={};Object.defineProperty(Wt,"passive",{get:function(){Ht=!0}}),window.addEventListener("test",Wt,Wt),window.removeEventListener("test",Wt,Wt)}catch(Xh){Ht=!1}var Vt=null,Gt=null,qt=null;function Kt(){if(qt)return qt;var e,t,r=Gt,n=r.length,a="value"in Vt?Vt.value:Vt.textContent,s=a.length;for(e=0;e<n&&r[e]===a[e];e++);var i=n-e;for(t=1;t<=i&&r[n-t]===a[s-t];t++);return qt=a.slice(e,1<t?1-t:void 0)}function $t(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Yt(){return!0}function Jt(){return!1}function Xt(e){function t(t,r,n,a,s){for(var i in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=a,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Yt:Jt,this.isPropagationStopped=Jt,this}return f(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Yt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Yt)},persist:function(){},isPersistent:Yt}),t}var Qt,Zt,er,tr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rr=Xt(tr),nr=f({},tr,{view:0,detail:0}),ar=Xt(nr),sr=f({},nr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==er&&(er&&"mousemove"===e.type?(Qt=e.screenX-er.screenX,Zt=e.screenY-er.screenY):Zt=Qt=0,er=e),Qt)},movementY:function(e){return"movementY"in e?e.movementY:Zt}}),ir=Xt(sr),or=Xt(f({},sr,{dataTransfer:0})),lr=Xt(f({},nr,{relatedTarget:0})),cr=Xt(f({},tr,{animationName:0,elapsedTime:0,pseudoElement:0})),ur=Xt(f({},tr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),dr=Xt(f({},tr,{data:0})),hr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=mr[e])&&!!t[e]}function gr(){return pr}var vr=Xt(f({},nr,{key:function(e){if(e.key){var t=hr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=$t(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gr,charCode:function(e){return"keypress"===e.type?$t(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?$t(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),br=Xt(f({},sr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),yr=Xt(f({},nr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gr})),xr=Xt(f({},tr,{propertyName:0,elapsedTime:0,pseudoElement:0})),wr=Xt(f({},sr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Sr=Xt(f({},tr,{newState:0,oldState:0})),_r=[9,13,27,32],Er=Bt&&"CompositionEvent"in window,kr=null;Bt&&"documentMode"in document&&(kr=document.documentMode);var Tr=Bt&&"TextEvent"in window&&!kr,Nr=Bt&&(!Er||kr&&8<kr&&11>=kr),jr=String.fromCharCode(32),Ar=!1;function Cr(e,t){switch(e){case"keyup":return-1!==_r.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Or(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Pr=!1;var Rr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ir(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Rr[e.type]:"textarea"===t}function Dr(e,t,r,n){Dt?Lt?Lt.push(n):Lt=[n]:Dt=n,0<(t=nd(t,"onChange")).length&&(r=new rr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Lr=null,Mr=null;function Fr(e){Yu(e,0)}function Ur(e){if(mt(Qe(e)))return e}function zr(e,t){if("change"===e)return t}var Br=!1;if(Bt){var Hr;if(Bt){var Wr="oninput"in document;if(!Wr){var Vr=document.createElement("div");Vr.setAttribute("oninput","return;"),Wr="function"===typeof Vr.oninput}Hr=Wr}else Hr=!1;Br=Hr&&(!document.documentMode||9<document.documentMode)}function Gr(){Lr&&(Lr.detachEvent("onpropertychange",qr),Mr=Lr=null)}function qr(e){if("value"===e.propertyName&&Ur(Mr)){var t=[];Dr(t,Mr,e,It(e)),Ut(Fr,t)}}function Kr(e,t,r){"focusin"===e?(Gr(),Mr=r,(Lr=t).attachEvent("onpropertychange",qr)):"focusout"===e&&Gr()}function $r(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Ur(Mr)}function Yr(e,t){if("click"===e)return Ur(t)}function Jr(e,t){if("input"===e||"change"===e)return Ur(t)}var Xr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Qr(e,t){if(Xr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!ne.call(t,a)||!Xr(e[a],t[a]))return!1}return!0}function Zr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function en(e,t){var r,n=Zr(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Zr(n)}}function tn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?tn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function rn(e){for(var t=pt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=pt((e=t.contentWindow).document)}return t}function nn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var an=Bt&&"documentMode"in document&&11>=document.documentMode,sn=null,on=null,ln=null,cn=!1;function un(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;cn||null==sn||sn!==pt(n)||("selectionStart"in(n=sn)&&nn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},ln&&Qr(ln,n)||(ln=n,0<(n=nd(on,"onSelect")).length&&(t=new rr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=sn)))}function dn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var hn={animationend:dn("Animation","AnimationEnd"),animationiteration:dn("Animation","AnimationIteration"),animationstart:dn("Animation","AnimationStart"),transitionrun:dn("Transition","TransitionRun"),transitionstart:dn("Transition","TransitionStart"),transitioncancel:dn("Transition","TransitionCancel"),transitionend:dn("Transition","TransitionEnd")},fn={},mn={};function pn(e){if(fn[e])return fn[e];if(!hn[e])return e;var t,r=hn[e];for(t in r)if(r.hasOwnProperty(t)&&t in mn)return fn[e]=r[t];return e}Bt&&(mn=document.createElement("div").style,"AnimationEvent"in window||(delete hn.animationend.animation,delete hn.animationiteration.animation,delete hn.animationstart.animation),"TransitionEvent"in window||delete hn.transitionend.transition);var gn=pn("animationend"),vn=pn("animationiteration"),bn=pn("animationstart"),yn=pn("transitionrun"),xn=pn("transitionstart"),wn=pn("transitioncancel"),Sn=pn("transitionend"),_n=new Map,En="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kn(e,t){_n.set(e,t),nt(t,[e])}En.push("scrollEnd");var Tn="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Nn=[],jn=0,An=0;function Cn(){for(var e=jn,t=An=jn=0;t<e;){var r=Nn[t];Nn[t++]=null;var n=Nn[t];Nn[t++]=null;var a=Nn[t];Nn[t++]=null;var s=Nn[t];if(Nn[t++]=null,null!==n&&null!==a){var i=n.pending;null===i?a.next=a:(a.next=i.next,i.next=a),n.pending=a}0!==s&&In(r,a,s)}}function On(e,t,r,n){Nn[jn++]=e,Nn[jn++]=t,Nn[jn++]=r,Nn[jn++]=n,An|=n,e.lanes|=n,null!==(e=e.alternate)&&(e.lanes|=n)}function Pn(e,t,r,n){return On(e,t,r,n),Dn(e)}function Rn(e,t){return On(e,null,null,t),Dn(e)}function In(e,t,r){e.lanes|=r;var n=e.alternate;null!==n&&(n.lanes|=r);for(var a=!1,s=e.return;null!==s;)s.childLanes|=r,null!==(n=s.alternate)&&(n.childLanes|=r),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(a=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,a&&null!==t&&(a=31-xe(r),null===(n=(e=s.hiddenUpdates)[a])?e[a]=[t]:n.push(t),t.lane=536870912|r),s):null}function Dn(e){if(50<Vc)throw Vc=0,Gc=null,Error(i(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Ln={};function Mn(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(e,t,r,n){return new Mn(e,t,r,n)}function Un(e){return!(!(e=e.prototype)||!e.isReactComponent)}function zn(e,t){var r=e.alternate;return null===r?((r=Fn(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=65011712&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function Bn(e,t){e.flags&=65011714;var r=e.alternate;return null===r?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Hn(e,t,r,n,a,s){var o=0;if(n=e,"function"===typeof e)Un(e)&&(o=1);else if("string"===typeof e)o=function(e,t,r){if(1===r||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,r,V.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case N:return(e=Fn(31,r,t,a)).elementType=N,e.lanes=s,e;case v:return Wn(r.children,a,s,t);case b:o=8,a|=24;break;case y:return(e=Fn(12,r,t,2|a)).elementType=y,e.lanes=s,e;case _:return(e=Fn(13,r,t,a)).elementType=_,e.lanes=s,e;case E:return(e=Fn(19,r,t,a)).elementType=E,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case w:o=10;break e;case x:o=9;break e;case S:o=11;break e;case k:o=14;break e;case T:o=16,n=null;break e}o=29,r=Error(i(130,null===e?"null":typeof e,"")),n=null}return(t=Fn(o,r,t,a)).elementType=e,t.type=n,t.lanes=s,t}function Wn(e,t,r,n){return(e=Fn(7,e,n,t)).lanes=r,e}function Vn(e,t,r){return(e=Fn(6,e,null,t)).lanes=r,e}function Gn(e){var t=Fn(18,null,null,0);return t.stateNode=e,t}function qn(e,t,r){return(t=Fn(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Kn=new WeakMap;function $n(e,t){if("object"===typeof e&&null!==e){var r=Kn.get(e);return void 0!==r?r:(t={value:e,source:t,stack:re(t)},Kn.set(e,t),t)}return{value:e,source:t,stack:re(t)}}var Yn=[],Jn=0,Xn=null,Qn=0,Zn=[],ea=0,ta=null,ra=1,na="";function aa(e,t){Yn[Jn++]=Qn,Yn[Jn++]=Xn,Xn=e,Qn=t}function sa(e,t,r){Zn[ea++]=ra,Zn[ea++]=na,Zn[ea++]=ta,ta=e;var n=ra;e=na;var a=32-xe(n)-1;n&=~(1<<a),r+=1;var s=32-xe(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,ra=1<<32-xe(t)+a|r<<a|n,na=s+e}else ra=1<<s|r<<a|n,na=e}function ia(e){null!==e.return&&(aa(e,1),sa(e,1,0))}function oa(e){for(;e===Xn;)Xn=Yn[--Jn],Yn[Jn]=null,Qn=Yn[--Jn],Yn[Jn]=null;for(;e===ta;)ta=Zn[--ea],Zn[ea]=null,na=Zn[--ea],Zn[ea]=null,ra=Zn[--ea],Zn[ea]=null}function la(e,t){Zn[ea++]=ra,Zn[ea++]=na,Zn[ea++]=ta,ra=t.id,na=t.overflow,ta=e}var ca=null,ua=null,da=!1,ha=null,fa=!1,ma=Error(i(519));function pa(e){throw wa($n(Error(i(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),ma}function ga(e){var t=e.stateNode,r=e.type,n=e.memoizedProps;switch(t[Be]=e,t[He]=n,r){case"dialog":Ju("cancel",t),Ju("close",t);break;case"iframe":case"object":case"embed":Ju("load",t);break;case"video":case"audio":for(r=0;r<Ku.length;r++)Ju(Ku[r],t);break;case"source":Ju("error",t);break;case"img":case"image":case"link":Ju("error",t),Ju("load",t);break;case"details":Ju("toggle",t);break;case"input":Ju("invalid",t),yt(t,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0);break;case"select":Ju("invalid",t);break;case"textarea":Ju("invalid",t),_t(t,n.value,n.defaultValue,n.children)}"string"!==typeof(r=n.children)&&"number"!==typeof r&&"bigint"!==typeof r||t.textContent===""+r||!0===n.suppressHydrationWarning||cd(t.textContent,r)?(null!=n.popover&&(Ju("beforetoggle",t),Ju("toggle",t)),null!=n.onScroll&&Ju("scroll",t),null!=n.onScrollEnd&&Ju("scrollend",t),null!=n.onClick&&(t.onclick=Pt),t=!0):t=!1,t||pa(e,!0)}function va(e){for(ca=e.return;ca;)switch(ca.tag){case 5:case 31:case 13:return void(fa=!1);case 27:case 3:return void(fa=!0);default:ca=ca.return}}function ba(e){if(e!==ca)return!1;if(!da)return va(e),da=!0,!1;var t,r=e.tag;if((t=3!==r&&27!==r)&&((t=5===r)&&(t=!("form"!==(t=e.type)&&"button"!==t)||yd(e.type,e.memoizedProps)),t=!t),t&&ua&&pa(e),va(e),13===r){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));ua=Dd(e)}else if(31===r){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));ua=Dd(e)}else 27===r?(r=ua,Td(e.type)?(e=Id,Id=null,ua=e):ua=r):ua=ca?Rd(e.stateNode.nextSibling):null;return!0}function ya(){ua=ca=null,da=!1}function xa(){var e=ha;return null!==e&&(null===Cc?Cc=e:Cc.push.apply(Cc,e),ha=null),e}function wa(e){null===ha?ha=[e]:ha.push(e)}var Sa=U(null),_a=null,Ea=null;function ka(e,t,r){B(Sa,t._currentValue),t._currentValue=r}function Ta(e){e._currentValue=Sa.current,z(Sa)}function Na(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ja(e,t,r,n){var a=e.child;for(null!==a&&(a.return=e);null!==a;){var s=a.dependencies;if(null!==s){var o=a.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=a;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=r,null!==(l=s.alternate)&&(l.lanes|=r),Na(s.return,r,e),n||(o=null);break e}s=l.next}}else if(18===a.tag){if(null===(o=a.return))throw Error(i(341));o.lanes|=r,null!==(s=o.alternate)&&(s.lanes|=r),Na(o,r,e),o=null}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}}function Aa(e,t,r,n){e=null;for(var a=t,s=!1;null!==a;){if(!s)if(0!==(524288&a.flags))s=!0;else if(0!==(262144&a.flags))break;if(10===a.tag){var o=a.alternate;if(null===o)throw Error(i(387));if(null!==(o=o.memoizedProps)){var l=a.type;Xr(a.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(a===K.current){if(null===(o=a.alternate))throw Error(i(387));o.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(null!==e?e.push(uh):e=[uh])}a=a.return}null!==e&&ja(t,e,r,n),t.flags|=262144}function Ca(e){for(e=e.firstContext;null!==e;){if(!Xr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Oa(e){_a=e,Ea=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Pa(e){return Ia(_a,e)}function Ra(e,t){return null===_a&&Oa(e),Ia(e,t)}function Ia(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},null===Ea){if(null===e)throw Error(i(308));Ea=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ea=Ea.next=t;return r}var Da="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},La=n.unstable_scheduleCallback,Ma=n.unstable_NormalPriority,Fa={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ua(){return{controller:new Da,data:new Map,refCount:0}}function za(e){e.refCount--,0===e.refCount&&La(Ma,function(){e.controller.abort()})}var Ba=null,Ha=0,Wa=0,Va=null;function Ga(){if(0===--Ha&&null!==Ba){null!==Va&&(Va.status="fulfilled");var e=Ba;Ba=null,Wa=0,Va=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var qa=I.S;I.S=function(e,t){Rc=le(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Ba){var r=Ba=[];Ha=0,Wa=Hu(),Va={status:"pending",value:void 0,then:function(e){r.push(e)}}}Ha++,t.then(Ga,Ga)}(0,t),null!==qa&&qa(e,t)};var Ka=U(null);function $a(){var e=Ka.current;return null!==e?e:mc.pooledCache}function Ya(e,t){B(Ka,null===t?Ka.current:t.pool)}function Ja(){var e=$a();return null===e?null:{parent:Fa._currentValue,pool:e}}var Xa=Error(i(460)),Qa=Error(i(474)),Za=Error(i(542)),es={then:function(){}};function ts(e){return"fulfilled"===(e=e.status)||"rejected"===e}function rs(e,t,r){switch(void 0===(r=e[r])?e.push(t):r!==t&&(t.then(Pt,Pt),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw is(e=t.reason),e;default:if("string"===typeof t.status)t.then(Pt,Pt);else{if(null!==(e=mc)&&100<e.shellSuspendCounter)throw Error(i(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var r=t;r.status="fulfilled",r.value=e}},function(e){if("pending"===t.status){var r=t;r.status="rejected",r.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw is(e=t.reason),e}throw as=t,Xa}}function ns(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw as=t,Xa;throw t}}var as=null;function ss(){if(null===as)throw Error(i(459));var e=as;return as=null,e}function is(e){if(e===Xa||e===Za)throw Error(i(483))}var os=null,ls=0;function cs(e){var t=ls;return ls+=1,null===os&&(os=[]),rs(os,e,t)}function us(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function ds(e,t){if(t.$$typeof===m)throw Error(i(525));throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function hs(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(e,t){return(e=zn(e,t)).index=0,e.sibling=null,e}function s(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=67108866,r):n:(t.flags|=67108866,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=Vn(r,e.mode,n)).return=e,t):((t=a(t,r)).return=e,t)}function c(e,t,r,n){var s=r.type;return s===v?d(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===T&&ns(s)===t.type)?(us(t=a(t,r.props),r),t.return=e,t):(us(t=Hn(r.type,r.key,r.props,null,e.mode,n),r),t.return=e,t)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=qn(r,e.mode,n)).return=e,t):((t=a(t,r.children||[])).return=e,t)}function d(e,t,r,n,s){return null===t||7!==t.tag?((t=Wn(r,e.mode,n,s)).return=e,t):((t=a(t,r)).return=e,t)}function h(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Vn(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return us(r=Hn(t.type,t.key,t.props,null,e.mode,r),t),r.return=e,r;case g:return(t=qn(t,e.mode,r)).return=e,t;case T:return h(e,t=ns(t),r)}if(R(t)||C(t))return(t=Wn(t,e.mode,r,null)).return=e,t;if("function"===typeof t.then)return h(e,cs(t),r);if(t.$$typeof===w)return h(e,Ra(e,t),r);ds(e,t)}return null}function f(e,t,r,n){var a=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return null!==a?null:l(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return r.key===a?c(e,t,r,n):null;case g:return r.key===a?u(e,t,r,n):null;case T:return f(e,t,r=ns(r),n)}if(R(r)||C(r))return null!==a?null:d(e,t,r,n,null);if("function"===typeof r.then)return f(e,t,cs(r),n);if(r.$$typeof===w)return f(e,t,Ra(e,r),n);ds(e,r)}return null}function m(e,t,r,n,a){if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return l(t,e=e.get(r)||null,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return c(t,e=e.get(null===n.key?r:n.key)||null,n,a);case g:return u(t,e=e.get(null===n.key?r:n.key)||null,n,a);case T:return m(e,t,r,n=ns(n),a)}if(R(n)||C(n))return d(t,e=e.get(r)||null,n,a,null);if("function"===typeof n.then)return m(e,t,r,cs(n),a);if(n.$$typeof===w)return m(e,t,r,Ra(t,n),a);ds(t,n)}return null}function b(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===v&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case p:e:{for(var y=u.key;null!==c;){if(c.key===y){if((y=u.type)===v){if(7===c.tag){r(l,c.sibling),(d=a(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===y||"object"===typeof y&&null!==y&&y.$$typeof===T&&ns(y)===c.type){r(l,c.sibling),us(d=a(c,u.props),u),d.return=l,l=d;break e}r(l,c);break}t(l,c),c=c.sibling}u.type===v?((d=Wn(u.props.children,l.mode,d,u.key)).return=l,l=d):(us(d=Hn(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return o(l);case g:e:{for(y=u.key;null!==c;){if(c.key===y){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){r(l,c.sibling),(d=a(c,u.children||[])).return=l,l=d;break e}r(l,c);break}t(l,c),c=c.sibling}(d=qn(u,l.mode,d)).return=l,l=d}return o(l);case T:return b(l,c,u=ns(u),d)}if(R(u))return function(a,i,o,l){for(var c=null,u=null,d=i,p=i=0,g=null;null!==d&&p<o.length;p++){d.index>p?(g=d,d=null):g=d.sibling;var v=f(a,d,o[p],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(a,d),i=s(v,i,p),null===u?c=v:u.sibling=v,u=v,d=g}if(p===o.length)return r(a,d),da&&aa(a,p),c;if(null===d){for(;p<o.length;p++)null!==(d=h(a,o[p],l))&&(i=s(d,i,p),null===u?c=d:u.sibling=d,u=d);return da&&aa(a,p),c}for(d=n(d);p<o.length;p++)null!==(g=m(d,a,p,o[p],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?p:g.key),i=s(g,i,p),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(a,e)}),da&&aa(a,p),c}(l,c,u,d);if(C(u)){if("function"!==typeof(y=C(u)))throw Error(i(150));return function(a,o,l,c){if(null==l)throw Error(i(151));for(var u=null,d=null,p=o,g=o=0,v=null,b=l.next();null!==p&&!b.done;g++,b=l.next()){p.index>g?(v=p,p=null):v=p.sibling;var y=f(a,p,b.value,c);if(null===y){null===p&&(p=v);break}e&&p&&null===y.alternate&&t(a,p),o=s(y,o,g),null===d?u=y:d.sibling=y,d=y,p=v}if(b.done)return r(a,p),da&&aa(a,g),u;if(null===p){for(;!b.done;g++,b=l.next())null!==(b=h(a,b.value,c))&&(o=s(b,o,g),null===d?u=b:d.sibling=b,d=b);return da&&aa(a,g),u}for(p=n(p);!b.done;g++,b=l.next())null!==(b=m(p,a,g,b.value,c))&&(e&&null!==b.alternate&&p.delete(null===b.key?g:b.key),o=s(b,o,g),null===d?u=b:d.sibling=b,d=b);return e&&p.forEach(function(e){return t(a,e)}),da&&aa(a,g),u}(l,c,u=y.call(u),d)}if("function"===typeof u.then)return b(l,c,cs(u),d);if(u.$$typeof===w)return b(l,c,Ra(l,u),d);ds(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(r(l,c.sibling),(d=a(c,u)).return=l,l=d):(r(l,c),(d=Vn(u,l.mode,d)).return=l,l=d),o(l)):r(l,c)}return function(e,t,r,n){try{ls=0;var a=b(e,t,r,n);return os=null,a}catch(i){if(i===Xa||i===Za)throw i;var s=Fn(29,i,null,e.mode);return s.lanes=n,s.return=e,s}}}var fs=hs(!0),ms=hs(!1),ps=!1;function gs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function bs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ys(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&fc)){var a=n.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),n.pending=t,t=Dn(e),In(e,null,r),t}return On(e,n,t,r),Dn(e)}function xs(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,Ie(e,r)}}function ws(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var a=null,s=null;if(null!==(r=r.firstBaseUpdate)){do{var i={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};null===s?a=s=i:s=s.next=i,r=r.next}while(null!==r);null===s?a=s=t:s=s.next=t}else a=s=t;return r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,callbacks:n.callbacks},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var Ss=!1;function _s(){if(Ss){if(null!==Va)throw Va}}function Es(e,t,r,n){Ss=!1;var a=e.updateQueue;ps=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=a.baseState;for(i=0,u=c=l=null,o=s;;){var h=-536870913&o.lane,m=h!==o.lane;if(m?(gc&h)===h:(n&h)===h){0!==h&&h===Wa&&(Ss=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var p=e,g=o;h=t;var v=r;switch(g.tag){case 1:if("function"===typeof(p=g.payload)){d=p.call(v,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(v,d,h):p)||void 0===h)break e;d=f({},d,h);break e;case 2:ps=!0}}null!==(h=o.callback)&&(e.flags|=64,m&&(e.flags|=8192),null===(m=a.callbacks)?a.callbacks=[h]:m.push(h))}else m={lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=m,l=d):u=u.next=m,i|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(m=o).next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}null===u&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null===s&&(a.shared.lanes=0),Ec|=i,e.lanes=i,e.memoizedState=d}}function ks(e,t){if("function"!==typeof e)throw Error(i(191,e));e.call(t)}function Ts(e,t){var r=e.callbacks;if(null!==r)for(e.callbacks=null,e=0;e<r.length;e++)ks(r[e],t)}var Ns=U(null),js=U(0);function As(e,t){B(js,e=Sc),B(Ns,t),Sc=e|t.baseLanes}function Cs(){B(js,Sc),B(Ns,Ns.current)}function Os(){Sc=js.current,z(Ns),z(js)}var Ps=U(null),Rs=null;function Is(e){var t=e.alternate;B(Us,1&Us.current),B(Ps,e),null===Rs&&(null===t||null!==Ns.current||null!==t.memoizedState)&&(Rs=e)}function Ds(e){B(Us,Us.current),B(Ps,e),null===Rs&&(Rs=e)}function Ls(e){22===e.tag?(B(Us,Us.current),B(Ps,e),null===Rs&&(Rs=e)):Ms()}function Ms(){B(Us,Us.current),B(Ps,Ps.current)}function Fs(e){z(Ps),Rs===e&&(Rs=null),z(Us)}var Us=U(0);function zs(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||Od(r)||Pd(r)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Bs=0,Hs=null,Ws=null,Vs=null,Gs=!1,qs=!1,Ks=!1,$s=0,Ys=0,Js=null,Xs=0;function Qs(){throw Error(i(321))}function Zs(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Xr(e[r],t[r]))return!1;return!0}function ei(e,t,r,n,a,s){return Bs=s,Hs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,I.H=null===e||null===e.memoizedState?go:vo,Ks=!1,s=r(n,a),Ks=!1,qs&&(s=ri(t,r,n,a)),ti(e),s}function ti(e){I.H=po;var t=null!==Ws&&null!==Ws.next;if(Bs=0,Vs=Ws=Hs=null,Gs=!1,Ys=0,Js=null,t)throw Error(i(300));null===e||Ro||null!==(e=e.dependencies)&&Ca(e)&&(Ro=!0)}function ri(e,t,r,n){Hs=e;var a=0;do{if(qs&&(Js=null),Ys=0,qs=!1,25<=a)throw Error(i(301));if(a+=1,Vs=Ws=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}I.H=bo,s=t(r,n)}while(qs);return s}function ni(){var e=I.H,t=e.useState()[0];return t="function"===typeof t.then?ci(t):t,e=e.useState()[0],(null!==Ws?Ws.memoizedState:null)!==e&&(Hs.flags|=1024),t}function ai(){var e=0!==$s;return $s=0,e}function si(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function ii(e){if(Gs){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Gs=!1}Bs=0,Vs=Ws=Hs=null,qs=!1,Ys=$s=0,Js=null}function oi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Vs?Hs.memoizedState=Vs=e:Vs=Vs.next=e,Vs}function li(){if(null===Ws){var e=Hs.alternate;e=null!==e?e.memoizedState:null}else e=Ws.next;var t=null===Vs?Hs.memoizedState:Vs.next;if(null!==t)Vs=t,Ws=e;else{if(null===e){if(null===Hs.alternate)throw Error(i(467));throw Error(i(310))}e={memoizedState:(Ws=e).memoizedState,baseState:Ws.baseState,baseQueue:Ws.baseQueue,queue:Ws.queue,next:null},null===Vs?Hs.memoizedState=Vs=e:Vs=Vs.next=e}return Vs}function ci(e){var t=Ys;return Ys+=1,null===Js&&(Js=[]),e=rs(Js,e,t),t=Hs,null===(null===Vs?t.memoizedState:Vs.next)&&(t=t.alternate,I.H=null===t||null===t.memoizedState?go:vo),e}function ui(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return ci(e);if(e.$$typeof===w)return Pa(e)}throw Error(i(438,String(e)))}function di(e){var t=null,r=Hs.updateQueue;if(null!==r&&(t=r.memoCache),null==t){var n=Hs.alternate;null!==n&&(null!==(n=n.updateQueue)&&(null!=(n=n.memoCache)&&(t={data:n.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===r&&(r={lastEffect:null,events:null,stores:null,memoCache:null},Hs.updateQueue=r),r.memoCache=t,void 0===(r=t.data[t.index]))for(r=t.data[t.index]=Array(e),n=0;n<e;n++)r[n]=j;return t.index++,r}function hi(e,t){return"function"===typeof t?t(e):t}function fi(e){return mi(li(),Ws,e)}function mi(e,t,r){var n=e.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=r;var a=e.baseQueue,s=n.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}t.baseQueue=a=s,n.pending=null}if(s=e.baseState,null===a)e.memoizedState=s;else{var l=o=null,c=null,u=t=a.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(gc&h)===h:(Bs&h)===h){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===Wa&&(d=!0);else{if((Bs&f)===f){u=u.next,f===Wa&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,o=s):c=c.next=h,Hs.lanes|=f,Ec|=f}h=u.action,Ks&&r(s,h),s=u.hasEagerState?u.eagerState:r(s,h)}else f={lane:h,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,o=s):c=c.next=f,Hs.lanes|=h,Ec|=h;u=u.next}while(null!==u&&u!==t);if(null===c?o=s:c.next=l,!Xr(s,e.memoizedState)&&(Ro=!0,d&&null!==(r=Va)))throw r;e.memoizedState=s,e.baseState=o,e.baseQueue=c,n.lastRenderedState=s}return null===a&&(n.lanes=0),[e.memoizedState,n.dispatch]}function pi(e){var t=li(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(null!==a){r.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);Xr(s,t.memoizedState)||(Ro=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function gi(e,t,r){var n=Hs,a=li(),s=da;if(s){if(void 0===r)throw Error(i(407));r=r()}else r=t();var o=!Xr((Ws||a).memoizedState,r);if(o&&(a.memoizedState=r,Ro=!0),a=a.queue,Bi(yi.bind(null,n,a,e),[e]),a.getSnapshot!==t||o||null!==Vs&&1&Vs.memoizedState.tag){if(n.flags|=2048,Li(9,{destroy:void 0},bi.bind(null,n,a,r,t),null),null===mc)throw Error(i(349));s||0!==(127&Bs)||vi(n,t,r)}return r}function vi(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=Hs.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Hs.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function bi(e,t,r,n){t.value=r,t.getSnapshot=n,xi(t)&&wi(e)}function yi(e,t,r){return r(function(){xi(t)&&wi(e)})}function xi(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Xr(e,r)}catch(n){return!0}}function wi(e){var t=Rn(e,2);null!==t&&$c(t,e,2)}function Si(e){var t=oi();if("function"===typeof e){var r=e;if(e=r(),Ks){ye(!0);try{r()}finally{ye(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:e},t}function _i(e,t,r,n){return e.baseState=r,mi(e,Ws,"function"===typeof n?n:hi)}function Ei(e,t,r,n,a){if(ho(e))throw Error(i(485));if(null!==(e=t.action)){var s={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==I.T?r(!0):s.isTransition=!1,n(s),null===(r=t.pending)?(s.next=t.pending=s,ki(t,s)):(s.next=r.next,t.pending=r.next=s)}}function ki(e,t){var r=t.action,n=t.payload,a=e.state;if(t.isTransition){var s=I.T,i={};I.T=i;try{var o=r(a,n),l=I.S;null!==l&&l(i,o),Ti(e,t,o)}catch(c){ji(e,t,c)}finally{null!==s&&null!==i.types&&(s.types=i.types),I.T=s}}else try{Ti(e,t,s=r(a,n))}catch(u){ji(e,t,u)}}function Ti(e,t,r){null!==r&&"object"===typeof r&&"function"===typeof r.then?r.then(function(r){Ni(e,t,r)},function(r){return ji(e,t,r)}):Ni(e,t,r)}function Ni(e,t,r){t.status="fulfilled",t.value=r,Ai(t),e.state=r,null!==(t=e.pending)&&((r=t.next)===t?e.pending=null:(r=r.next,t.next=r,ki(e,r)))}function ji(e,t,r){var n=e.pending;if(e.pending=null,null!==n){n=n.next;do{t.status="rejected",t.reason=r,Ai(t),t=t.next}while(t!==n)}e.action=null}function Ai(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ci(e,t){return t}function Oi(e,t){if(da){var r=mc.formState;if(null!==r){e:{var n=Hs;if(da){if(ua){t:{for(var a=ua,s=fa;8!==a.nodeType;){if(!s){a=null;break t}if(null===(a=Rd(a.nextSibling))){a=null;break t}}a="F!"===(s=a.data)||"F"===s?a:null}if(a){ua=Rd(a.nextSibling),n="F!"===a.data;break e}}pa(n)}n=!1}n&&(t=r[0])}}return(r=oi()).memoizedState=r.baseState=t,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ci,lastRenderedState:t},r.queue=n,r=lo.bind(null,Hs,n),n.dispatch=r,n=Si(!1),s=uo.bind(null,Hs,!1,n.queue),a={state:t,dispatch:null,action:e,pending:null},(n=oi()).queue=a,r=Ei.bind(null,Hs,a,s,r),a.dispatch=r,n.memoizedState=e,[t,r,!1]}function Pi(e){return Ri(li(),Ws,e)}function Ri(e,t,r){if(t=mi(e,t,Ci)[0],e=fi(hi)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var n=ci(t)}catch(i){if(i===Xa)throw Za;throw i}else n=t;var a=(t=li()).queue,s=a.dispatch;return r!==t.memoizedState&&(Hs.flags|=2048,Li(9,{destroy:void 0},Ii.bind(null,a,r),null)),[n,s,e]}function Ii(e,t){e.action=t}function Di(e){var t=li(),r=Ws;if(null!==r)return Ri(t,r,e);li(),t=t.memoizedState;var n=(r=li()).queue.dispatch;return r.memoizedState=e,[t,n,!1]}function Li(e,t,r,n){return e={tag:e,create:r,deps:n,inst:t,next:null},null===(t=Hs.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Hs.updateQueue=t),null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Mi(){return li().memoizedState}function Fi(e,t,r,n){var a=oi();Hs.flags|=e,a.memoizedState=Li(1|t,{destroy:void 0},r,void 0===n?null:n)}function Ui(e,t,r,n){var a=li();n=void 0===n?null:n;var s=a.memoizedState.inst;null!==Ws&&null!==n&&Zs(n,Ws.memoizedState.deps)?a.memoizedState=Li(t,s,r,n):(Hs.flags|=e,a.memoizedState=Li(1|t,s,r,n))}function zi(e,t){Fi(8390656,8,e,t)}function Bi(e,t){Ui(2048,8,e,t)}function Hi(e){var t=li().memoizedState;return function(e){Hs.flags|=4;var t=Hs.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Hs.updateQueue=t,t.events=[e];else{var r=t.events;null===r?t.events=[e]:r.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&fc))throw Error(i(440));return t.impl.apply(void 0,arguments)}}function Wi(e,t){return Ui(4,2,e,t)}function Vi(e,t){return Ui(4,4,e,t)}function Gi(e,t){if("function"===typeof t){e=e();var r=t(e);return function(){"function"===typeof r?r():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function qi(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null,Ui(4,4,Gi.bind(null,t,e),r)}function Ki(){}function $i(e,t){var r=li();t=void 0===t?null:t;var n=r.memoizedState;return null!==t&&Zs(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Yi(e,t){var r=li();t=void 0===t?null:t;var n=r.memoizedState;if(null!==t&&Zs(t,n[1]))return n[0];if(n=e(),Ks){ye(!0);try{e()}finally{ye(!1)}}return r.memoizedState=[n,t],n}function Ji(e,t,r){return void 0===r||0!==(1073741824&Bs)&&0===(261930&gc)?e.memoizedState=t:(e.memoizedState=r,e=Kc(),Hs.lanes|=e,Ec|=e,r)}function Xi(e,t,r,n){return Xr(r,t)?r:null!==Ns.current?(e=Ji(e,r,n),Xr(e,t)||(Ro=!0),e):0===(42&Bs)||0!==(1073741824&Bs)&&0===(261930&gc)?(Ro=!0,e.memoizedState=r):(e=Kc(),Hs.lanes|=e,Ec|=e,t)}function Qi(e,t,r,n,a){var s=D.p;D.p=0!==s&&8>s?s:8;var i=I.T,o={};I.T=o,uo(e,!1,t,r);try{var l=a(),c=I.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)co(e,t,function(e,t){var r=[],n={status:"pending",value:null,reason:null,then:function(e){r.push(e)}};return e.then(function(){n.status="fulfilled",n.value=t;for(var e=0;e<r.length;e++)(0,r[e])(t)},function(e){for(n.status="rejected",n.reason=e,e=0;e<r.length;e++)(0,r[e])(void 0)}),n}(l,n),qc());else co(e,t,n,qc())}catch(u){co(e,t,{then:function(){},status:"rejected",reason:u},qc())}finally{D.p=s,null!==i&&null!==o.types&&(i.types=o.types),I.T=i}}function Zi(){}function eo(e,t,r,n){if(5!==e.tag)throw Error(i(476));var a=to(e).queue;Qi(e,a,t,L,null===r?Zi:function(){return ro(e),r(n)})}function to(e){var t=e.memoizedState;if(null!==t)return t;var r={};return(t={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:L},next:null}).next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:r},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ro(e){var t=to(e);null===t.next&&(t=e.alternate.memoizedState),co(e,t.next.queue,{},qc())}function no(){return Pa(uh)}function ao(){return li().memoizedState}function so(){return li().memoizedState}function io(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var r=qc(),n=ys(t,e=bs(r),r);return null!==n&&($c(n,t,r),xs(n,t,r)),t={cache:Ua()},void(e.payload=t)}t=t.return}}function oo(e,t,r){var n=qc();r={lane:n,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},ho(e)?fo(t,r):null!==(r=Pn(e,t,r,n))&&($c(r,e,n),mo(r,t,n))}function lo(e,t,r){co(e,t,r,qc())}function co(e,t,r,n){var a={lane:n,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(ho(e))fo(t,a);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,Xr(o,i))return On(e,t,a,0),null===mc&&Cn(),!1}catch(l){}if(null!==(r=Pn(e,t,a,n)))return $c(r,e,n),mo(r,t,n),!0}return!1}function uo(e,t,r,n){if(n={lane:2,revertLane:Hu(),gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},ho(e)){if(t)throw Error(i(479))}else null!==(t=Pn(e,r,n,2))&&$c(t,e,2)}function ho(e){var t=e.alternate;return e===Hs||null!==t&&t===Hs}function fo(e,t){qs=Gs=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function mo(e,t,r){if(0!==(4194048&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,Ie(e,r)}}var po={readContext:Pa,use:ui,useCallback:Qs,useContext:Qs,useEffect:Qs,useImperativeHandle:Qs,useLayoutEffect:Qs,useInsertionEffect:Qs,useMemo:Qs,useReducer:Qs,useRef:Qs,useState:Qs,useDebugValue:Qs,useDeferredValue:Qs,useTransition:Qs,useSyncExternalStore:Qs,useId:Qs,useHostTransitionStatus:Qs,useFormState:Qs,useActionState:Qs,useOptimistic:Qs,useMemoCache:Qs,useCacheRefresh:Qs};po.useEffectEvent=Qs;var go={readContext:Pa,use:ui,useCallback:function(e,t){return oi().memoizedState=[e,void 0===t?null:t],e},useContext:Pa,useEffect:zi,useImperativeHandle:function(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null,Fi(4194308,4,Gi.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Fi(4194308,4,e,t)},useInsertionEffect:function(e,t){Fi(4,2,e,t)},useMemo:function(e,t){var r=oi();t=void 0===t?null:t;var n=e();if(Ks){ye(!0);try{e()}finally{ye(!1)}}return r.memoizedState=[n,t],n},useReducer:function(e,t,r){var n=oi();if(void 0!==r){var a=r(t);if(Ks){ye(!0);try{r(t)}finally{ye(!1)}}}else a=t;return n.memoizedState=n.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},n.queue=e,e=e.dispatch=oo.bind(null,Hs,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},oi().memoizedState=e},useState:function(e){var t=(e=Si(e)).queue,r=lo.bind(null,Hs,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:Ki,useDeferredValue:function(e,t){return Ji(oi(),e,t)},useTransition:function(){var e=Si(!1);return e=Qi.bind(null,Hs,e.queue,!0,!1),oi().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var n=Hs,a=oi();if(da){if(void 0===r)throw Error(i(407));r=r()}else{if(r=t(),null===mc)throw Error(i(349));0!==(127&gc)||vi(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,zi(yi.bind(null,n,s,e),[e]),n.flags|=2048,Li(9,{destroy:void 0},bi.bind(null,n,s,r,t),null),r},useId:function(){var e=oi(),t=mc.identifierPrefix;if(da){var r=na;t="_"+t+"R_"+(r=(ra&~(1<<32-xe(ra)-1)).toString(32)+r),0<(r=$s++)&&(t+="H"+r.toString(32)),t+="_"}else t="_"+t+"r_"+(r=Xs++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:no,useFormState:Oi,useActionState:Oi,useOptimistic:function(e){var t=oi();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=uo.bind(null,Hs,!0,r),r.dispatch=t,[e,t]},useMemoCache:di,useCacheRefresh:function(){return oi().memoizedState=io.bind(null,Hs)},useEffectEvent:function(e){var t=oi(),r={impl:e};return t.memoizedState=r,function(){if(0!==(2&fc))throw Error(i(440));return r.impl.apply(void 0,arguments)}}},vo={readContext:Pa,use:ui,useCallback:$i,useContext:Pa,useEffect:Bi,useImperativeHandle:qi,useInsertionEffect:Wi,useLayoutEffect:Vi,useMemo:Yi,useReducer:fi,useRef:Mi,useState:function(){return fi(hi)},useDebugValue:Ki,useDeferredValue:function(e,t){return Xi(li(),Ws.memoizedState,e,t)},useTransition:function(){var e=fi(hi)[0],t=li().memoizedState;return["boolean"===typeof e?e:ci(e),t]},useSyncExternalStore:gi,useId:ao,useHostTransitionStatus:no,useFormState:Pi,useActionState:Pi,useOptimistic:function(e,t){return _i(li(),0,e,t)},useMemoCache:di,useCacheRefresh:so};vo.useEffectEvent=Hi;var bo={readContext:Pa,use:ui,useCallback:$i,useContext:Pa,useEffect:Bi,useImperativeHandle:qi,useInsertionEffect:Wi,useLayoutEffect:Vi,useMemo:Yi,useReducer:pi,useRef:Mi,useState:function(){return pi(hi)},useDebugValue:Ki,useDeferredValue:function(e,t){var r=li();return null===Ws?Ji(r,e,t):Xi(r,Ws.memoizedState,e,t)},useTransition:function(){var e=pi(hi)[0],t=li().memoizedState;return["boolean"===typeof e?e:ci(e),t]},useSyncExternalStore:gi,useId:ao,useHostTransitionStatus:no,useFormState:Di,useActionState:Di,useOptimistic:function(e,t){var r=li();return null!==Ws?_i(r,0,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:di,useCacheRefresh:so};function yo(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:f({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}bo.useEffectEvent=Hi;var xo={enqueueSetState:function(e,t,r){e=e._reactInternals;var n=qc(),a=bs(n);a.payload=t,void 0!==r&&null!==r&&(a.callback=r),null!==(t=ys(e,a,n))&&($c(t,e,n),xs(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=qc(),a=bs(n);a.tag=1,a.payload=t,void 0!==r&&null!==r&&(a.callback=r),null!==(t=ys(e,a,n))&&($c(t,e,n),xs(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=qc(),n=bs(r);n.tag=2,void 0!==t&&null!==t&&(n.callback=t),null!==(t=ys(e,n,r))&&($c(t,e,r),xs(t,e,r))}};function wo(e,t,r,n,a,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!Qr(r,n)||!Qr(a,s))}function So(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&xo.enqueueReplaceState(t,t.state,null)}function _o(e,t){var r=t;if("ref"in t)for(var n in r={},t)"ref"!==n&&(r[n]=t[n]);if(e=e.defaultProps)for(var a in r===t&&(r=f({},r)),e)void 0===r[a]&&(r[a]=e[a]);return r}function Eo(e){Tn(e)}function ko(e){console.error(e)}function To(e){Tn(e)}function No(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function jo(e,t,r){try{(0,e.onCaughtError)(r.value,{componentStack:r.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(n){setTimeout(function(){throw n})}}function Ao(e,t,r){return(r=bs(r)).tag=3,r.payload={element:null},r.callback=function(){No(e,t)},r}function Co(e){return(e=bs(e)).tag=3,e}function Oo(e,t,r,n){var a=r.type.getDerivedStateFromError;if("function"===typeof a){var s=n.value;e.payload=function(){return a(s)},e.callback=function(){jo(t,r,n)}}var i=r.stateNode;null!==i&&"function"===typeof i.componentDidCatch&&(e.callback=function(){jo(t,r,n),"function"!==typeof a&&(null===Lc?Lc=new Set([this]):Lc.add(this));var e=n.stack;this.componentDidCatch(n.value,{componentStack:null!==e?e:""})})}var Po=Error(i(461)),Ro=!1;function Io(e,t,r,n){t.child=null===e?ms(t,null,r,n):fs(t,e.child,r,n)}function Do(e,t,r,n,a){r=r.render;var s=t.ref;if("ref"in n){var i={};for(var o in n)"ref"!==o&&(i[o]=n[o])}else i=n;return Oa(t),n=ei(e,t,r,i,s,a),o=ai(),null===e||Ro?(da&&o&&ia(t),t.flags|=1,Io(e,t,n,a),t.child):(si(e,t,a),al(e,t,a))}function Lo(e,t,r,n,a){if(null===e){var s=r.type;return"function"!==typeof s||Un(s)||void 0!==s.defaultProps||null!==r.compare?((e=Hn(r.type,null,n,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Mo(e,t,s,n,a))}if(s=e.child,!sl(e,a)){var i=s.memoizedProps;if((r=null!==(r=r.compare)?r:Qr)(i,n)&&e.ref===t.ref)return al(e,t,a)}return t.flags|=1,(e=zn(s,n)).ref=t.ref,e.return=t,t.child=e}function Mo(e,t,r,n,a){if(null!==e){var s=e.memoizedProps;if(Qr(s,n)&&e.ref===t.ref){if(Ro=!1,t.pendingProps=n=s,!sl(e,a))return t.lanes=e.lanes,al(e,t,a);0!==(131072&e.flags)&&(Ro=!0)}}return Vo(e,t,r,n,a)}function Fo(e,t,r,n){var a=n.children,s=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===n.mode){if(0!==(128&t.flags)){if(s=null!==s?s.baseLanes|r:r,null!==e){for(n=t.child=e.child,a=0;null!==n;)a=a|n.lanes|n.childLanes,n=n.sibling;n=a&~s}else n=0,t.child=null;return zo(e,t,s,r,n)}if(0===(536870912&r))return n=t.lanes=536870912,zo(e,t,null!==s?s.baseLanes|r:r,r,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ya(0,null!==s?s.cachePool:null),null!==s?As(t,s):Cs(),Ls(t)}else null!==s?(Ya(0,s.cachePool),As(t,s),Ms(),t.memoizedState=null):(null!==e&&Ya(0,null),Cs(),Ms());return Io(e,t,a,r),t.child}function Uo(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function zo(e,t,r,n,a){var s=$a();return s=null===s?null:{parent:Fa._currentValue,pool:s},t.memoizedState={baseLanes:r,cachePool:s},null!==e&&Ya(0,null),Cs(),Ls(t),null!==e&&Aa(e,t,n,!0),t.childLanes=a,null}function Bo(e,t){return(t=Zo({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Ho(e,t,r){return fs(t,e.child,null,r),(e=Bo(t,t.pendingProps)).flags|=2,Fs(t),t.memoizedState=null,e}function Wo(e,t){var r=t.ref;if(null===r)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof r&&"object"!==typeof r)throw Error(i(284));null!==e&&e.ref===r||(t.flags|=4194816)}}function Vo(e,t,r,n,a){return Oa(t),r=ei(e,t,r,n,void 0,a),n=ai(),null===e||Ro?(da&&n&&ia(t),t.flags|=1,Io(e,t,r,a),t.child):(si(e,t,a),al(e,t,a))}function Go(e,t,r,n,a,s){return Oa(t),t.updateQueue=null,r=ri(t,n,r,a),ti(e),n=ai(),null===e||Ro?(da&&n&&ia(t),t.flags|=1,Io(e,t,r,s),t.child):(si(e,t,s),al(e,t,s))}function qo(e,t,r,n,a){if(Oa(t),null===t.stateNode){var s=Ln,i=r.contextType;"object"===typeof i&&null!==i&&(s=Pa(i)),s=new r(n,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=xo,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=n,s.state=t.memoizedState,s.refs={},gs(t),i=r.contextType,s.context="object"===typeof i&&null!==i?Pa(i):Ln,s.state=t.memoizedState,"function"===typeof(i=r.getDerivedStateFromProps)&&(yo(t,r,i,n),s.state=t.memoizedState),"function"===typeof r.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(i=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),i!==s.state&&xo.enqueueReplaceState(s,s.state,null),Es(t,n,s,a),_s(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!0}else if(null===e){s=t.stateNode;var o=t.memoizedProps,l=_o(r,o);s.props=l;var c=s.context,u=r.contextType;i=Ln,"object"===typeof u&&null!==u&&(i=Pa(u));var d=r.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate,o=t.pendingProps!==o,u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o||c!==i)&&So(t,s,n,i),ps=!1;var h=t.memoizedState;s.state=h,Es(t,n,s,a),_s(),c=t.memoizedState,o||h!==c||ps?("function"===typeof d&&(yo(t,r,d,n),c=t.memoizedState),(l=ps||wo(t,r,l,n,h,c,i))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=i,n=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,vs(e,t),u=_o(r,i=t.memoizedProps),s.props=u,d=t.pendingProps,h=s.context,c=r.contextType,l=Ln,"object"===typeof c&&null!==c&&(l=Pa(c)),(c="function"===typeof(o=r.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(i!==d||h!==l)&&So(t,s,n,l),ps=!1,h=t.memoizedState,s.state=h,Es(t,n,s,a),_s();var f=t.memoizedState;i!==d||h!==f||ps||null!==e&&null!==e.dependencies&&Ca(e.dependencies)?("function"===typeof o&&(yo(t,r,o,n),f=t.memoizedState),(u=ps||wo(t,r,u,n,h,f,l)||null!==e&&null!==e.dependencies&&Ca(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),s.props=n,s.state=f,s.context=l,n=u):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return s=n,Wo(e,t),n=0!==(128&t.flags),s||n?(s=t.stateNode,r=n&&"function"!==typeof r.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&n?(t.child=fs(t,e.child,null,a),t.child=fs(t,null,r,a)):Io(e,t,r,a),t.memoizedState=s.state,e=t.child):e=al(e,t,a),e}function Ko(e,t,r,n){return ya(),t.flags|=256,Io(e,t,r,n),t.child}var $o={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yo(e){return{baseLanes:e,cachePool:Ja()}}function Jo(e,t,r){return e=null!==e?e.childLanes&~r:0,t&&(e|=Nc),e}function Xo(e,t,r){var n,a=t.pendingProps,s=!1,o=0!==(128&t.flags);if((n=o)||(n=(null===e||null!==e.memoizedState)&&0!==(2&Us.current)),n&&(s=!0,t.flags&=-129),n=0!==(32&t.flags),t.flags&=-33,null===e){if(da){if(s?Is(t):Ms(),(e=ua)?null!==(e=null!==(e=Cd(e,fa))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ta?{id:ra,overflow:na}:null,retryLane:536870912,hydrationErrors:null},(r=Gn(e)).return=t,t.child=r,ca=t,ua=null):e=null,null===e)throw pa(t);return Pd(e)?t.lanes=32:t.lanes=536870912,null}var l=a.children;return a=a.fallback,s?(Ms(),l=Zo({mode:"hidden",children:l},s=t.mode),a=Wn(a,s,r,null),l.return=t,a.return=t,l.sibling=a,t.child=l,(a=t.child).memoizedState=Yo(r),a.childLanes=Jo(e,n,r),t.memoizedState=$o,Uo(null,a)):(Is(t),Qo(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(o)256&t.flags?(Is(t),t.flags&=-257,t=el(e,t,r)):null!==t.memoizedState?(Ms(),t.child=e.child,t.flags|=128,t=null):(Ms(),l=a.fallback,s=t.mode,a=Zo({mode:"visible",children:a.children},s),(l=Wn(l,s,r,null)).flags|=2,a.return=t,l.return=t,a.sibling=l,t.child=a,fs(t,e.child,null,r),(a=t.child).memoizedState=Yo(r),a.childLanes=Jo(e,n,r),t.memoizedState=$o,t=Uo(null,a));else if(Is(t),Pd(l)){if(n=l.nextSibling&&l.nextSibling.dataset)var u=n.dgst;n=u,(a=Error(i(419))).stack="",a.digest=n,wa({value:a,source:null,stack:null}),t=el(e,t,r)}else if(Ro||Aa(e,t,r,!1),n=0!==(r&e.childLanes),Ro||n){if(null!==(n=mc)&&(0!==(a=De(n,r))&&a!==c.retryLane))throw c.retryLane=a,Rn(e,a),$c(n,e,a),Po;Od(l)||iu(),t=el(e,t,r)}else Od(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,ua=Rd(l.nextSibling),ca=t,da=!0,ha=null,fa=!1,null!==e&&la(t,e),(t=Qo(t,a.children)).flags|=4096);return t}return s?(Ms(),l=a.fallback,s=t.mode,u=(c=e.child).sibling,(a=zn(c,{mode:"hidden",children:a.children})).subtreeFlags=65011712&c.subtreeFlags,null!==u?l=zn(u,l):(l=Wn(l,s,r,null)).flags|=2,l.return=t,a.return=t,a.sibling=l,t.child=a,Uo(null,a),a=t.child,null===(l=e.child.memoizedState)?l=Yo(r):(null!==(s=l.cachePool)?(c=Fa._currentValue,s=s.parent!==c?{parent:c,pool:c}:s):s=Ja(),l={baseLanes:l.baseLanes|r,cachePool:s}),a.memoizedState=l,a.childLanes=Jo(e,n,r),t.memoizedState=$o,Uo(e.child,a)):(Is(t),e=(r=e.child).sibling,(r=zn(r,{mode:"visible",children:a.children})).return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r)}function Qo(e,t){return(t=Zo({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Zo(e,t){return(e=Fn(22,e,null,t)).lanes=0,e}function el(e,t,r){return fs(t,e.child,null,r),(e=Qo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tl(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Na(e.return,t,r)}function rl(e,t,r,n,a,s){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a,treeForkCount:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a,i.treeForkCount=s)}function nl(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;n=n.children;var i=Us.current,o=0!==(2&i);if(o?(i=1&i|2,t.flags|=128):i&=1,B(Us,i),Io(e,t,n,r),n=da?Qn:0,!o&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tl(e,r,t);else if(19===e.tag)tl(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(a){case"forwards":for(r=t.child,a=null;null!==r;)null!==(e=r.alternate)&&null===zs(e)&&(a=r),r=r.sibling;null===(r=a)?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),rl(t,!1,a,r,s,n);break;case"backwards":case"unstable_legacy-backwards":for(r=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===zs(e)){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}rl(t,!0,r,null,s,n);break;case"together":rl(t,!1,null,null,void 0,n);break;default:t.memoizedState=null}return t.child}function al(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Ec|=t.lanes,0===(r&t.childLanes)){if(null===e)return null;if(Aa(e,t,r,!1),0===(r&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(r=zn(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=zn(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function sl(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ca(e))}function il(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ro=!0;else{if(!sl(e,r)&&0===(128&t.flags))return Ro=!1,function(e,t,r){switch(t.tag){case 3:$(t,t.stateNode.containerInfo),ka(0,Fa,e.memoizedState.cache),ya();break;case 27:case 5:J(t);break;case 4:$(t,t.stateNode.containerInfo);break;case 10:ka(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Ds(t),null;break;case 13:var n=t.memoizedState;if(null!==n)return null!==n.dehydrated?(Is(t),t.flags|=128,null):0!==(r&t.child.childLanes)?Xo(e,t,r):(Is(t),null!==(e=al(e,t,r))?e.sibling:null);Is(t);break;case 19:var a=0!==(128&e.flags);if((n=0!==(r&t.childLanes))||(Aa(e,t,r,!1),n=0!==(r&t.childLanes)),a){if(n)return nl(e,t,r);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),B(Us,Us.current),n)break;return null;case 22:return t.lanes=0,Fo(e,t,r,t.pendingProps);case 24:ka(0,Fa,e.memoizedState.cache)}return al(e,t,r)}(e,t,r);Ro=0!==(131072&e.flags)}else Ro=!1,da&&0!==(1048576&t.flags)&&sa(t,Qn,t.index);switch(t.lanes=0,t.tag){case 16:e:{var n=t.pendingProps;if(e=ns(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var a=e.$$typeof;if(a===S){t.tag=11,t=Do(null,t,e,n,r);break e}if(a===k){t.tag=14,t=Lo(null,t,e,n,r);break e}}throw t=P(e)||e,Error(i(306,t,""))}Un(e)?(n=_o(e,n),t.tag=1,t=qo(null,t,e,n,r)):(t.tag=0,t=Vo(null,t,e,n,r))}return t;case 0:return Vo(e,t,t.type,t.pendingProps,r);case 1:return qo(e,t,n=t.type,a=_o(n,t.pendingProps),r);case 3:e:{if($(t,t.stateNode.containerInfo),null===e)throw Error(i(387));n=t.pendingProps;var s=t.memoizedState;a=s.element,vs(e,t),Es(t,n,null,r);var o=t.memoizedState;if(n=o.cache,ka(0,Fa,n),n!==s.cache&&ja(t,[Fa],r,!0),_s(),n=o.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ko(e,t,n,r);break e}if(n!==a){wa(a=$n(Error(i(424)),t)),t=Ko(e,t,n,r);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ua=Rd(e.firstChild),ca=t,da=!0,ha=null,fa=!0,r=ms(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(ya(),n===a){t=al(e,t,r);break e}Io(e,t,n,r)}t=t.child}return t;case 26:return Wo(e,t),null===e?(r=Gd(t.type,null,t.pendingProps,null))?t.memoizedState=r:da||(r=t.type,e=t.pendingProps,(n=gd(q.current).createElement(r))[Be]=t,n[He]=e,hd(n,r,e),et(n),t.stateNode=n):t.memoizedState=Gd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return J(t),null===e&&da&&(n=t.stateNode=Md(t.type,t.pendingProps,q.current),ca=t,fa=!0,a=ua,Td(t.type)?(Id=a,ua=Rd(n.firstChild)):ua=a),Io(e,t,t.pendingProps.children,r),Wo(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&da&&((a=n=ua)&&(null!==(n=function(e,t,r,n){for(;1===e.nodeType;){var a=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!n&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(n){if(!e[$e])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===s)return e}if(null===(e=Rd(e.nextSibling)))break}return null}(n,t.type,t.pendingProps,fa))?(t.stateNode=n,ca=t,ua=Rd(n.firstChild),fa=!1,a=!0):a=!1),a||pa(t)),J(t),a=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,n=s.children,yd(a,s)?n=null:null!==o&&yd(a,o)&&(t.flags|=32),null!==t.memoizedState&&(a=ei(e,t,ni,null,null,r),uh._currentValue=a),Wo(e,t),Io(e,t,n,r),t.child;case 6:return null===e&&da&&((e=r=ua)&&(null!==(r=function(e,t,r){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!r)return null;if(null===(e=Rd(e.nextSibling)))return null}return e}(r,t.pendingProps,fa))?(t.stateNode=r,ca=t,ua=null,e=!0):e=!1),e||pa(t)),null;case 13:return Xo(e,t,r);case 4:return $(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=fs(t,null,n,r):Io(e,t,n,r),t.child;case 11:return Do(e,t,t.type,t.pendingProps,r);case 7:return Io(e,t,t.pendingProps,r),t.child;case 8:case 12:return Io(e,t,t.pendingProps.children,r),t.child;case 10:return n=t.pendingProps,ka(0,t.type,n.value),Io(e,t,n.children,r),t.child;case 9:return a=t.type._context,n=t.pendingProps.children,Oa(t),n=n(a=Pa(a)),t.flags|=1,Io(e,t,n,r),t.child;case 14:return Lo(e,t,t.type,t.pendingProps,r);case 15:return Mo(e,t,t.type,t.pendingProps,r);case 19:return nl(e,t,r);case 31:return function(e,t,r){var n=t.pendingProps,a=0!==(128&t.flags);if(t.flags&=-129,null===e){if(da){if("hidden"===n.mode)return e=Bo(t,n),t.lanes=536870912,Uo(null,e);if(Ds(t),(e=ua)?null!==(e=null!==(e=Cd(e,fa))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ta?{id:ra,overflow:na}:null,retryLane:536870912,hydrationErrors:null},(r=Gn(e)).return=t,t.child=r,ca=t,ua=null):e=null,null===e)throw pa(t);return t.lanes=536870912,null}return Bo(t,n)}var s=e.memoizedState;if(null!==s){var o=s.dehydrated;if(Ds(t),a)if(256&t.flags)t.flags&=-257,t=Ho(e,t,r);else{if(null===t.memoizedState)throw Error(i(558));t.child=e.child,t.flags|=128,t=null}else if(Ro||Aa(e,t,r,!1),a=0!==(r&e.childLanes),Ro||a){if(null!==(n=mc)&&0!==(o=De(n,r))&&o!==s.retryLane)throw s.retryLane=o,Rn(e,o),$c(n,e,o),Po;iu(),t=Ho(e,t,r)}else e=s.treeContext,ua=Rd(o.nextSibling),ca=t,da=!0,ha=null,fa=!1,null!==e&&la(t,e),(t=Bo(t,n)).flags|=4096;return t}return(e=zn(e.child,{mode:n.mode,children:n.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,r);case 22:return Fo(e,t,r,t.pendingProps);case 24:return Oa(t),n=Pa(Fa),null===e?(null===(a=$a())&&(a=mc,s=Ua(),a.pooledCache=s,s.refCount++,null!==s&&(a.pooledCacheLanes|=r),a=s),t.memoizedState={parent:n,cache:a},gs(t),ka(0,Fa,a)):(0!==(e.lanes&r)&&(vs(e,t),Es(t,null,null,r),_s()),a=e.memoizedState,s=t.memoizedState,a.parent!==n?(a={parent:n,cache:n},t.memoizedState=a,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=a),ka(0,Fa,n)):(n=s.cache,ka(0,Fa,n),n!==a.cache&&ja(t,[Fa],r,!0))),Io(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function ol(e){e.flags|=4}function ll(e,t,r,n,a){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&a)===a)if(e.stateNode.complete)e.flags|=8192;else{if(!nu())throw as=es,Qa;e.flags|=8192}}else e.flags&=-16777217}function cl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!ah(t)){if(!nu())throw as=es,Qa;e.flags|=8192}}function ul(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ce():536870912,e.lanes|=t,jc|=t)}function dl(e,t){if(!da)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function hl(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=65011712&a.subtreeFlags,n|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function fl(e,t,r){var n=t.pendingProps;switch(oa(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return hl(t),null;case 3:return r=t.stateNode,n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ta(Fa),Y(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ba(t)?ol(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,xa())),hl(t),null;case 26:var a=t.type,s=t.memoizedState;return null===e?(ol(t),null!==s?(hl(t),cl(t,s)):(hl(t),ll(t,a,0,0,r))):s?s!==e.memoizedState?(ol(t),hl(t),cl(t,s)):(hl(t),t.flags&=-16777217):((e=e.memoizedProps)!==n&&ol(t),hl(t),ll(t,a,0,0,r)),null;case 27:if(X(t),r=q.current,a=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==n&&ol(t);else{if(!n){if(null===t.stateNode)throw Error(i(166));return hl(t),null}e=V.current,ba(t)?ga(t):(e=Md(a,n,r),t.stateNode=e,ol(t))}return hl(t),null;case 5:if(X(t),a=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==n&&ol(t);else{if(!n){if(null===t.stateNode)throw Error(i(166));return hl(t),null}if(s=V.current,ba(t))ga(t);else{var o=gd(q.current);switch(s){case 1:s=o.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:s=o.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":s=o.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":s=o.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":(s=o.createElement("div")).innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s="string"===typeof n.is?o.createElement("select",{is:n.is}):o.createElement("select"),n.multiple?s.multiple=!0:n.size&&(s.size=n.size);break;default:s="string"===typeof n.is?o.createElement(a,{is:n.is}):o.createElement(a)}}s[Be]=t,s[He]=n;e:for(o=t.child;null!==o;){if(5===o.tag||6===o.tag)s.appendChild(o.stateNode);else if(4!==o.tag&&27!==o.tag&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break e;for(;null===o.sibling;){if(null===o.return||o.return===t)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}t.stateNode=s;e:switch(hd(s,a,n),a){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&ol(t)}}return hl(t),ll(t,t.type,null===e||e.memoizedProps,t.pendingProps,r),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==n&&ol(t);else{if("string"!==typeof n&&null===t.stateNode)throw Error(i(166));if(e=q.current,ba(t)){if(e=t.stateNode,r=t.memoizedProps,n=null,null!==(a=ca))switch(a.tag){case 27:case 5:n=a.memoizedProps}e[Be]=t,(e=!!(e.nodeValue===r||null!==n&&!0===n.suppressHydrationWarning||cd(e.nodeValue,r)))||pa(t,!0)}else(e=gd(e).createTextNode(n))[Be]=t,t.stateNode=e}return hl(t),null;case 31:if(r=t.memoizedState,null===e||null!==e.memoizedState){if(n=ba(t),null!==r){if(null===e){if(!n)throw Error(i(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(i(557));e[Be]=t}else ya(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),e=!1}else r=xa(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return 256&t.flags?(Fs(t),t):(Fs(t),null);if(0!==(128&t.flags))throw Error(i(558))}return hl(t),null;case 13:if(n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(a=ba(t),null!==n&&null!==n.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[Be]=t}else ya(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),a=!1}else a=xa(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return 256&t.flags?(Fs(t),t):(Fs(t),null)}return Fs(t),0!==(128&t.flags)?(t.lanes=r,t):(r=null!==n,e=null!==e&&null!==e.memoizedState,r&&(a=null,null!==(n=t.child).alternate&&null!==n.alternate.memoizedState&&null!==n.alternate.memoizedState.cachePool&&(a=n.alternate.memoizedState.cachePool.pool),s=null,null!==n.memoizedState&&null!==n.memoizedState.cachePool&&(s=n.memoizedState.cachePool.pool),s!==a&&(n.flags|=2048)),r!==e&&r&&(t.child.flags|=8192),ul(t,t.updateQueue),hl(t),null);case 4:return Y(),null===e&&Zu(t.stateNode.containerInfo),hl(t),null;case 10:return Ta(t.type),hl(t),null;case 19:if(z(Us),null===(n=t.memoizedState))return hl(t),null;if(a=0!==(128&t.flags),null===(s=n.rendering))if(a)dl(n,!1);else{if(0!==_c||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=zs(e))){for(t.flags|=128,dl(n,!1),e=s.updateQueue,t.updateQueue=e,ul(t,e),t.subtreeFlags=0,e=r,r=t.child;null!==r;)Bn(r,e),r=r.sibling;return B(Us,1&Us.current|2),da&&aa(t,n.treeForkCount),t.child}e=e.sibling}null!==n.tail&&le()>Ic&&(t.flags|=128,a=!0,dl(n,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=zs(s))){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,ul(t,e),dl(n,!0),null===n.tail&&"hidden"===n.tailMode&&!s.alternate&&!da)return hl(t),null}else 2*le()-n.renderingStartTime>Ic&&536870912!==r&&(t.flags|=128,a=!0,dl(n,!1),t.lanes=4194304);n.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=n.last)?e.sibling=s:t.child=s,n.last=s)}return null!==n.tail?(e=n.tail,n.rendering=e,n.tail=e.sibling,n.renderingStartTime=le(),e.sibling=null,r=Us.current,B(Us,a?1&r|2:1&r),da&&aa(t,n.treeForkCount),e):(hl(t),null);case 22:case 23:return Fs(t),Os(),n=null!==t.memoizedState,null!==e?null!==e.memoizedState!==n&&(t.flags|=8192):n&&(t.flags|=8192),n?0!==(536870912&r)&&0===(128&t.flags)&&(hl(t),6&t.subtreeFlags&&(t.flags|=8192)):hl(t),null!==(r=t.updateQueue)&&ul(t,r.retryQueue),r=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),n=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(n=t.memoizedState.cachePool.pool),n!==r&&(t.flags|=2048),null!==e&&z(Ka),null;case 24:return r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ta(Fa),hl(t),null;case 25:case 30:return null}throw Error(i(156,t.tag))}function ml(e,t){switch(oa(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ta(Fa),Y(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return X(t),null;case 31:if(null!==t.memoizedState){if(Fs(t),null===t.alternate)throw Error(i(340));ya()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Fs(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));ya()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return z(Us),null;case 4:return Y(),null;case 10:return Ta(t.type),null;case 22:case 23:return Fs(t),Os(),null!==e&&z(Ka),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ta(Fa),null;default:return null}}function pl(e,t){switch(oa(t),t.tag){case 3:Ta(Fa),Y();break;case 26:case 27:case 5:X(t);break;case 4:Y();break;case 31:null!==t.memoizedState&&Fs(t);break;case 13:Fs(t);break;case 19:z(Us);break;case 10:Ta(t.type);break;case 22:case 23:Fs(t),Os(),null!==e&&z(Ka);break;case 24:Ta(Fa)}}function gl(e,t){try{var r=t.updateQueue,n=null!==r?r.lastEffect:null;if(null!==n){var a=n.next;r=a;do{if((r.tag&e)===e){n=void 0;var s=r.create,i=r.inst;n=s(),i.destroy=n}r=r.next}while(r!==a)}}catch(o){_u(t,t.return,o)}}function vl(e,t,r){try{var n=t.updateQueue,a=null!==n?n.lastEffect:null;if(null!==a){var s=a.next;n=s;do{if((n.tag&e)===e){var i=n.inst,o=i.destroy;if(void 0!==o){i.destroy=void 0,a=t;var l=r,c=o;try{c()}catch(u){_u(a,l,u)}}}n=n.next}while(n!==s)}}catch(u){_u(t,t.return,u)}}function bl(e){var t=e.updateQueue;if(null!==t){var r=e.stateNode;try{Ts(t,r)}catch(n){_u(e,e.return,n)}}}function yl(e,t,r){r.props=_o(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(n){_u(e,t,n)}}function xl(e,t){try{var r=e.ref;if(null!==r){switch(e.tag){case 26:case 27:case 5:var n=e.stateNode;break;default:n=e.stateNode}"function"===typeof r?e.refCleanup=r(n):r.current=n}}catch(a){_u(e,t,a)}}function wl(e,t){var r=e.ref,n=e.refCleanup;if(null!==r)if("function"===typeof n)try{n()}catch(a){_u(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof r)try{r(null)}catch(s){_u(e,t,s)}else r.current=null}function Sl(e){var t=e.type,r=e.memoizedProps,n=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&n.focus();break e;case"img":r.src?n.src=r.src:r.srcSet&&(n.srcset=r.srcSet)}}catch(a){_u(e,e.return,a)}}function _l(e,t,r){try{var n=e.stateNode;!function(e,t,r,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,s=null,o=null,l=null,c=null,u=null,d=null;for(m in r){var h=r[m];if(r.hasOwnProperty(m)&&null!=h)switch(m){case"checked":case"value":break;case"defaultValue":c=h;default:n.hasOwnProperty(m)||ud(e,t,m,null,n,h)}}for(var f in n){var m=n[f];if(h=r[f],n.hasOwnProperty(f)&&(null!=m||null!=h))switch(f){case"type":s=m;break;case"name":a=m;break;case"checked":u=m;break;case"defaultChecked":d=m;break;case"value":o=m;break;case"defaultValue":l=m;break;case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(i(137,t));break;default:m!==h&&ud(e,t,f,m,n,h)}}return void bt(e,o,l,c,u,d,s,a);case"select":for(s in m=o=l=f=null,r)if(c=r[s],r.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":m=c;default:n.hasOwnProperty(s)||ud(e,t,s,null,n,c)}for(a in n)if(s=n[a],c=r[a],n.hasOwnProperty(a)&&(null!=s||null!=c))switch(a){case"value":f=s;break;case"defaultValue":l=s;break;case"multiple":o=s;default:s!==c&&ud(e,t,a,s,n,c)}return t=l,r=o,n=m,void(null!=f?wt(e,!!r,f,!1):!!n!==!!r&&(null!=t?wt(e,!!r,t,!0):wt(e,!!r,r?[]:"",!1)));case"textarea":for(l in m=f=null,r)if(a=r[l],r.hasOwnProperty(l)&&null!=a&&!n.hasOwnProperty(l))switch(l){case"value":case"children":break;default:ud(e,t,l,null,n,a)}for(o in n)if(a=n[o],s=r[o],n.hasOwnProperty(o)&&(null!=a||null!=s))switch(o){case"value":f=a;break;case"defaultValue":m=a;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=a)throw Error(i(91));break;default:a!==s&&ud(e,t,o,a,n,s)}return void St(e,f,m);case"option":for(var p in r)if(f=r[p],r.hasOwnProperty(p)&&null!=f&&!n.hasOwnProperty(p))if("selected"===p)e.selected=!1;else ud(e,t,p,null,n,f);for(c in n)if(f=n[c],m=r[c],n.hasOwnProperty(c)&&f!==m&&(null!=f||null!=m))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else ud(e,t,c,f,n,m);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in r)f=r[g],r.hasOwnProperty(g)&&null!=f&&!n.hasOwnProperty(g)&&ud(e,t,g,null,n,f);for(u in n)if(f=n[u],m=r[u],n.hasOwnProperty(u)&&f!==m&&(null!=f||null!=m))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(i(137,t));break;default:ud(e,t,u,f,n,m)}return;default:if(jt(t)){for(var v in r)f=r[v],r.hasOwnProperty(v)&&void 0!==f&&!n.hasOwnProperty(v)&&dd(e,t,v,void 0,n,f);for(d in n)f=n[d],m=r[d],!n.hasOwnProperty(d)||f===m||void 0===f&&void 0===m||dd(e,t,d,f,n,m);return}}for(var b in r)f=r[b],r.hasOwnProperty(b)&&null!=f&&!n.hasOwnProperty(b)&&ud(e,t,b,null,n,f);for(h in n)f=n[h],m=r[h],!n.hasOwnProperty(h)||f===m||null==f&&null==m||ud(e,t,h,f,n,m)}(n,e.type,r,t),n[He]=t}catch(a){_u(e,e.return,a)}}function El(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Td(e.type)||4===e.tag}function kl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||El(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Td(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Tl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?(9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).insertBefore(e,t):((t=9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Pt));else if(4!==n&&(27===n&&Td(e.type)&&(r=e.stateNode,t=null),null!==(e=e.child)))for(Tl(e,t,r),e=e.sibling;null!==e;)Tl(e,t,r),e=e.sibling}function Nl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&(27===n&&Td(e.type)&&(r=e.stateNode),null!==(e=e.child)))for(Nl(e,t,r),e=e.sibling;null!==e;)Nl(e,t,r),e=e.sibling}function jl(e){var t=e.stateNode,r=e.memoizedProps;try{for(var n=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);hd(t,n,r),t[Be]=e,t[He]=r}catch(s){_u(e,e.return,s)}}var Al=!1,Cl=!1,Ol=!1,Pl="function"===typeof WeakSet?WeakSet:Set,Rl=null;function Il(e,t,r){var n=r.flags;switch(r.tag){case 0:case 11:case 15:$l(e,r),4&n&&gl(5,r);break;case 1:if($l(e,r),4&n)if(e=r.stateNode,null===t)try{e.componentDidMount()}catch(i){_u(r,r.return,i)}else{var a=_o(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){_u(r,r.return,o)}}64&n&&bl(r),512&n&&xl(r,r.return);break;case 3:if($l(e,r),64&n&&null!==(e=r.updateQueue)){if(t=null,null!==r.child)switch(r.child.tag){case 27:case 5:case 1:t=r.child.stateNode}try{Ts(e,t)}catch(i){_u(r,r.return,i)}}break;case 27:null===t&&4&n&&jl(r);case 26:case 5:$l(e,r),null===t&&4&n&&Sl(r),512&n&&xl(r,r.return);break;case 12:$l(e,r);break;case 31:$l(e,r),4&n&&zl(e,r);break;case 13:$l(e,r),4&n&&Bl(e,r),64&n&&(null!==(e=r.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var r=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==r.readyState)t();else{var n=function(){t(),r.removeEventListener("DOMContentLoaded",n)};r.addEventListener("DOMContentLoaded",n),e._reactRetry=n}}(e,r=Nu.bind(null,r))));break;case 22:if(!(n=null!==r.memoizedState||Al)){t=null!==t&&null!==t.memoizedState||Cl,a=Al;var s=Cl;Al=n,(Cl=t)&&!s?Jl(e,r,0!==(8772&r.subtreeFlags)):$l(e,r),Al=a,Cl=s}break;case 30:break;default:$l(e,r)}}function Dl(e){var t=e.alternate;null!==t&&(e.alternate=null,Dl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ye(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ll=null,Ml=!1;function Fl(e,t,r){for(r=r.child;null!==r;)Ul(e,t,r),r=r.sibling}function Ul(e,t,r){if(be&&"function"===typeof be.onCommitFiberUnmount)try{be.onCommitFiberUnmount(ve,r)}catch(s){}switch(r.tag){case 26:Cl||wl(r,t),Fl(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode).parentNode.removeChild(r);break;case 27:Cl||wl(r,t);var n=Ll,a=Ml;Td(r.type)&&(Ll=r.stateNode,Ml=!1),Fl(e,t,r),Fd(r.stateNode),Ll=n,Ml=a;break;case 5:Cl||wl(r,t);case 6:if(n=Ll,a=Ml,Ll=null,Fl(e,t,r),Ml=a,null!==(Ll=n))if(Ml)try{(9===Ll.nodeType?Ll.body:"HTML"===Ll.nodeName?Ll.ownerDocument.body:Ll).removeChild(r.stateNode)}catch(i){_u(r,t,i)}else try{Ll.removeChild(r.stateNode)}catch(i){_u(r,t,i)}break;case 18:null!==Ll&&(Ml?(Nd(9===(e=Ll).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,r.stateNode),Vh(e)):Nd(Ll,r.stateNode));break;case 4:n=Ll,a=Ml,Ll=r.stateNode.containerInfo,Ml=!0,Fl(e,t,r),Ll=n,Ml=a;break;case 0:case 11:case 14:case 15:vl(2,r,t),Cl||vl(4,r,t),Fl(e,t,r);break;case 1:Cl||(wl(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount&&yl(r,t,n)),Fl(e,t,r);break;case 21:Fl(e,t,r);break;case 22:Cl=(n=Cl)||null!==r.memoizedState,Fl(e,t,r),Cl=n;break;default:Fl(e,t,r)}}function zl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Vh(e)}catch(r){_u(t,t.return,r)}}}function Bl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Vh(e)}catch(r){_u(t,t.return,r)}}function Hl(e,t){var r=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Pl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Pl),t;default:throw Error(i(435,e.tag))}}(e);t.forEach(function(t){if(!r.has(t)){r.add(t);var n=ju.bind(null,e,t);t.then(n,n)}})}function Wl(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var a=r[n],s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(Td(l.type)){Ll=l.stateNode,Ml=!1;break e}break;case 5:Ll=l.stateNode,Ml=!1;break e;case 3:case 4:Ll=l.stateNode.containerInfo,Ml=!0;break e}l=l.return}if(null===Ll)throw Error(i(160));Ul(s,o,a),Ll=null,Ml=!1,null!==(s=a.alternate)&&(s.return=null),a.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Gl(t,e),t=t.sibling}var Vl=null;function Gl(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Wl(t,e),ql(e),4&n&&(vl(3,e,e.return),gl(3,e),vl(5,e,e.return));break;case 1:Wl(t,e),ql(e),512&n&&(Cl||null===r||wl(r,r.return)),64&n&&Al&&(null!==(e=e.updateQueue)&&(null!==(n=e.callbacks)&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===r?n:r.concat(n))));break;case 26:var a=Vl;if(Wl(t,e),ql(e),512&n&&(Cl||null===r||wl(r,r.return)),4&n){var s=null!==r?r.memoizedState:null;if(n=e.memoizedState,null===r)if(null===n)if(null===e.stateNode){e:{n=e.type,r=e.memoizedProps,a=a.ownerDocument||a;t:switch(n){case"title":(!(s=a.getElementsByTagName("title")[0])||s[$e]||s[Be]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=a.createElement(n),a.head.insertBefore(s,a.querySelector("head > title"))),hd(s,n,r),s[Be]=e,et(s),n=s;break e;case"link":var o=rh("link","href",a).get(n+(r.href||""));if(o)for(var l=0;l<o.length;l++)if((s=o[l]).getAttribute("href")===(null==r.href||""===r.href?null:r.href)&&s.getAttribute("rel")===(null==r.rel?null:r.rel)&&s.getAttribute("title")===(null==r.title?null:r.title)&&s.getAttribute("crossorigin")===(null==r.crossOrigin?null:r.crossOrigin)){o.splice(l,1);break t}hd(s=a.createElement(n),n,r),a.head.appendChild(s);break;case"meta":if(o=rh("meta","content",a).get(n+(r.content||"")))for(l=0;l<o.length;l++)if((s=o[l]).getAttribute("content")===(null==r.content?null:""+r.content)&&s.getAttribute("name")===(null==r.name?null:r.name)&&s.getAttribute("property")===(null==r.property?null:r.property)&&s.getAttribute("http-equiv")===(null==r.httpEquiv?null:r.httpEquiv)&&s.getAttribute("charset")===(null==r.charSet?null:r.charSet)){o.splice(l,1);break t}hd(s=a.createElement(n),n,r),a.head.appendChild(s);break;default:throw Error(i(468,n))}s[Be]=e,et(s),n=s}e.stateNode=n}else nh(a,e.type,e.stateNode);else e.stateNode=Xd(a,n,e.memoizedProps);else s!==n?(null===s?null!==r.stateNode&&(r=r.stateNode).parentNode.removeChild(r):s.count--,null===n?nh(a,e.type,e.stateNode):Xd(a,n,e.memoizedProps)):null===n&&null!==e.stateNode&&_l(e,e.memoizedProps,r.memoizedProps)}break;case 27:Wl(t,e),ql(e),512&n&&(Cl||null===r||wl(r,r.return)),null!==r&&4&n&&_l(e,e.memoizedProps,r.memoizedProps);break;case 5:if(Wl(t,e),ql(e),512&n&&(Cl||null===r||wl(r,r.return)),32&e.flags){a=e.stateNode;try{Et(a,"")}catch(p){_u(e,e.return,p)}}4&n&&null!=e.stateNode&&_l(e,a=e.memoizedProps,null!==r?r.memoizedProps:a),1024&n&&(Ol=!0);break;case 6:if(Wl(t,e),ql(e),4&n){if(null===e.stateNode)throw Error(i(162));n=e.memoizedProps,r=e.stateNode;try{r.nodeValue=n}catch(p){_u(e,e.return,p)}}break;case 3:if(th=null,a=Vl,Vl=Bd(t.containerInfo),Wl(t,e),Vl=a,ql(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{Vh(t.containerInfo)}catch(p){_u(e,e.return,p)}Ol&&(Ol=!1,Kl(e));break;case 4:n=Vl,Vl=Bd(e.stateNode.containerInfo),Wl(t,e),ql(e),Vl=n;break;case 12:default:Wl(t,e),ql(e);break;case 31:case 19:Wl(t,e),ql(e),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,Hl(e,n)));break;case 13:Wl(t,e),ql(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==r&&null!==r.memoizedState)&&(Pc=le()),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,Hl(e,n)));break;case 22:a=null!==e.memoizedState;var c=null!==r&&null!==r.memoizedState,u=Al,d=Cl;if(Al=u||a,Cl=d||c,Wl(t,e),Cl=d,Al=u,ql(e),8192&n)e:for(t=e.stateNode,t._visibility=a?-2&t._visibility:1|t._visibility,a&&(null===r||c||Al||Cl||Yl(e)),r=null,t=e;;){if(5===t.tag||26===t.tag){if(null===r){c=r=t;try{if(s=c.stateNode,a)"function"===typeof(o=s.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,f=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(p){_u(c,c.return,p)}}}else if(6===t.tag){if(null===r){c=t;try{c.stateNode.nodeValue=a?"":c.memoizedProps}catch(p){_u(c,c.return,p)}}}else if(18===t.tag){if(null===r){c=t;try{var m=c.stateNode;a?jd(m,!0):jd(c.stateNode,!1)}catch(p){_u(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}4&n&&(null!==(n=e.updateQueue)&&(null!==(r=n.retryQueue)&&(n.retryQueue=null,Hl(e,r))));case 30:case 21:}}function ql(e){var t=e.flags;if(2&t){try{for(var r,n=e.return;null!==n;){if(El(n)){r=n;break}n=n.return}if(null==r)throw Error(i(160));switch(r.tag){case 27:var a=r.stateNode;Nl(e,kl(e),a);break;case 5:var s=r.stateNode;32&r.flags&&(Et(s,""),r.flags&=-33),Nl(e,kl(e),s);break;case 3:case 4:var o=r.stateNode.containerInfo;Tl(e,kl(e),o);break;default:throw Error(i(161))}}catch(l){_u(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Kl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Kl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function $l(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Il(e,t.alternate,t),t=t.sibling}function Yl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:vl(4,t,t.return),Yl(t);break;case 1:wl(t,t.return);var r=t.stateNode;"function"===typeof r.componentWillUnmount&&yl(t,t.return,r),Yl(t);break;case 27:Fd(t.stateNode);case 26:case 5:wl(t,t.return),Yl(t);break;case 22:null===t.memoizedState&&Yl(t);break;default:Yl(t)}e=e.sibling}}function Jl(e,t,r){for(r=r&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var n=t.alternate,a=e,s=t,i=s.flags;switch(s.tag){case 0:case 11:case 15:Jl(a,s,r),gl(4,s);break;case 1:if(Jl(a,s,r),"function"===typeof(a=(n=s).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){_u(n,n.return,c)}if(null!==(a=(n=s).updateQueue)){var o=n.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)ks(l[a],o)}catch(c){_u(n,n.return,c)}}r&&64&i&&bl(s),xl(s,s.return);break;case 27:jl(s);case 26:case 5:Jl(a,s,r),r&&null===n&&4&i&&Sl(s),xl(s,s.return);break;case 12:Jl(a,s,r);break;case 31:Jl(a,s,r),r&&4&i&&zl(a,s);break;case 13:Jl(a,s,r),r&&4&i&&Bl(a,s);break;case 22:null===s.memoizedState&&Jl(a,s,r),xl(s,s.return);break;case 30:break;default:Jl(a,s,r)}t=t.sibling}}function Xl(e,t){var r=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==r&&(null!=e&&e.refCount++,null!=r&&za(r))}function Ql(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&za(e))}function Zl(e,t,r,n){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ec(e,t,r,n),t=t.sibling}function ec(e,t,r,n){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Zl(e,t,r,n),2048&a&&gl(9,t);break;case 1:case 31:case 13:default:Zl(e,t,r,n);break;case 3:Zl(e,t,r,n),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&za(e)));break;case 12:if(2048&a){Zl(e,t,r,n),e=t.stateNode;try{var s=t.memoizedProps,i=s.id,o=s.onPostCommit;"function"===typeof o&&o(i,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){_u(t,t.return,l)}}else Zl(e,t,r,n);break;case 23:break;case 22:s=t.stateNode,i=t.alternate,null!==t.memoizedState?2&s._visibility?Zl(e,t,r,n):rc(e,t):2&s._visibility?Zl(e,t,r,n):(s._visibility|=2,tc(e,t,r,n,0!==(10256&t.subtreeFlags)||!1)),2048&a&&Xl(i,t);break;case 24:Zl(e,t,r,n),2048&a&&Ql(t.alternate,t)}}function tc(e,t,r,n,a){for(a=a&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var s=e,i=t,o=r,l=n,c=i.flags;switch(i.tag){case 0:case 11:case 15:tc(s,i,o,l,a),gl(8,i);break;case 23:break;case 22:var u=i.stateNode;null!==i.memoizedState?2&u._visibility?tc(s,i,o,l,a):rc(s,i):(u._visibility|=2,tc(s,i,o,l,a)),a&&2048&c&&Xl(i.alternate,i);break;case 24:tc(s,i,o,l,a),a&&2048&c&&Ql(i.alternate,i);break;default:tc(s,i,o,l,a)}t=t.sibling}}function rc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var r=e,n=t,a=n.flags;switch(n.tag){case 22:rc(r,n),2048&a&&Xl(n.alternate,n);break;case 24:rc(r,n),2048&a&&Ql(n.alternate,n);break;default:rc(r,n)}t=t.sibling}}var nc=8192;function ac(e,t,r){if(e.subtreeFlags&nc)for(e=e.child;null!==e;)sc(e,t,r),e=e.sibling}function sc(e,t,r){switch(e.tag){case 26:ac(e,t,r),e.flags&nc&&null!==e.memoizedState&&function(e,t,r,n){if("stylesheet"===r.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&r.state.loading)){if(null===r.instance){var a=qd(n.href),s=t.querySelector(Kd(a));if(s)return null!==(t=s._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=ih.bind(e),t.then(e,e)),r.state.loading|=4,r.instance=s,void et(s);s=t.ownerDocument||t,n=$d(n),(a=Ud.get(a))&&Zd(n,a),et(s=s.createElement("link"));var i=s;i._p=new Promise(function(e,t){i.onload=e,i.onerror=t}),hd(s,"link",n),r.instance=s}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(r,t),(t=r.state.preload)&&0===(3&r.state.loading)&&(e.count++,r=ih.bind(e),t.addEventListener("load",r),t.addEventListener("error",r))}}(r,Vl,e.memoizedState,e.memoizedProps);break;case 5:default:ac(e,t,r);break;case 3:case 4:var n=Vl;Vl=Bd(e.stateNode.containerInfo),ac(e,t,r),Vl=n;break;case 22:null===e.memoizedState&&(null!==(n=e.alternate)&&null!==n.memoizedState?(n=nc,nc=16777216,ac(e,t,r),nc=n):ac(e,t,r))}}function ic(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function oc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var r=0;r<t.length;r++){var n=t[r];Rl=n,uc(n,e)}ic(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)lc(e),e=e.sibling}function lc(e){switch(e.tag){case 0:case 11:case 15:oc(e),2048&e.flags&&vl(9,e,e.return);break;case 3:case 12:default:oc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cc(e)):oc(e)}}function cc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var r=0;r<t.length;r++){var n=t[r];Rl=n,uc(n,e)}ic(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:vl(8,t,t.return),cc(t);break;case 22:2&(r=t.stateNode)._visibility&&(r._visibility&=-3,cc(t));break;default:cc(t)}e=e.sibling}}function uc(e,t){for(;null!==Rl;){var r=Rl;switch(r.tag){case 0:case 11:case 15:vl(8,r,t);break;case 23:case 22:if(null!==r.memoizedState&&null!==r.memoizedState.cachePool){var n=r.memoizedState.cachePool.pool;null!=n&&n.refCount++}break;case 24:za(r.memoizedState.cache)}if(null!==(n=r.child))n.return=r,Rl=n;else e:for(r=e;null!==Rl;){var a=(n=Rl).sibling,s=n.return;if(Dl(n),n===r){Rl=null;break e}if(null!==a){a.return=s,Rl=a;break e}Rl=s}}}var dc={getCacheForType:function(e){var t=Pa(Fa),r=t.data.get(e);return void 0===r&&(r=e(),t.data.set(e,r)),r},cacheSignal:function(){return Pa(Fa).controller.signal}},hc="function"===typeof WeakMap?WeakMap:Map,fc=0,mc=null,pc=null,gc=0,vc=0,bc=null,yc=!1,xc=!1,wc=!1,Sc=0,_c=0,Ec=0,kc=0,Tc=0,Nc=0,jc=0,Ac=null,Cc=null,Oc=!1,Pc=0,Rc=0,Ic=1/0,Dc=null,Lc=null,Mc=0,Fc=null,Uc=null,zc=0,Bc=0,Hc=null,Wc=null,Vc=0,Gc=null;function qc(){return 0!==(2&fc)&&0!==gc?gc&-gc:null!==I.T?Hu():Fe()}function Kc(){if(0===Nc)if(0===(536870912&gc)||da){var e=Ee;0===(3932160&(Ee<<=1))&&(Ee=262144),Nc=e}else Nc=536870912;return null!==(e=Ps.current)&&(e.flags|=32),Nc}function $c(e,t,r){(e!==mc||2!==vc&&9!==vc)&&null===e.cancelPendingCommit||(tu(e,0),Qc(e,gc,Nc,!1)),Pe(e,r),0!==(2&fc)&&e===mc||(e===mc&&(0===(2&fc)&&(kc|=r),4===_c&&Qc(e,gc,Nc,!1)),Du(e))}function Yc(e,t,r){if(0!==(6&fc))throw Error(i(327));for(var n=!r&&0===(127&t)&&0===(t&e.expiredLanes)||je(e,t),a=n?function(e,t){var r=fc;fc|=2;var n=au(),a=su();mc!==e||gc!==t?(Dc=null,Ic=le()+500,tu(e,t)):xc=je(e,t);e:for(;;)try{if(0!==vc&&null!==pc){t=pc;var s=bc;t:switch(vc){case 1:vc=0,bc=null,hu(e,t,s,1);break;case 2:case 9:if(ts(s)){vc=0,bc=null,du(t);break}t=function(){2!==vc&&9!==vc||mc!==e||(vc=7),Du(e)},s.then(t,t);break e;case 3:vc=7;break e;case 4:vc=5;break e;case 7:ts(s)?(vc=0,bc=null,du(t)):(vc=0,bc=null,hu(e,t,s,7));break;case 5:var o=null;switch(pc.tag){case 26:o=pc.memoizedState;case 5:case 27:var l=pc;if(o?ah(o):l.stateNode.complete){vc=0,bc=null;var c=l.sibling;if(null!==c)pc=c;else{var u=l.return;null!==u?(pc=u,fu(u)):pc=null}break t}}vc=0,bc=null,hu(e,t,s,5);break;case 6:vc=0,bc=null,hu(e,t,s,6);break;case 8:eu(),_c=6;break e;default:throw Error(i(462))}}cu();break}catch(d){ru(e,d)}return Ea=_a=null,I.H=n,I.A=a,fc=r,null!==pc?0:(mc=null,gc=0,Cn(),_c)}(e,t):ou(e,t,!0),s=n;;){if(0===a){xc&&!n&&Qc(e,t,0,!1);break}if(r=e.current.alternate,!s||Xc(r)){if(2===a){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;a=Ac;var c=l.current.memoizedState.isDehydrated;if(c&&(tu(l,o).flags|=256),2!==(o=ou(l,o,!1))){if(wc&&!c){l.errorRecoveryDisabledLanes|=s,kc|=s,a=4;break e}s=Cc,Cc=a,null!==s&&(null===Cc?Cc=s:Cc.push.apply(Cc,s))}a=o}if(s=!1,2!==a)continue}}if(1===a){tu(e,0),Qc(e,t,0,!0);break}e:{switch(n=e,s=a){case 0:case 1:throw Error(i(345));case 4:if((4194048&t)!==t)break;case 6:Qc(n,t,Nc,!yc);break e;case 2:Cc=null;break;case 3:case 5:break;default:throw Error(i(329))}if((62914560&t)===t&&10<(a=Pc+300-le())){if(Qc(n,t,Nc,!yc),0!==Ne(n,0,!0))break e;zc=t,n.timeoutHandle=wd(Jc.bind(null,n,r,Cc,Dc,Oc,t,Nc,kc,jc,yc,s,"Throttled",-0,0),a)}else Jc(n,r,Cc,Dc,Oc,t,Nc,kc,jc,yc,s,null,-0,0)}break}a=ou(e,t,!1),s=!1}Du(e)}function Jc(e,t,r,n,a,s,i,o,l,c,u,d,h,f){if(e.timeoutHandle=-1,8192&(d=t.subtreeFlags)||16785408===(16785408&d)){sc(t,s,d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pt});var m=(62914560&s)===s?Pc-le():(4194048&s)===s?Rc-le():0;if(null!==(m=function(e,t){return e.stylesheets&&0===e.count&&lh(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var n=setTimeout(function(){if(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===sh&&(sh=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,r=performance.getEntriesByType("resource"),n=0;n<r.length;n++){var a=r[n],s=a.transferSize,i=a.initiatorType,o=a.duration;if(s&&o&&fd(i)){for(i=0,o=a.responseEnd,n+=1;n<r.length;n++){var l=r[n],c=l.startTime;if(c>o)break;var u=l.transferSize,d=l.initiatorType;u&&fd(d)&&(i+=u*((l=l.responseEnd)<o?1:(o-c)/(l-c)))}if(--n,t+=8*(s+i)/(a.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var a=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>sh?50:800)+t);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(n),clearTimeout(a)}}:null}(d,m)))return zc=s,e.cancelPendingCommit=m(pu.bind(null,e,t,s,r,n,a,i,o,l,u,d,null,h,f)),void Qc(e,s,i,!c)}pu(e,t,s,r,n,a,i,o,l)}function Xc(e){for(var t=e;;){var r=t.tag;if((0===r||11===r||15===r)&&16384&t.flags&&(null!==(r=t.updateQueue)&&null!==(r=r.stores)))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Xr(s(),a))return!1}catch(i){return!1}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Qc(e,t,r,n){t&=~Tc,t&=~kc,e.suspendedLanes|=t,e.pingedLanes&=~t,n&&(e.warmLanes|=t),n=e.expirationTimes;for(var a=t;0<a;){var s=31-xe(a),i=1<<s;n[s]=-1,a&=~i}0!==r&&Re(e,r,t)}function Zc(){return 0!==(6&fc)||(Lu(0,!1),!1)}function eu(){if(null!==pc){if(0===vc)var e=pc.return;else Ea=_a=null,ii(e=pc),os=null,ls=0,e=pc;for(;null!==e;)pl(e.alternate,e),e=e.return;pc=null}}function tu(e,t){var r=e.timeoutHandle;-1!==r&&(e.timeoutHandle=-1,Sd(r)),null!==(r=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,r()),zc=0,eu(),mc=e,pc=r=zn(e.current,null),gc=t,vc=0,bc=null,yc=!1,xc=je(e,t),wc=!1,jc=Nc=Tc=kc=Ec=_c=0,Cc=Ac=null,Oc=!1,0!==(8&t)&&(t|=32&t);var n=e.entangledLanes;if(0!==n)for(e=e.entanglements,n&=t;0<n;){var a=31-xe(n),s=1<<a;t|=e[a],n&=~s}return Sc=t,Cn(),r}function ru(e,t){Hs=null,I.H=po,t===Xa||t===Za?(t=ss(),vc=3):t===Qa?(t=ss(),vc=4):vc=t===Po?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,bc=t,null===pc&&(_c=1,No(e,$n(t,e.current)))}function nu(){var e=Ps.current;return null===e||((4194048&gc)===gc?null===Rs:((62914560&gc)===gc||0!==(536870912&gc))&&e===Rs)}function au(){var e=I.H;return I.H=po,null===e?po:e}function su(){var e=I.A;return I.A=dc,e}function iu(){_c=4,yc||(4194048&gc)!==gc&&null!==Ps.current||(xc=!0),0===(134217727&Ec)&&0===(134217727&kc)||null===mc||Qc(mc,gc,Nc,!1)}function ou(e,t,r){var n=fc;fc|=2;var a=au(),s=su();mc===e&&gc===t||(Dc=null,tu(e,t)),t=!1;var i=_c;e:for(;;)try{if(0!==vc&&null!==pc){var o=pc,l=bc;switch(vc){case 8:eu(),i=6;break e;case 3:case 2:case 9:case 6:null===Ps.current&&(t=!0);var c=vc;if(vc=0,bc=null,hu(e,o,l,c),r&&xc){i=0;break e}break;default:c=vc,vc=0,bc=null,hu(e,o,l,c)}}lu(),i=_c;break}catch(u){ru(e,u)}return t&&e.shellSuspendCounter++,Ea=_a=null,fc=n,I.H=a,I.A=s,null===pc&&(mc=null,gc=0,Cn()),i}function lu(){for(;null!==pc;)uu(pc)}function cu(){for(;null!==pc&&!ie();)uu(pc)}function uu(e){var t=il(e.alternate,e,Sc);e.memoizedProps=e.pendingProps,null===t?fu(e):pc=t}function du(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Go(r,t,t.pendingProps,t.type,void 0,gc);break;case 11:t=Go(r,t,t.pendingProps,t.type.render,t.ref,gc);break;case 5:ii(t);default:pl(r,t),t=il(r,t=pc=Bn(t,Sc),Sc)}e.memoizedProps=e.pendingProps,null===t?fu(e):pc=t}function hu(e,t,r,n){Ea=_a=null,ii(t),os=null,ls=0;var a=t.return;try{if(function(e,t,r,n,a){if(r.flags|=32768,null!==n&&"object"===typeof n&&"function"===typeof n.then){if(null!==(t=r.alternate)&&Aa(t,r,a,!0),null!==(r=Ps.current)){switch(r.tag){case 31:case 13:return null===Rs?iu():null===r.alternate&&0===_c&&(_c=3),r.flags&=-257,r.flags|=65536,r.lanes=a,n===es?r.flags|=16384:(null===(t=r.updateQueue)?r.updateQueue=new Set([n]):t.add(n),Eu(e,n,a)),!1;case 22:return r.flags|=65536,n===es?r.flags|=16384:(null===(t=r.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([n])},r.updateQueue=t):null===(r=t.retryQueue)?t.retryQueue=new Set([n]):r.add(n),Eu(e,n,a)),!1}throw Error(i(435,r.tag))}return Eu(e,n,a),iu(),!1}if(da)return null!==(t=Ps.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=a,n!==ma&&wa($n(e=Error(i(422),{cause:n}),r))):(n!==ma&&wa($n(t=Error(i(423),{cause:n}),r)),(e=e.current.alternate).flags|=65536,a&=-a,e.lanes|=a,n=$n(n,r),ws(e,a=Ao(e.stateNode,n,a)),4!==_c&&(_c=2)),!1;var s=Error(i(520),{cause:n});if(s=$n(s,r),null===Ac?Ac=[s]:Ac.push(s),4!==_c&&(_c=2),null===t)return!0;n=$n(n,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=a&-a,r.lanes|=e,ws(r,e=Ao(r.stateNode,n,e)),!1;case 1:if(t=r.type,s=r.stateNode,0===(128&r.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Lc||!Lc.has(s))))return r.flags|=65536,a&=-a,r.lanes|=a,Oo(a=Co(a),e,r,n),ws(r,a),!1}r=r.return}while(null!==r);return!1}(e,a,t,r,gc))return _c=1,No(e,$n(r,e.current)),void(pc=null)}catch(s){if(null!==a)throw pc=a,s;return _c=1,No(e,$n(r,e.current)),void(pc=null)}32768&t.flags?(da||1===n?e=!0:xc||0!==(536870912&gc)?e=!1:(yc=e=!0,(2===n||9===n||3===n||6===n)&&(null!==(n=Ps.current)&&13===n.tag&&(n.flags|=16384))),mu(t,e)):fu(t)}function fu(e){var t=e;do{if(0!==(32768&t.flags))return void mu(t,yc);e=t.return;var r=fl(t.alternate,t,Sc);if(null!==r)return void(pc=r);if(null!==(t=t.sibling))return void(pc=t);pc=t=e}while(null!==t);0===_c&&(_c=5)}function mu(e,t){do{var r=ml(e.alternate,e);if(null!==r)return r.flags&=32767,void(pc=r);if(null!==(r=e.return)&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&null!==(e=e.sibling))return void(pc=e);pc=e=r}while(null!==e);_c=6,pc=null}function pu(e,t,r,n,a,s,o,l,c){e.cancelPendingCommit=null;do{xu()}while(0!==Mc);if(0!==(6&fc))throw Error(i(327));if(null!==t){if(t===e.current)throw Error(i(177));if(s=t.lanes|t.childLanes,function(e,t,r,n,a,s){var i=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(r=i&~r;0<r;){var u=31-xe(r),d=1<<u;o[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var f=h[u];null!==f&&(f.lane&=-536870913)}r&=~d}0!==n&&Re(e,n,0),0!==s&&0===a&&0!==e.tag&&(e.suspendedLanes|=s&~(i&~t))}(e,r,s|=An,o,l,c),e===mc&&(pc=mc=null,gc=0),Uc=t,Fc=e,zc=r,Bc=s,Hc=a,Wc=n,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,ae(he,function(){return wu(),null})):(e.callbackNode=null,e.callbackPriority=0),n=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||n){n=I.T,I.T=null,a=D.p,D.p=2,o=fc,fc|=4;try{!function(e,t){if(e=e.containerInfo,md=yh,nn(e=rn(e))){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch(g){r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var m;h!==r||0!==a&&3!==h.nodeType||(l=o+a),h!==s||0!==n&&3!==h.nodeType||(c=o+n),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)f=h,h=m;for(;;){if(h===e)break t;if(f===r&&++u===a&&(l=o),f===s&&++d===n&&(c=o),null!==(m=h.nextSibling))break;f=(h=f).parentNode}h=m}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(pd={focusedElem:e,selectionRange:r},yh=!1,Rl=t;null!==Rl;)if(e=(t=Rl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Rl=e;else for(;null!==Rl;){switch(s=(t=Rl).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(r=0;r<e.length;r++)(a=e[r]).ref.impl=a.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,r=t,a=s.memoizedProps,s=s.memoizedState,n=r.stateNode;try{var p=_o(r.type,a);e=n.getSnapshotBeforeUpdate(p,s),n.__reactInternalSnapshotBeforeUpdate=e}catch(v){_u(r,r.return,v)}}break;case 3:if(0!==(1024&e))if(9===(r=(e=t.stateNode.containerInfo).nodeType))Ad(e);else if(1===r)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Ad(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(i(163))}if(null!==(e=t.sibling)){e.return=t.return,Rl=e;break}Rl=t.return}}(e,t)}finally{fc=o,D.p=a,I.T=n}}Mc=1,gu(),vu(),bu()}}function gu(){if(1===Mc){Mc=0;var e=Fc,t=Uc,r=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||r){r=I.T,I.T=null;var n=D.p;D.p=2;var a=fc;fc|=4;try{Gl(t,e);var s=pd,i=rn(e.containerInfo),o=s.focusedElem,l=s.selectionRange;if(i!==o&&o&&o.ownerDocument&&tn(o.ownerDocument.documentElement,o)){if(null!==l&&nn(o)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(u,o.value.length);else{var d=o.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var f=h.getSelection(),m=o.textContent.length,p=Math.min(l.start,m),g=void 0===l.end?p:Math.min(l.end,m);!f.extend&&p>g&&(i=g,g=p,p=i);var v=en(o,p),b=en(o,g);if(v&&b&&(1!==f.rangeCount||f.anchorNode!==v.node||f.anchorOffset!==v.offset||f.focusNode!==b.node||f.focusOffset!==b.offset)){var y=d.createRange();y.setStart(v.node,v.offset),f.removeAllRanges(),p>g?(f.addRange(y),f.extend(b.node,b.offset)):(y.setEnd(b.node,b.offset),f.addRange(y))}}}}for(d=[],f=o;f=f.parentNode;)1===f.nodeType&&d.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<d.length;o++){var x=d[o];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}yh=!!md,pd=md=null}finally{fc=a,D.p=n,I.T=r}}e.current=t,Mc=2}}function vu(){if(2===Mc){Mc=0;var e=Fc,t=Uc,r=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||r){r=I.T,I.T=null;var n=D.p;D.p=2;var a=fc;fc|=4;try{Il(e,t.alternate,t)}finally{fc=a,D.p=n,I.T=r}}Mc=3}}function bu(){if(4===Mc||3===Mc){Mc=0,oe();var e=Fc,t=Uc,r=zc,n=Wc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Mc=5:(Mc=0,Uc=Fc=null,yu(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(Lc=null),Me(r),t=t.stateNode,be&&"function"===typeof be.onCommitFiberRoot)try{be.onCommitFiberRoot(ve,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==n){t=I.T,a=D.p,D.p=2,I.T=null;try{for(var s=e.onRecoverableError,i=0;i<n.length;i++){var o=n[i];s(o.value,{componentStack:o.stack})}}finally{I.T=t,D.p=a}}0!==(3&zc)&&xu(),Du(e),a=e.pendingLanes,0!==(261930&r)&&0!==(42&a)?e===Gc?Vc++:(Vc=0,Gc=e):Vc=0,Lu(0,!1)}}function yu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,za(t)))}function xu(){return gu(),vu(),bu(),wu()}function wu(){if(5!==Mc)return!1;var e=Fc,t=Bc;Bc=0;var r=Me(zc),n=I.T,a=D.p;try{D.p=32>r?32:r,I.T=null,r=Hc,Hc=null;var s=Fc,o=zc;if(Mc=0,Uc=Fc=null,zc=0,0!==(6&fc))throw Error(i(331));var l=fc;if(fc|=4,lc(s.current),ec(s,s.current,o,r),fc=l,Lu(0,!1),be&&"function"===typeof be.onPostCommitFiberRoot)try{be.onPostCommitFiberRoot(ve,s)}catch(c){}return!0}finally{D.p=a,I.T=n,yu(e,t)}}function Su(e,t,r){t=$n(r,t),null!==(e=ys(e,t=Ao(e.stateNode,t,2),2))&&(Pe(e,2),Du(e))}function _u(e,t,r){if(3===e.tag)Su(e,e,r);else for(;null!==t;){if(3===t.tag){Su(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Lc||!Lc.has(n))){e=$n(r,e),null!==(n=ys(t,r=Co(2),2))&&(Oo(r,n,t,e),Pe(n,2),Du(n));break}}t=t.return}}function Eu(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new hc;var a=new Set;n.set(t,a)}else void 0===(a=n.get(t))&&(a=new Set,n.set(t,a));a.has(r)||(wc=!0,a.add(r),e=ku.bind(null,e,t,r),t.then(e,e))}function ku(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,mc===e&&(gc&r)===r&&(4===_c||3===_c&&(62914560&gc)===gc&&300>le()-Pc?0===(2&fc)&&tu(e,0):Tc|=r,jc===gc&&(jc=0)),Du(e)}function Tu(e,t){0===t&&(t=Ce()),null!==(e=Rn(e,t))&&(Pe(e,t),Du(e))}function Nu(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Tu(e,r)}function ju(e,t){var r=0;switch(e.tag){case 31:case 13:var n=e.stateNode,a=e.memoizedState;null!==a&&(r=a.retryLane);break;case 19:n=e.stateNode;break;case 22:n=e.stateNode._retryCache;break;default:throw Error(i(314))}null!==n&&n.delete(t),Tu(e,r)}var Au=null,Cu=null,Ou=!1,Pu=!1,Ru=!1,Iu=0;function Du(e){e!==Cu&&null===e.next&&(null===Cu?Au=Cu=e:Cu=Cu.next=e),Pu=!0,Ou||(Ou=!0,Ed(function(){0!==(6&fc)?ae(ue,Mu):Fu()}))}function Lu(e,t){if(!Ru&&Pu){Ru=!0;do{for(var r=!1,n=Au;null!==n;){if(!t)if(0!==e){var a=n.pendingLanes;if(0===a)var s=0;else{var i=n.suspendedLanes,o=n.pingedLanes;s=(1<<31-xe(42|e)+1)-1,s=201326741&(s&=a&~(i&~o))?201326741&s|1:s?2|s:0}0!==s&&(r=!0,Bu(n,s))}else s=gc,0===(3&(s=Ne(n,n===mc?s:0,null!==n.cancelPendingCommit||-1!==n.timeoutHandle)))||je(n,s)||(r=!0,Bu(n,s));n=n.next}}while(r);Ru=!1}}function Mu(){Fu()}function Fu(){Pu=Ou=!1;var e=0;0!==Iu&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==xd&&(xd=e,!0);return xd=null,!1}()&&(e=Iu);for(var t=le(),r=null,n=Au;null!==n;){var a=n.next,s=Uu(n,t);0===s?(n.next=null,null===r?Au=a:r.next=a,null===a&&(Cu=r)):(r=n,(0!==e||0!==(3&s))&&(Pu=!0)),n=a}0!==Mc&&5!==Mc||Lu(e,!1),0!==Iu&&(Iu=0)}function Uu(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var i=31-xe(s),o=1<<i,l=a[i];-1===l?0!==(o&r)&&0===(o&n)||(a[i]=Ae(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}if(r=gc,r=Ne(e,e===(t=mc)?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),n=e.callbackNode,0===r||e===t&&(2===vc||9===vc)||null!==e.cancelPendingCommit)return null!==n&&null!==n&&se(n),e.callbackNode=null,e.callbackPriority=0;if(0===(3&r)||je(e,r)){if((t=r&-r)===e.callbackPriority)return t;switch(null!==n&&se(n),Me(r)){case 2:case 8:r=de;break;case 32:default:r=he;break;case 268435456:r=me}return n=zu.bind(null,e),r=ae(r,n),e.callbackPriority=t,e.callbackNode=r,t}return null!==n&&null!==n&&se(n),e.callbackPriority=2,e.callbackNode=null,2}function zu(e,t){if(0!==Mc&&5!==Mc)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(xu()&&e.callbackNode!==r)return null;var n=gc;return 0===(n=Ne(e,e===mc?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Yc(e,n,t),Uu(e,le()),null!=e.callbackNode&&e.callbackNode===r?zu.bind(null,e):null)}function Bu(e,t){if(xu())return null;Yc(e,t,!0)}function Hu(){if(0===Iu){var e=Wa;0===e&&(e=_e,0===(261888&(_e<<=1))&&(_e=256)),Iu=e}return Iu}function Wu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Ot(""+e)}function Vu(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}for(var Gu=0;Gu<En.length;Gu++){var qu=En[Gu];kn(qu.toLowerCase(),"on"+(qu[0].toUpperCase()+qu.slice(1)))}kn(gn,"onAnimationEnd"),kn(vn,"onAnimationIteration"),kn(bn,"onAnimationStart"),kn("dblclick","onDoubleClick"),kn("focusin","onFocus"),kn("focusout","onBlur"),kn(yn,"onTransitionRun"),kn(xn,"onTransitionStart"),kn(wn,"onTransitionCancel"),kn(Sn,"onTransitionEnd"),at("onMouseEnter",["mouseout","mouseover"]),at("onMouseLeave",["mouseout","mouseover"]),at("onPointerEnter",["pointerout","pointerover"]),at("onPointerLeave",["pointerout","pointerover"]),nt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),nt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),nt("onBeforeInput",["compositionend","keypress","textInput","paste"]),nt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ku="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$u=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ku));function Yu(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;s=o,a.currentTarget=c;try{s(a)}catch(u){Tn(u)}a.currentTarget=null,s=l}else for(i=0;i<n.length;i++){if(l=(o=n[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;s=o,a.currentTarget=c;try{s(a)}catch(u){Tn(u)}a.currentTarget=null,s=l}}}}function Ju(e,t){var r=t[Ve];void 0===r&&(r=t[Ve]=new Set);var n=e+"__bubble";r.has(n)||(ed(t,e,2,!1),r.add(n))}function Xu(e,t,r){var n=0;t&&(n|=4),ed(r,e,n,t)}var Qu="_reactListening"+Math.random().toString(36).slice(2);function Zu(e){if(!e[Qu]){e[Qu]=!0,tt.forEach(function(t){"selectionchange"!==t&&($u.has(t)||Xu(t,!1,e),Xu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Qu]||(t[Qu]=!0,Xu("selectionchange",!1,t))}}function ed(e,t,r,n){switch(Th(t)){case 2:var a=xh;break;case 8:a=wh;break;default:a=Sh}r=a.bind(null,t,r,e),a=void 0,!Ht||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),n?void 0!==a?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):void 0!==a?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function td(e,t,r,n,a){var s=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var i=n.tag;if(3===i||4===i){var o=n.stateNode.containerInfo;if(o===a)break;if(4===i)for(i=n.return;null!==i;){var c=i.tag;if((3===c||4===c)&&i.stateNode.containerInfo===a)return;i=i.return}for(;null!==o;){if(null===(i=Je(o)))return;if(5===(c=i.tag)||6===c||26===c||27===c){n=s=i;continue e}o=o.parentNode}}n=n.return}Ut(function(){var n=s,a=It(r),i=[];e:{var o=_n.get(e);if(void 0!==o){var c=rr,u=e;switch(e){case"keypress":if(0===$t(r))break e;case"keydown":case"keyup":c=vr;break;case"focusin":u="focus",c=lr;break;case"focusout":u="blur",c=lr;break;case"beforeblur":case"afterblur":c=lr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=ir;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=or;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=yr;break;case gn:case vn:case bn:c=cr;break;case Sn:c=xr;break;case"scroll":case"scrollend":c=ar;break;case"wheel":c=wr;break;case"copy":case"cut":case"paste":c=ur;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=br;break;case"toggle":case"beforetoggle":c=Sr}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),f=d?null!==o?o+"Capture":null:o;d=[];for(var m,p=n;null!==p;){var g=p;if(m=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===m||null===f||null!=(g=zt(p,f))&&d.push(rd(p,g,m)),h)break;p=p.return}0<d.length&&(o=new c(o,u,null,r,a),i.push({event:o,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===Rt||!(u=r.relatedTarget||r.fromElement)||!Je(u)&&!u[We])&&(c||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=n,null!==(u=(u=r.relatedTarget||r.toElement)?Je(u):null)&&(h=l(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=n),c!==u)){if(d=ir,g="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(d=br,g="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==c?o:Qe(c),m=null==u?o:Qe(u),(o=new d(g,p+"leave",c,r,a)).target=h,o.relatedTarget=m,g=null,Je(a)===n&&((d=new d(f,p+"enter",u,r,a)).target=m,d.relatedTarget=h,g=d),h=g,c&&u)e:{for(d=ad,p=u,m=0,g=f=c;g;g=d(g))m++;g=0;for(var v=p;v;v=d(v))g++;for(;0<m-g;)f=d(f),m--;for(;0<g-m;)p=d(p),g--;for(;m--;){if(f===p||null!==p&&f===p.alternate){d=f;break e}f=d(f),p=d(p)}d=null}else d=null;null!==c&&sd(i,o,c,d,!1),null!==u&&null!==h&&sd(i,h,u,d,!0)}if("select"===(c=(o=n?Qe(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var b=zr;else if(Ir(o))if(Br)b=Jr;else{b=$r;var y=Kr}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?n&&jt(n.elementType)&&(b=zr):b=Yr;switch(b&&(b=b(e,n))?Dr(i,b,r,a):(y&&y(e,o,n),"focusout"===e&&n&&"number"===o.type&&null!=n.memoizedProps.value&&xt(o,"number",o.value)),y=n?Qe(n):window,e){case"focusin":(Ir(y)||"true"===y.contentEditable)&&(sn=y,on=n,ln=null);break;case"focusout":ln=on=sn=null;break;case"mousedown":cn=!0;break;case"contextmenu":case"mouseup":case"dragend":cn=!1,un(i,r,a);break;case"selectionchange":if(an)break;case"keydown":case"keyup":un(i,r,a)}var x;if(Er)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Pr?Cr(e,r)&&(w="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(w="onCompositionStart");w&&(Nr&&"ko"!==r.locale&&(Pr||"onCompositionStart"!==w?"onCompositionEnd"===w&&Pr&&(x=Kt()):(Gt="value"in(Vt=a)?Vt.value:Vt.textContent,Pr=!0)),0<(y=nd(n,w)).length&&(w=new dr(w,e,null,r,a),i.push({event:w,listeners:y}),x?w.data=x:null!==(x=Or(r))&&(w.data=x))),(x=Tr?function(e,t){switch(e){case"compositionend":return Or(t);case"keypress":return 32!==t.which?null:(Ar=!0,jr);case"textInput":return(e=t.data)===jr&&Ar?null:e;default:return null}}(e,r):function(e,t){if(Pr)return"compositionend"===e||!Er&&Cr(e,t)?(e=Kt(),qt=Gt=Vt=null,Pr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Nr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(w=nd(n,"onBeforeInput")).length&&(y=new dr("onBeforeInput","beforeinput",null,r,a),i.push({event:y,listeners:w}),y.data=x)),function(e,t,r,n,a){if("submit"===t&&r&&r.stateNode===a){var s=Wu((a[He]||null).action),i=n.submitter;i&&null!==(t=(t=i[He]||null)?Wu(t.formAction):i.getAttribute("formAction"))&&(s=t,i=null);var o=new rr("action","action",null,n,a);e.push({event:o,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(0!==Iu){var e=i?Vu(a,i):new FormData(a);eo(r,{pending:!0,data:e,method:a.method,action:s},null,e)}}else"function"===typeof s&&(o.preventDefault(),e=i?Vu(a,i):new FormData(a),eo(r,{pending:!0,data:e,method:a.method,action:s},s,e))},currentTarget:a}]})}}(i,e,n,r,a)}Yu(i,t)})}function rd(e,t,r){return{instance:e,listener:t,currentTarget:r}}function nd(e,t){for(var r=t+"Capture",n=[];null!==e;){var a=e,s=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===s||(null!=(a=zt(e,r))&&n.unshift(rd(e,a,s)),null!=(a=zt(e,t))&&n.push(rd(e,a,s))),3===e.tag)return n;e=e.return}return[]}function ad(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function sd(e,t,r,n,a){for(var s=t._reactName,i=[];null!==r&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===n)break;5!==o&&26!==o&&27!==o||null===c||(l=c,a?null!=(c=zt(r,s))&&i.unshift(rd(r,c,l)):a||null!=(c=zt(r,s))&&i.push(rd(r,c,l))),r=r.return}0!==i.length&&e.push({event:t,listeners:i})}var id=/\r\n?/g,od=/\u0000|\uFFFD/g;function ld(e){return("string"===typeof e?e:""+e).replace(id,"\n").replace(od,"")}function cd(e,t){return t=ld(t),ld(e)===t}function ud(e,t,r,n,a,s){switch(r){case"children":"string"===typeof n?"body"===t||"textarea"===t&&""===n||Et(e,n):("number"===typeof n||"bigint"===typeof n)&&"body"!==t&&Et(e,""+n);break;case"className":ct(e,"class",n);break;case"tabIndex":ct(e,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,r,n);break;case"style":Nt(e,n,s);break;case"data":if("object"!==t){ct(e,"data",n);break}case"src":case"href":if(""===n&&("a"!==t||"href"!==r)){e.removeAttribute(r);break}if(null==n||"function"===typeof n||"symbol"===typeof n||"boolean"===typeof n){e.removeAttribute(r);break}n=Ot(""+n),e.setAttribute(r,n);break;case"action":case"formAction":if("function"===typeof n){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===r?("input"!==t&&ud(e,t,"name",a.name,a,null),ud(e,t,"formEncType",a.formEncType,a,null),ud(e,t,"formMethod",a.formMethod,a,null),ud(e,t,"formTarget",a.formTarget,a,null)):(ud(e,t,"encType",a.encType,a,null),ud(e,t,"method",a.method,a,null),ud(e,t,"target",a.target,a,null))),null==n||"symbol"===typeof n||"boolean"===typeof n){e.removeAttribute(r);break}n=Ot(""+n),e.setAttribute(r,n);break;case"onClick":null!=n&&(e.onclick=Pt);break;case"onScroll":null!=n&&Ju("scroll",e);break;case"onScrollEnd":null!=n&&Ju("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(i(61));if(null!=(r=n.__html)){if(null!=a.children)throw Error(i(60));e.innerHTML=r}}break;case"multiple":e.multiple=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"muted":e.muted=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==n||"function"===typeof n||"boolean"===typeof n||"symbol"===typeof n){e.removeAttribute("xlink:href");break}r=Ot(""+n),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(r,""+n):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":!0===n?e.setAttribute(r,""):!1!==n&&null!=n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(r,n):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":null!=n&&"function"!==typeof n&&"symbol"!==typeof n&&!isNaN(n)&&1<=n?e.setAttribute(r,n):e.removeAttribute(r);break;case"rowSpan":case"start":null==n||"function"===typeof n||"symbol"===typeof n||isNaN(n)?e.removeAttribute(r):e.setAttribute(r,n);break;case"popover":Ju("beforetoggle",e),Ju("toggle",e),lt(e,"popover",n);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":lt(e,"is",n);break;case"innerText":case"textContent":break;default:(!(2<r.length)||"o"!==r[0]&&"O"!==r[0]||"n"!==r[1]&&"N"!==r[1])&&lt(e,r=At.get(r)||r,n)}}function dd(e,t,r,n,a,s){switch(r){case"style":Nt(e,n,s);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(i(61));if(null!=(r=n.__html)){if(null!=a.children)throw Error(i(60));e.innerHTML=r}}break;case"children":"string"===typeof n?Et(e,n):("number"===typeof n||"bigint"===typeof n)&&Et(e,""+n);break;case"onScroll":null!=n&&Ju("scroll",e);break;case"onScrollEnd":null!=n&&Ju("scrollend",e);break;case"onClick":null!=n&&(e.onclick=Pt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:rt.hasOwnProperty(r)||("o"!==r[0]||"n"!==r[1]||(a=r.endsWith("Capture"),t=r.slice(2,a?r.length-7:void 0),"function"===typeof(s=null!=(s=e[He]||null)?s[r]:null)&&e.removeEventListener(t,s,a),"function"!==typeof n)?r in e?e[r]=n:!0===n?e.setAttribute(r,""):lt(e,r,n):("function"!==typeof s&&null!==s&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,n,a)))}}function hd(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ju("error",e),Ju("load",e);var n,a=!1,s=!1;for(n in r)if(r.hasOwnProperty(n)){var o=r[n];if(null!=o)switch(n){case"src":a=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:ud(e,t,n,o,r,null)}}return s&&ud(e,t,"srcSet",r.srcSet,r,null),void(a&&ud(e,t,"src",r.src,r,null));case"input":Ju("invalid",e);var l=n=o=s=null,c=null,u=null;for(a in r)if(r.hasOwnProperty(a)){var d=r[a];if(null!=d)switch(a){case"name":s=d;break;case"type":o=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":n=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(i(137,t));break;default:ud(e,t,a,d,r,null)}}return void yt(e,n,l,c,u,o,s,!1);case"select":for(s in Ju("invalid",e),a=o=n=null,r)if(r.hasOwnProperty(s)&&null!=(l=r[s]))switch(s){case"value":n=l;break;case"defaultValue":o=l;break;case"multiple":a=l;default:ud(e,t,s,l,r,null)}return t=n,r=o,e.multiple=!!a,void(null!=t?wt(e,!!a,t,!1):null!=r&&wt(e,!!a,r,!0));case"textarea":for(o in Ju("invalid",e),n=s=a=null,r)if(r.hasOwnProperty(o)&&null!=(l=r[o]))switch(o){case"value":a=l;break;case"defaultValue":s=l;break;case"children":n=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(i(91));break;default:ud(e,t,o,l,r,null)}return void _t(e,a,s,n);case"option":for(c in r)if(r.hasOwnProperty(c)&&null!=(a=r[c]))if("selected"===c)e.selected=a&&"function"!==typeof a&&"symbol"!==typeof a;else ud(e,t,c,a,r,null);return;case"dialog":Ju("beforetoggle",e),Ju("toggle",e),Ju("cancel",e),Ju("close",e);break;case"iframe":case"object":Ju("load",e);break;case"video":case"audio":for(a=0;a<Ku.length;a++)Ju(Ku[a],e);break;case"image":Ju("error",e),Ju("load",e);break;case"details":Ju("toggle",e);break;case"embed":case"source":case"link":Ju("error",e),Ju("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in r)if(r.hasOwnProperty(u)&&null!=(a=r[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:ud(e,t,u,a,r,null)}return;default:if(jt(t)){for(d in r)r.hasOwnProperty(d)&&(void 0!==(a=r[d])&&dd(e,t,d,a,r,void 0));return}}for(l in r)r.hasOwnProperty(l)&&(null!=(a=r[l])&&ud(e,t,l,a,r,null))}function fd(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var md=null,pd=null;function gd(e){return 9===e.nodeType?e:e.ownerDocument}function vd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function bd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function yd(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var xd=null;var wd="function"===typeof setTimeout?setTimeout:void 0,Sd="function"===typeof clearTimeout?clearTimeout:void 0,_d="function"===typeof Promise?Promise:void 0,Ed="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof _d?function(e){return _d.resolve(null).then(e).catch(kd)}:wd;function kd(e){setTimeout(function(){throw e})}function Td(e){return"head"===e}function Nd(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&8===a.nodeType)if("/$"===(r=a.data)||"/&"===r){if(0===n)return e.removeChild(a),void Vh(t);n--}else if("$"===r||"$?"===r||"$~"===r||"$!"===r||"&"===r)n++;else if("html"===r)Fd(e.ownerDocument.documentElement);else if("head"===r){Fd(r=e.ownerDocument.head);for(var s=r.firstChild;s;){var i=s.nextSibling,o=s.nodeName;s[$e]||"SCRIPT"===o||"STYLE"===o||"LINK"===o&&"stylesheet"===s.rel.toLowerCase()||r.removeChild(s),s=i}}else"body"===r&&Fd(e.ownerDocument.body);r=a}while(r);Vh(t)}function jd(e,t){var r=e;e=0;do{var n=r.nextSibling;if(1===r.nodeType?t?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",""===r.getAttribute("style")&&r.removeAttribute("style")):3===r.nodeType&&(t?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),n&&8===n.nodeType)if("/$"===(r=n.data)){if(0===e)break;e--}else"$"!==r&&"$?"!==r&&"$~"!==r&&"$!"!==r||e++;r=n}while(r)}function Ad(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Ad(r),Ye(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===r.rel.toLowerCase())continue}e.removeChild(r)}}function Cd(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Rd(e.nextSibling)))return null}return e}function Od(e){return"$?"===e.data||"$~"===e.data}function Pd(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Rd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Id=null;function Dd(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r||"/&"===r){if(0===t)return Rd(e.nextSibling);t--}else"$"!==r&&"$!"!==r&&"$?"!==r&&"$~"!==r&&"&"!==r||t++}e=e.nextSibling}return null}function Ld(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r||"$~"===r||"&"===r){if(0===t)return e;t--}else"/$"!==r&&"/&"!==r||t++}e=e.previousSibling}return null}function Md(e,t,r){switch(t=gd(r),e){case"html":if(!(e=t.documentElement))throw Error(i(452));return e;case"head":if(!(e=t.head))throw Error(i(453));return e;case"body":if(!(e=t.body))throw Error(i(454));return e;default:throw Error(i(451))}}function Fd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ye(e)}var Ud=new Map,zd=new Set;function Bd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Hd=D.d;D.d={f:function(){var e=Hd.f(),t=Zc();return e||t},r:function(e){var t=Xe(e);null!==t&&5===t.tag&&"form"===t.type?ro(t):Hd.r(e)},D:function(e){Hd.D(e),Vd("dns-prefetch",e,null)},C:function(e,t){Hd.C(e,t),Vd("preconnect",e,t)},L:function(e,t,r){Hd.L(e,t,r);var n=Wd;if(n&&e&&t){var a='link[rel="preload"][as="'+vt(t)+'"]';"image"===t&&r&&r.imageSrcSet?(a+='[imagesrcset="'+vt(r.imageSrcSet)+'"]',"string"===typeof r.imageSizes&&(a+='[imagesizes="'+vt(r.imageSizes)+'"]')):a+='[href="'+vt(e)+'"]';var s=a;switch(t){case"style":s=qd(e);break;case"script":s=Yd(e)}Ud.has(s)||(e=f({rel:"preload",href:"image"===t&&r&&r.imageSrcSet?void 0:e,as:t},r),Ud.set(s,e),null!==n.querySelector(a)||"style"===t&&n.querySelector(Kd(s))||"script"===t&&n.querySelector(Jd(s))||(hd(t=n.createElement("link"),"link",e),et(t),n.head.appendChild(t)))}},m:function(e,t){Hd.m(e,t);var r=Wd;if(r&&e){var n=t&&"string"===typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+vt(n)+'"][href="'+vt(e)+'"]',s=a;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Yd(e)}if(!Ud.has(s)&&(e=f({rel:"modulepreload",href:e},t),Ud.set(s,e),null===r.querySelector(a))){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Jd(s)))return}hd(n=r.createElement("link"),"link",e),et(n),r.head.appendChild(n)}}},X:function(e,t){Hd.X(e,t);var r=Wd;if(r&&e){var n=Ze(r).hoistableScripts,a=Yd(e),s=n.get(a);s||((s=r.querySelector(Jd(a)))||(e=f({src:e,async:!0},t),(t=Ud.get(a))&&eh(e,t),et(s=r.createElement("script")),hd(s,"link",e),r.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},n.set(a,s))}},S:function(e,t,r){Hd.S(e,t,r);var n=Wd;if(n&&e){var a=Ze(n).hoistableStyles,s=qd(e);t=t||"default";var i=a.get(s);if(!i){var o={loading:0,preload:null};if(i=n.querySelector(Kd(s)))o.loading=5;else{e=f({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Ud.get(s))&&Zd(e,r);var l=i=n.createElement("link");et(l),hd(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Qd(i,t,n)}i={type:"stylesheet",instance:i,count:1,state:o},a.set(s,i)}}},M:function(e,t){Hd.M(e,t);var r=Wd;if(r&&e){var n=Ze(r).hoistableScripts,a=Yd(e),s=n.get(a);s||((s=r.querySelector(Jd(a)))||(e=f({src:e,async:!0,type:"module"},t),(t=Ud.get(a))&&eh(e,t),et(s=r.createElement("script")),hd(s,"link",e),r.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},n.set(a,s))}}};var Wd="undefined"===typeof document?null:document;function Vd(e,t,r){var n=Wd;if(n&&"string"===typeof t&&t){var a=vt(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"===typeof r&&(a+='[crossorigin="'+r+'"]'),zd.has(a)||(zd.add(a),e={rel:e,crossOrigin:r,href:t},null===n.querySelector(a)&&(hd(t=n.createElement("link"),"link",e),et(t),n.head.appendChild(t)))}}function Gd(e,t,r,n){var a,s,o,l,c=(c=q.current)?Bd(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof r.precedence&&"string"===typeof r.href?(t=qd(r.href),(n=(r=Ze(c).hoistableStyles).get(t))||(n={type:"style",instance:null,count:0,state:null},r.set(t,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===r.rel&&"string"===typeof r.href&&"string"===typeof r.precedence){e=qd(r.href);var u=Ze(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Kd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Ud.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Ud.set(e,r),u||(a=c,s=e,o=r,l=d.state,a.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=a.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),hd(s,"link",o),et(s),a.head.appendChild(s))))),t&&null===n)throw Error(i(528,""));return d}if(t&&null!==n)throw Error(i(529,""));return null;case"script":return t=r.async,"string"===typeof(r=r.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Yd(r),(n=(r=Ze(c).hoistableScripts).get(t))||(n={type:"script",instance:null,count:0,state:null},r.set(t,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function qd(e){return'href="'+vt(e)+'"'}function Kd(e){return'link[rel="stylesheet"]['+e+"]"}function $d(e){return f({},e,{"data-precedence":e.precedence,precedence:null})}function Yd(e){return'[src="'+vt(e)+'"]'}function Jd(e){return"script[async]"+e}function Xd(e,t,r){if(t.count++,null===t.instance)switch(t.type){case"style":var n=e.querySelector('style[data-href~="'+vt(r.href)+'"]');if(n)return t.instance=n,et(n),n;var a=f({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return et(n=(e.ownerDocument||e).createElement("style")),hd(n,"style",a),Qd(n,r.precedence,e),t.instance=n;case"stylesheet":a=qd(r.href);var s=e.querySelector(Kd(a));if(s)return t.state.loading|=4,t.instance=s,et(s),s;n=$d(r),(a=Ud.get(a))&&Zd(n,a),et(s=(e.ownerDocument||e).createElement("link"));var o=s;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),hd(s,"link",n),t.state.loading|=4,Qd(s,r.precedence,e),t.instance=s;case"script":return s=Yd(r.src),(a=e.querySelector(Jd(s)))?(t.instance=a,et(a),a):(n=r,(a=Ud.get(s))&&eh(n=f({},r),a),et(a=(e=e.ownerDocument||e).createElement("script")),hd(a,"link",n),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(i(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(n=t.instance,t.state.loading|=4,Qd(n,r.precedence,e));return t.instance}function Qd(e,t,r){for(var n=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=n.length?n[n.length-1]:null,s=a,i=0;i<n.length;i++){var o=n[i];if(o.dataset.precedence===t)s=o;else if(s!==a)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===r.nodeType?r.head:r).insertBefore(e,t.firstChild)}function Zd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function eh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var th=null;function rh(e,t,r){if(null===th){var n=new Map,a=th=new Map;a.set(r,n)}else(n=(a=th).get(r))||(n=new Map,a.set(r,n));if(n.has(e))return n;for(n.set(e,null),r=r.getElementsByTagName(e),a=0;a<r.length;a++){var s=r[a];if(!(s[$e]||s[Be]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var i=s.getAttribute(t)||"";i=e+i;var o=n.get(i);o?o.push(s):n.set(i,[s])}}return n}function nh(e,t,r){(e=e.ownerDocument||e).head.insertBefore(r,"title"===t?e.querySelector("head > title"):null)}function ah(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var sh=0;function ih(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)lh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var oh=null;function lh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,oh=new Map,t.forEach(ch,e),oh=null,ih.call(e))}function ch(e,t){if(!(4&t.state.loading)){var r=oh.get(e);if(r)var n=r.get(null);else{r=new Map,oh.set(e,r);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<a.length;s++){var i=a[s];"LINK"!==i.nodeName&&"not all"===i.getAttribute("media")||(r.set(i.dataset.precedence,i),n=i)}n&&r.set(null,n)}i=(a=t.instance).getAttribute("data-precedence"),(s=r.get(i)||n)===n&&r.set(null,a),r.set(i,a),this.count++,n=ih.bind(this),a.addEventListener("load",n),a.addEventListener("error",n),s?s.parentNode.insertBefore(a,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var uh={$$typeof:w,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function dh(e,t,r,n,a,s,i,o,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Oe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oe(0),this.hiddenUpdates=Oe(null),this.identifierPrefix=n,this.onUncaughtError=a,this.onCaughtError=s,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function hh(e,t,r,n,a,s,i,o,l,c,u,d){return e=new dh(e,t,r,i,l,c,u,d,o),t=1,!0===s&&(t|=24),s=Fn(3,null,null,t),e.current=s,s.stateNode=e,(t=Ua()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:n,isDehydrated:r,cache:t},gs(s),e}function fh(e){return e?e=Ln:Ln}function mh(e,t,r,n,a,s){a=fh(a),null===n.context?n.context=a:n.pendingContext=a,(n=bs(t)).payload={element:r},null!==(s=void 0===s?null:s)&&(n.callback=s),null!==(r=ys(e,n,t))&&($c(r,0,t),xs(r,e,t))}function ph(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function gh(e,t){ph(e,t),(e=e.alternate)&&ph(e,t)}function vh(e){if(13===e.tag||31===e.tag){var t=Rn(e,67108864);null!==t&&$c(t,0,67108864),gh(e,67108864)}}function bh(e){if(13===e.tag||31===e.tag){var t=qc(),r=Rn(e,t=Le(t));null!==r&&$c(r,0,t),gh(e,t)}}var yh=!0;function xh(e,t,r,n){var a=I.T;I.T=null;var s=D.p;try{D.p=2,Sh(e,t,r,n)}finally{D.p=s,I.T=a}}function wh(e,t,r,n){var a=I.T;I.T=null;var s=D.p;try{D.p=8,Sh(e,t,r,n)}finally{D.p=s,I.T=a}}function Sh(e,t,r,n){if(yh){var a=_h(n);if(null===a)td(e,t,n,Eh,r),Dh(e,n);else if(function(e,t,r,n,a){switch(t){case"focusin":return jh=Lh(jh,e,t,r,n,a),!0;case"dragenter":return Ah=Lh(Ah,e,t,r,n,a),!0;case"mouseover":return Ch=Lh(Ch,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Oh.set(s,Lh(Oh.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Ph.set(s,Lh(Ph.get(s)||null,e,t,r,n,a)),!0}return!1}(a,e,t,r,n))n.stopPropagation();else if(Dh(e,n),4&t&&-1<Ih.indexOf(e)){for(;null!==a;){var s=Xe(a);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var i=Te(s.pendingLanes);if(0!==i){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;i;){var l=1<<31-xe(i);o.entanglements[1]|=l,i&=~l}Du(s),0===(6&fc)&&(Ic=le()+500,Lu(0,!1))}}break;case 31:case 13:null!==(o=Rn(s,2))&&$c(o,0,2),Zc(),gh(s,2)}if(null===(s=_h(n))&&td(e,t,n,Eh,r),s===a)break;a=s}null!==a&&n.stopPropagation()}else td(e,t,n,null,r)}}function _h(e){return kh(e=It(e))}var Eh=null;function kh(e){if(Eh=null,null!==(e=Je(e))){var t=l(e);if(null===t)e=null;else{var r=t.tag;if(13===r){if(null!==(e=c(t)))return e;e=null}else if(31===r){if(null!==(e=u(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Eh=e,null}function Th(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case de:return 8;case he:case fe:return 32;case me:return 268435456;default:return 32}default:return 32}}var Nh=!1,jh=null,Ah=null,Ch=null,Oh=new Map,Ph=new Map,Rh=[],Ih="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dh(e,t){switch(e){case"focusin":case"focusout":jh=null;break;case"dragenter":case"dragleave":Ah=null;break;case"mouseover":case"mouseout":Ch=null;break;case"pointerover":case"pointerout":Oh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ph.delete(t.pointerId)}}function Lh(e,t,r,n,a,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},null!==t&&(null!==(t=Xe(t))&&vh(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Mh(e){var t=Je(e.target);if(null!==t){var r=l(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=c(r)))return e.blockedOn=t,void Ue(e.priority,function(){bh(r)})}else if(31===t){if(null!==(t=u(r)))return e.blockedOn=t,void Ue(e.priority,function(){bh(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Fh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=_h(e.nativeEvent);if(null!==r)return null!==(t=Xe(r))&&vh(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);Rt=n,r.target.dispatchEvent(n),Rt=null,t.shift()}return!0}function Uh(e,t,r){Fh(e)&&r.delete(t)}function zh(){Nh=!1,null!==jh&&Fh(jh)&&(jh=null),null!==Ah&&Fh(Ah)&&(Ah=null),null!==Ch&&Fh(Ch)&&(Ch=null),Oh.forEach(Uh),Ph.forEach(Uh)}function Bh(e,t){e.blockedOn===t&&(e.blockedOn=null,Nh||(Nh=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,zh)))}var Hh=null;function Wh(e){Hh!==e&&(Hh=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Hh===e&&(Hh=null);for(var t=0;t<e.length;t+=3){var r=e[t],n=e[t+1],a=e[t+2];if("function"!==typeof n){if(null===kh(n||r))continue;break}var s=Xe(r);null!==s&&(e.splice(t,3),t-=3,eo(s,{pending:!0,data:a,method:r.method,action:n},n,a))}}))}function Vh(e){function t(t){return Bh(t,e)}null!==jh&&Bh(jh,e),null!==Ah&&Bh(Ah,e),null!==Ch&&Bh(Ch,e),Oh.forEach(t),Ph.forEach(t);for(var r=0;r<Rh.length;r++){var n=Rh[r];n.blockedOn===e&&(n.blockedOn=null)}for(;0<Rh.length&&null===(r=Rh[0]).blockedOn;)Mh(r),null===r.blockedOn&&Rh.shift();if(null!=(r=(e.ownerDocument||e).$$reactFormReplay))for(n=0;n<r.length;n+=3){var a=r[n],s=r[n+1],i=a[He]||null;if("function"===typeof s)i||Wh(r);else if(i){var o=null;if(s&&s.hasAttribute("formAction")){if(a=s,i=s[He]||null)o=i.formAction;else if(null!==kh(a))continue}else o=i.action;"function"===typeof o?r[n+1]=o:(r.splice(n,3),n-=3),Wh(r)}}}function Gh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return a=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==a&&(a(),a=null),n||setTimeout(r,20)}function r(){if(!n&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var n=!1,a=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(r,100),function(){n=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==a&&(a(),a=null)}}}function qh(e){this._internalRoot=e}function Kh(e){this._internalRoot=e}Kh.prototype.render=qh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));mh(t.current,qc(),e,t,null,null)},Kh.prototype.unmount=qh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;mh(e.current,2,null,e,null,null),Zc(),t[We]=null}},Kh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fe();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Rh.length&&0!==t&&t<Rh[r].priority;r++);Rh.splice(r,0,e),0===r&&Mh(e)}};var $h=a.version;if("19.2.0"!==$h)throw Error(i(527,$h,"19.2.0"));D.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(i(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(n=a.return)){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return d(a),e;if(s===n)return d(a),t;s=s.sibling}throw Error(i(188))}if(r.return!==n.return)r=a,n=s;else{for(var o=!1,c=a.child;c;){if(c===r){o=!0,r=a,n=s;break}if(c===n){o=!0,n=a,r=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===r){o=!0,r=s,n=a;break}if(c===n){o=!0,n=s,r=a;break}c=c.sibling}if(!o)throw Error(i(189))}}if(r.alternate!==n)throw Error(i(190))}if(3!==r.tag)throw Error(i(188));return r.stateNode.current===r?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var Yh={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:I,reconcilerVersion:"19.2.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Jh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jh.isDisabled&&Jh.supportsFiber)try{ve=Jh.inject(Yh),be=Jh}catch(Qh){}}t.createRoot=function(e,t){if(!o(e))throw Error(i(299));var r=!1,n="",a=Eo,s=ko,l=To;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onUncaughtError&&(a=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=hh(e,1,!1,null,0,r,n,null,a,s,l,Gh),e[We]=t.current,Zu(e),new qh(t)},t.hydrateRoot=function(e,t,r){if(!o(e))throw Error(i(299));var n=!1,a="",s=Eo,l=ko,c=To,u=null;return null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(n=!0),void 0!==r.identifierPrefix&&(a=r.identifierPrefix),void 0!==r.onUncaughtError&&(s=r.onUncaughtError),void 0!==r.onCaughtError&&(l=r.onCaughtError),void 0!==r.onRecoverableError&&(c=r.onRecoverableError),void 0!==r.formState&&(u=r.formState)),(t=hh(e,1,!0,t,0,n,a,u,s,l,c,Gh)).context=fh(null),r=t.current,(a=bs(n=Le(n=qc()))).callback=null,ys(r,a,n),r=n,t.current.lanes=r,Pe(t,r),Du(t),e[We]=t.current,Zu(e),new Kh(t)},t.version="19.2.0"},43:(e,t,r)=>{e.exports=r(288)},210:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(326),a=n.__importDefault(r(829)),s=n.__importDefault(r(736));class i{constructor(e){let{headers:t={},schema:r,fetch:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=n}from(e){const t=new URL("".concat(this.url,"/").concat(e));return new a.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new i(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:r=!1,get:n=!1,count:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;let o;const l=new URL("".concat(this.url,"/rpc/").concat(e));let c;r||n?(o=r?"HEAD":"GET",Object.entries(t).filter(e=>{let[t,r]=e;return void 0!==r}).map(e=>{let[t,r]=e;return[t,Array.isArray(r)?"{".concat(r.join(","),"}"):"".concat(r)]}).forEach(e=>{let[t,r]=e;l.searchParams.append(t,r)})):(o="POST",c=t);const u=new Headers(this.headers);return a&&u.set("Prefer","count=".concat(a)),new s.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}}t.default=i},286:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(326),a=n.__importDefault(r(630)),s=n.__importDefault(r(611));t.default=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(r=e.isMaybeSingle)&&void 0!==r&&r,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=a.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,n,a;let i=null,o=null,l=null,c=e.status,u=e.statusText;if(e.ok){if("HEAD"!==this.method){const r=await e.text();""===r||(o="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null===(t=this.headers.get("Accept"))||void 0===t?void 0:t.includes("application/vnd.pgrst.plan+text"))?r:JSON.parse(r))}const a=null===(r=this.headers.get("Prefer"))||void 0===r?void 0:r.match(/count=(exact|planned|estimated)/),s=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");a&&s&&s.length>1&&(l=parseInt(s[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(o)&&(o.length>1?(i={code:"PGRST116",details:"Results contain ".concat(o.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,c=406,u="Not Acceptable"):o=1===o.length?o[0]:null)}else{const t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(o=[],i=null,c=200,u="OK")}catch(d){404===e.status&&""===t?(c=204,u="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(a=null===i||void 0===i?void 0:i.details)||void 0===a?void 0:a.includes("0 rows"))&&(i=null,c=200,u="OK"),i&&this.shouldThrowOnError)throw new s.default(i)}return{error:i,data:o,count:l,status:c,statusText:u}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,n;return{error:{message:"".concat(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),details:"".concat(null!==(r=null===e||void 0===e?void 0:e.stack)&&void 0!==r?r:""),hint:"",code:"".concat(null!==(n=null===e||void 0===e?void 0:e.code)&&void 0!==n?n:"")},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}}},288:(e,t)=>{var r=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),m=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function b(e,t,r){this.props=e,this.context=t,this.refs=v,this.updater=r||p}function y(){}function x(e,t,r){this.props=e,this.context=t,this.refs=v,this.updater=r||p}b.prototype.isReactComponent={},b.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},b.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=b.prototype;var w=x.prototype=new y;w.constructor=x,g(w,b.prototype),w.isPureReactComponent=!0;var S=Array.isArray;function _(){}var E={H:null,A:null,T:null,S:null},k=Object.prototype.hasOwnProperty;function T(e,t,n){var a=n.ref;return{$$typeof:r,type:e,key:t,ref:void 0!==a?a:null,props:n}}function N(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var j=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function C(e,t,a,s,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(o){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case r:case n:u=!0;break;case h:return C((u=e._init)(e._payload),t,a,s,i)}}if(u)return i=i(e),u=""===s?"."+A(e,0):s,S(i)?(a="",null!=u&&(a=u.replace(j,"$&/")+"/"),C(i,t,a,"",function(e){return e})):null!=i&&(N(i)&&(l=i,c=a+(null==i.key||e&&e.key===i.key?"":(""+i.key).replace(j,"$&/")+"/")+u,i=T(l.type,c,l.props)),t.push(i)),1;u=0;var d,f=""===s?".":s+":";if(S(e))for(var p=0;p<e.length;p++)u+=C(s=e[p],t,a,o=f+A(s,p),i);else if("function"===typeof(p=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=m&&d[m]||d["@@iterator"])?d:null))for(e=p.call(e),p=0;!(s=e.next()).done;)u+=C(s=s.value,t,a,o=f+A(s,p++),i);else if("object"===o){if("function"===typeof e.then)return C(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(_,_):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,a,s,i);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function O(e,t,r){if(null==e)return e;var n=[],a=0;return C(e,n,"","",function(e){return t.call(r,e,a++)}),n}function P(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},I={map:O,forEach:function(e,t,r){O(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return O(e,function(){t++}),t},toArray:function(e){return O(e,function(e){return e})||[]},only:function(e){if(!N(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=f,t.Children=I,t.Component=b,t.Fragment=a,t.Profiler=i,t.PureComponent=x,t.StrictMode=s,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return E.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var n=g({},e.props),a=e.key;if(null!=t)for(s in void 0!==t.key&&(a=""+t.key),t)!k.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(n[s]=t[s]);var s=arguments.length-2;if(1===s)n.children=r;else if(1<s){for(var i=Array(s),o=0;o<s;o++)i[o]=arguments[o+2];n.children=i}return T(e.type,a,n)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,r){var n,a={},s=null;if(null!=t)for(n in void 0!==t.key&&(s=""+t.key),t)k.call(t,n)&&"key"!==n&&"__self"!==n&&"__source"!==n&&(a[n]=t[n]);var i=arguments.length-2;if(1===i)a.children=r;else if(1<i){for(var o=Array(i),l=0;l<i;l++)o[l]=arguments[l+2];a.children=o}if(e&&e.defaultProps)for(n in i=e.defaultProps)void 0===a[n]&&(a[n]=i[n]);return T(e,s,a)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=N,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=E.T,r={};E.T=r;try{var n=e(),a=E.S;null!==a&&a(r,n),"object"===typeof n&&null!==n&&"function"===typeof n.then&&n.then(_,R)}catch(s){R(s)}finally{null!==t&&null!==r.types&&(t.types=r.types),E.T=t}},t.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},t.use=function(e){return E.H.use(e)},t.useActionState=function(e,t,r){return E.H.useActionState(e,t,r)},t.useCallback=function(e,t){return E.H.useCallback(e,t)},t.useContext=function(e){return E.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return E.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return E.H.useEffect(e,t)},t.useEffectEvent=function(e){return E.H.useEffectEvent(e)},t.useId=function(){return E.H.useId()},t.useImperativeHandle=function(e,t,r){return E.H.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return E.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return E.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return E.H.useMemo(e,t)},t.useOptimistic=function(e,t){return E.H.useOptimistic(e,t)},t.useReducer=function(e,t,r){return E.H.useReducer(e,t,r)},t.useRef=function(e){return E.H.useRef(e)},t.useState=function(e){return E.H.useState(e)},t.useSyncExternalStore=function(e,t,r){return E.H.useSyncExternalStore(e,t,r)},t.useTransition=function(){return E.H.useTransition()},t.version="19.2.0"},326:(e,t,r)=>{r.r(t),r.d(t,{__addDisposableResource:()=>D,__assign:()=>s,__asyncDelegator:()=>k,__asyncGenerator:()=>E,__asyncValues:()=>T,__await:()=>_,__awaiter:()=>m,__classPrivateFieldGet:()=>P,__classPrivateFieldIn:()=>I,__classPrivateFieldSet:()=>R,__createBinding:()=>g,__decorate:()=>o,__disposeResources:()=>M,__esDecorate:()=>c,__exportStar:()=>v,__extends:()=>a,__generator:()=>p,__importDefault:()=>O,__importStar:()=>C,__makeTemplateObject:()=>N,__metadata:()=>f,__param:()=>l,__propKey:()=>d,__read:()=>y,__rest:()=>i,__rewriteRelativeImportExtension:()=>F,__runInitializers:()=>u,__setFunctionName:()=>h,__spread:()=>x,__spreadArray:()=>S,__spreadArrays:()=>w,__values:()=>b,default:()=>U});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},s.apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function o(e,t,r,n){var a,s=arguments.length,i=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(i=(s<3?a(i):s>3?a(t,r,i):a(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i}function l(e,t){return function(r,n){t(r,n,e)}}function c(e,t,r,n,a,s){function i(e){if(void 0!==e&&"function"!==typeof e)throw new TypeError("Function expected");return e}for(var o,l=n.kind,c="getter"===l?"get":"setter"===l?"set":"value",u=!t&&e?n.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),h=!1,f=r.length-1;f>=0;f--){var m={};for(var p in n)m[p]="access"===p?{}:n[p];for(var p in n.access)m.access[p]=n.access[p];m.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(i(e||null))};var g=(0,r[f])("accessor"===l?{get:d.get,set:d.set}:d[c],m);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!==typeof g)throw new TypeError("Object expected");(o=i(g.get))&&(d.get=o),(o=i(g.set))&&(d.set=o),(o=i(g.init))&&a.unshift(o)}else(o=i(g))&&("field"===l?a.unshift(o):d[c]=o)}u&&Object.defineProperty(u,n.name,d),h=!0}function u(e,t,r){for(var n=arguments.length>2,a=0;a<t.length;a++)r=n?t[a].call(e,r):t[a].call(e);return n?r:void 0}function d(e){return"symbol"===typeof e?e:"".concat(e)}function h(e,t,r){return"symbol"===typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function f(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)}function m(e,t,r,n){return new(r||(r=Promise))(function(a,s){function i(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((n=n.apply(e,t||[])).next())})}function p(e,t){var r,n,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"===typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(l){o=[6,l],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}var g=Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function v(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function b(e){var t="function"===typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,s=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)i.push(n.value)}catch(o){a={error:o}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(a)throw a.error}}return i}function x(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var s=arguments[t],i=0,o=s.length;i<o;i++,a++)n[a]=s[i];return n}function S(e,t,r){if(r||2===arguments.length)for(var n,a=0,s=t.length;a<s;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}function _(e){return this instanceof _?(this.v=e,this):new _(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,a=r.apply(e,t||[]),s=[];return n=Object.create(("function"===typeof AsyncIterator?AsyncIterator:Object).prototype),i("next"),i("throw"),i("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),n[Symbol.asyncIterator]=function(){return this},n;function i(e,t){a[e]&&(n[e]=function(t){return new Promise(function(r,n){s.push([e,t,r,n])>1||o(e,t)})},t&&(n[e]=t(n[e])))}function o(e,t){try{(r=a[e](t)).value instanceof _?Promise.resolve(r.value.v).then(l,c):u(s[0][2],r)}catch(n){u(s[0][3],n)}var r}function l(e){o("next",e)}function c(e){o("throw",e)}function u(e,t){e(t),s.shift(),s.length&&o(s[0][0],s[0][1])}}function k(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,a){t[n]=e[n]?function(t){return(r=!r)?{value:_(e[n](t)),done:!1}:a?a(t):t}:a}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,a){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,a,(t=e[r](t)).done,t.value)})}}}function N(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var j=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},A=function(e){return A=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},A(e)};function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=A(e),n=0;n<r.length;n++)"default"!==r[n]&&g(t,e,r[n]);return j(t,e),t}function O(e){return e&&e.__esModule?e:{default:e}}function P(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function R(e,t,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,r):a?a.value=r:t.set(e,r),r}function I(e,t){if(null===t||"object"!==typeof t&&"function"!==typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"===typeof e?t===e:e.has(t)}function D(e,t,r){if(null!==t&&void 0!==t){if("object"!==typeof t&&"function"!==typeof t)throw new TypeError("Object expected.");var n,a;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(a=n)}if("function"!==typeof n)throw new TypeError("Object not disposable.");a&&(n=function(){try{a.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var L="function"===typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function M(e){function t(t){e.error=e.hasError?new L(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,n=0;return function a(){for(;r=e.stack.pop();)try{if(!r.async&&1===n)return n=0,e.stack.push(r),Promise.resolve().then(a);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(s).then(a,function(e){return t(e),a()})}else n|=1}catch(i){t(i)}if(1===n)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function F(e,t){return"string"===typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,r,n,a,s){return r?t?".jsx":".js":!n||a&&s?n+a+"."+s.toLowerCase()+"js":e}):e}const U={__extends:a,__assign:s,__rest:i,__decorate:o,__param:l,__esDecorate:c,__runInitializers:u,__propKey:d,__setFunctionName:h,__metadata:f,__awaiter:m,__generator:p,__createBinding:g,__exportStar:v,__values:b,__read:y,__spread:x,__spreadArrays:w,__spreadArray:S,__await:_,__asyncGenerator:E,__asyncDelegator:k,__asyncValues:T,__makeTemplateObject:N,__importStar:C,__importDefault:O,__classPrivateFieldGet:P,__classPrivateFieldSet:R,__classPrivateFieldIn:I,__addDisposableResource:D,__disposeResources:M,__rewriteRelativeImportExtension:F}},374:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(326).__importDefault(r(286));class a extends n.default{select(e){let t=!1;const r=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e){let{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:a=n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=a?"".concat(a,".order"):"order",i=this.url.searchParams.get(s);return this.url.searchParams.set(s,"".concat(i?"".concat(i,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===r?"":r?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t,referencedTable:r=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n="undefined"===typeof r?"limit":"".concat(r,".limit");return this.url.searchParams.set(n,"".concat(e)),this}range(e,t){let{foreignTable:r,referencedTable:n=r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a="undefined"===typeof n?"offset":"".concat(n,".offset"),s="undefined"===typeof n?"limit":"".concat(n,".limit");return this.url.searchParams.set(a,"".concat(e)),this.url.searchParams.set(s,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain(){let{analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:a=!1,format:s="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var i;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=null!==(i=this.headers.get("Accept"))&&void 0!==i?i:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(s,'; for="').concat(l,'"; options=').concat(o,";")),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(e)),this}}t.default=a},391:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(4)},579:(e,t,r)=>{e.exports=r(799)},611:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=r},630:(e,t,r)=>{r.r(t),r.d(t,{Headers:()=>i,Request:()=>o,Response:()=>l,default:()=>s,fetch:()=>a});var n=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("unable to locate global object")}();const a=n.fetch,s=n.fetch.bind(n),i=n.Headers,o=n.Request,l=n.Response},672:(e,t,r)=>{var n=r(43);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(a(299));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.flushSync=function(e){var t=l.T,r=i.p;try{if(l.T=null,i.p=2,e)return e()}finally{l.T=t,i.p=r,i.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,i.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&i.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var r=t.as,n=c(r,t.crossOrigin),a="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===r?i.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:n,integrity:a,fetchPriority:s}):"script"===r&&i.d.X(e,{crossOrigin:n,integrity:a,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var r=c(t.as,t.crossOrigin);i.d.M(e,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&i.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var r=t.as,n=c(r,t.crossOrigin);i.d.L(e,r,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var r=c(t.as,t.crossOrigin);i.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else i.d.m(e)},t.requestFormReset=function(e){i.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,r){return l.H.useFormState(e,t,r)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.0"},736:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(326).__importDefault(r(374));class a extends n.default{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}in(e,t){const r=Array.from(new Set(t)).map(e=>"string"===typeof e&&new RegExp("[,()]").test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"in.(".concat(r,")")),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:r,type:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="";"plain"===n?a="pl":"phrase"===n?a="ph":"websearch"===n&&(a="w");const s=void 0===r?"":"(".concat(r,")");return this.url.searchParams.append(e,"".concat(a,"fts").concat(s,".").concat(t)),this}match(e){return Object.entries(e).forEach(e=>{let[t,r]=e;this.url.searchParams.append(t,"eq.".concat(r))}),this}not(e,t,r){return this.url.searchParams.append(e,"not.".concat(t,".").concat(r)),this}or(e){let{foreignTable:t,referencedTable:r=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=r?"".concat(r,".or"):"or";return this.url.searchParams.append(n,"(".concat(e,")")),this}filter(e,t,r){return this.url.searchParams.append(e,"".concat(t,".").concat(r)),this}}t.default=a},799:(e,t)=>{var r=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(e,t,n){var a=null;if(void 0!==n&&(a=""+n),void 0!==t.key&&(a=""+t.key),"key"in t)for(var s in n={},t)"key"!==s&&(n[s]=t[s]);else n=t;return t=n.ref,{$$typeof:r,type:e,key:a,ref:void 0!==t?t:null,props:n}}t.Fragment=n,t.jsx=a,t.jsxs=a},829:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(326).__importDefault(r(736));t.default=class{constructor(e,t){let{headers:r={},schema:n,fetch:a}=t;this.url=e,this.headers=new Headers(r),this.schema=n,this.fetch=a}select(e,t){const{head:r=!1,count:a}=null!==t&&void 0!==t?t:{},s=r?"HEAD":"GET";let i=!1;const o=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!i?"":('"'===e&&(i=!i),e)).join("");return this.url.searchParams.set("select",o),a&&this.headers.append("Prefer","count=".concat(a)),new n.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e){let{count:t,defaultToNull:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var a;if(t&&this.headers.append("Prefer","count=".concat(t)),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new n.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(a=this.fetch)&&void 0!==a?a:fetch})}upsert(e){let{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i;if(this.headers.append("Prefer","resolution=".concat(r?"ignore":"merge","-duplicates")),void 0!==t&&this.url.searchParams.set("on_conflict",t),a&&this.headers.append("Prefer","count=".concat(a)),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new n.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;return t&&this.headers.append("Prefer","count=".concat(t)),new n.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;return e&&this.headers.append("Prefer","count=".concat(e)),new n.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}}},853:(e,t,r)=>{e.exports=r(896)},896:(e,t)=>{function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,a=e[n];if(!(0<s(a,t)))break e;e[n]=t,e[r]=a,r=n}}function n(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,a=e.length,i=a>>>1;n<i;){var o=2*(n+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,r))c<a&&0>s(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[o]=r,n=o);else{if(!(c<a&&0>s(u,r)))break e;e[n]=u,e[c]=r,n=c}}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,p=!1,g=!1,v=!1,b="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=n(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,r(c,t)}t=n(u)}}function S(e){if(g=!1,w(e),!p)if(null!==n(c))p=!0,E||(E=!0,_());else{var t=n(u);null!==t&&P(S,t.startTime-e)}}var _,E=!1,k=-1,T=5,N=-1;function j(){return!!v||!(t.unstable_now()-N<T)}function A(){if(v=!1,E){var e=t.unstable_now();N=e;var r=!0;try{e:{p=!1,g&&(g=!1,y(k),k=-1),m=!0;var s=f;try{t:{for(w(e),h=n(c);null!==h&&!(h.expirationTime>e&&j());){var i=h.callback;if("function"===typeof i){h.callback=null,f=h.priorityLevel;var o=i(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){h.callback=o,w(e),r=!0;break t}h===n(c)&&a(c),w(e)}else a(c);h=n(c)}if(null!==h)r=!0;else{var l=n(u);null!==l&&P(S,l.startTime-e),r=!1}}break e}finally{h=null,f=s,m=!1}r=void 0}}finally{r?_():E=!1}}}if("function"===typeof x)_=function(){x(A)};else if("undefined"!==typeof MessageChannel){var C=new MessageChannel,O=C.port2;C.port1.onmessage=A,_=function(){O.postMessage(null)}}else _=function(){b(A,0)};function P(e,r){k=b(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,a,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(e.sortIndex=s,r(u,e),null===n(c)&&e===n(u)&&(g?(y(k),k=-1):g=!0,P(S,s-i))):(e.sortIndex=o,r(c,e),p||m||(p=!0,E||(E=!0,_()))),e},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},950:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(672)},980:(e,t,r)=>{t.kf=t.le=t.ZS=t.pT=t.lc=t.tE=void 0;const n=r(326),a=n.__importDefault(r(210));t.tE=a.default;const s=n.__importDefault(r(829));t.lc=s.default;const i=n.__importDefault(r(736));t.pT=i.default;const o=n.__importDefault(r(374));t.ZS=o.default;const l=n.__importDefault(r(286));t.le=l.default;const c=n.__importDefault(r(611));t.kf=c.default,a.default,s.default,i.default,o.default,l.default,c.default}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n=r(43),a=r(391);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function i(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}function o(e,t,r){return(t=i(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const d=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},h=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>Boolean(e)&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var f={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const m=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],p=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:l,iconNode:d}=e,p=u(e,m);return(0,n.createElement)("svg",c(c(c({ref:t},f),{},{width:a,height:a,stroke:r,strokeWidth:i?24*Number(s)/Number(a):s,className:h("lucide",o)},!l&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(p)&&{"aria-hidden":"true"}),p),[...d.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(l)?l:[l]])}),g=["className"],v=(e,t)=>{const r=(0,n.forwardRef)((r,a)=>{let{className:s}=r,i=u(r,g);return(0,n.createElement)(p,c({ref:a,iconNode:t,className:h("lucide-".concat((o=d(e),o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(e),s)},i));var o});return r.displayName=d(e),r},b=v("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),y=v("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),x=v("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),w=v("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),S=v("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),_=v("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var E=r(579);const k=e=>{let{icon:t,title:r,description:n}=e;return(0,E.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-md hover:shadow-xl transition transform hover:-translate-y-2",children:[(0,E.jsx)("div",{className:"mb-4",children:t}),(0,E.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:r}),(0,E.jsx)("p",{className:"text-gray-600",children:n})]})},T=e=>{let{onNavigate:t}=e;return(0,E.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[(0,E.jsx)("header",{className:"bg-white shadow-sm sticky top-0 z-50",children:(0,E.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)(b,{className:"w-8 h-8 text-indigo-600"}),(0,E.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:"EduPortal"})]}),(0,E.jsxs)("nav",{className:"hidden md:flex space-x-8",children:[(0,E.jsx)("a",{href:"#features",className:"text-gray-600 hover:text-indigo-600 transition",children:"Features"}),(0,E.jsx)("a",{href:"#about",className:"text-gray-600 hover:text-indigo-600 transition",children:"About"}),(0,E.jsx)("a",{href:"#contact",className:"text-gray-600 hover:text-indigo-600 transition",children:"Contact"})]})]})})}),(0,E.jsx)("section",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:(0,E.jsxs)("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsx)("h1",{className:"text-5xl font-bold text-gray-900 leading-tight",children:"Transform Your Learning Experience"}),(0,E.jsx)("p",{className:"text-xl text-gray-600",children:"Access comprehensive exam management and course materials all in one powerful platform designed for modern education."}),(0,E.jsxs)("button",{onClick:()=>t("portal-selector"),className:"bg-indigo-600 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-indigo-700 transition flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[(0,E.jsx)("span",{children:"Explore Portals"}),(0,E.jsx)(y,{className:"w-5 h-5"})]})]}),(0,E.jsxs)("div",{className:"relative",children:[(0,E.jsx)("img",{src:"https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=800&h=600&fit=crop",alt:"Students learning",className:"rounded-2xl shadow-2xl"}),(0,E.jsx)("div",{className:"absolute -bottom-6 -left-6 bg-white p-4 rounded-xl shadow-lg",children:(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsx)(x,{className:"w-8 h-8 text-green-500"}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"font-semibold text-gray-900",children:"10,000+"}),(0,E.jsx)("p",{className:"text-sm text-gray-600",children:"Active Students"})]})]})})]})]})}),(0,E.jsxs)("section",{id:"features",className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:[(0,E.jsx)("h2",{className:"text-4xl font-bold text-center text-gray-900 mb-12",children:"Powerful Features"}),(0,E.jsxs)("div",{className:"grid md:grid-cols-3 gap-8",children:[(0,E.jsx)(k,{icon:(0,E.jsx)(w,{className:"w-10 h-10 text-indigo-600"}),title:"Exam Management",description:"Comprehensive online examination system with instant results and detailed analytics."}),(0,E.jsx)(k,{icon:(0,E.jsx)(S,{className:"w-10 h-10 text-indigo-600"}),title:"Course Materials",description:"Access all your learning materials, videos, and resources in one place."}),(0,E.jsx)(k,{icon:(0,E.jsx)(_,{className:"w-10 h-10 text-indigo-600"}),title:"Attendance Tracking",description:"Automated attendance management with detailed reports and notifications."})]})]})]})},N=e=>{let{onNavigate:t}=e;return(0,E.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-100 via-purple-50 to-pink-100",children:[(0,E.jsx)("header",{className:"bg-white shadow-sm",children:(0,E.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)(b,{className:"w-8 h-8 text-indigo-600"}),(0,E.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:"EduPortal"})]}),(0,E.jsx)("button",{onClick:()=>t("home"),className:"text-gray-600 hover:text-indigo-600 transition",children:"\u2190 Back to Home"})]})}),(0,E.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:[(0,E.jsxs)("div",{className:"text-center mb-16",children:[(0,E.jsx)("h1",{className:"text-5xl font-bold text-gray-900 mb-4",children:"Choose Your Portal"}),(0,E.jsx)("p",{className:"text-xl text-gray-600",children:"Select the portal that matches your needs"})]}),(0,E.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,E.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden transform transition hover:scale-105 hover:shadow-2xl",children:[(0,E.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 p-8 text-white",children:[(0,E.jsx)(w,{className:"w-16 h-16 mb-4"}),(0,E.jsx)("h2",{className:"text-3xl font-bold mb-2",children:"Exam Portal"}),(0,E.jsx)("p",{className:"text-blue-100",children:"Take exams, view results, and track attendance"})]}),(0,E.jsxs)("div",{className:"p-8",children:[(0,E.jsxs)("ul",{className:"space-y-4 mb-8",children:[(0,E.jsxs)("li",{className:"flex items-start space-x-3",children:[(0,E.jsx)(x,{className:"w-6 h-6 text-green-500 mt-0.5"}),(0,E.jsx)("span",{className:"text-gray-700",children:"Online examination system"})]}),(0,E.jsxs)("li",{className:"flex items-start space-x-3",children:[(0,E.jsx)(x,{className:"w-6 h-6 text-green-500 mt-0.5"}),(0,E.jsx)("span",{className:"text-gray-700",children:"Instant result generation"})]}),(0,E.jsxs)("li",{className:"flex items-start space-x-3",children:[(0,E.jsx)(x,{className:"w-6 h-6 text-green-500 mt-0.5"}),(0,E.jsx)("span",{className:"text-gray-700",children:"Attendance management"})]}),(0,E.jsxs)("li",{className:"flex items-start space-x-3",children:[(0,E.jsx)(x,{className:"w-6 h-6 text-green-500 mt-0.5"}),(0,E.jsx)("span",{className:"text-gray-700",children:"Performance analytics"})]})]}),(0,E.jsxs)("button",{onClick:()=>t("exam-login"),className:"w-full bg-indigo-600 text-white py-4 rounded-lg font-semibold hover:bg-indigo-700 transition flex items-center justify-center space-x-2",children:[(0,E.jsx)("span",{children:"Access Exam Portal"}),(0,E.jsx)(y,{className:"w-5 h-5"})]})]})]}),(0,E.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden transform transition hover:scale-105 hover:shadow-2xl",children:[(0,E.jsxs)("div",{className:"bg-gradient-to-br from-purple-500 to-pink-600 p-8 text-white",children:[(0,E.jsx)(S,{className:"w-16 h-16 mb-4"}),(0,E.jsx)("h2",{className:"text-3xl font-bold mb-2",children:"Course Portal"}),(0,E.jsx)("p",{className:"text-purple-100",children:"Enroll in courses and access learning materials"})]}),(0,E.jsxs)("div",{className:"p-8",children:[(0,E.jsxs)("ul",{className:"space-y-4 mb-8",children:[(0,E.jsxs)("li",{className:"flex items-start space-x-3",children:[(0,E.jsx)(x,{className:"w-6 h-6 text-green-500 mt-0.5"}),(0,E.jsx)("span",{className:"text-gray-700",children:"Browse available courses"})]}),(0,E.jsxs)("li",{className:"flex items-start space-x-3",children:[(0,E.jsx)(x,{className:"w-6 h-6 text-green-500 mt-0.5"}),(0,E.jsx)("span",{className:"text-gray-700",children:"Access study materials"})]}),(0,E.jsxs)("li",{className:"flex items-start space-x-3",children:[(0,E.jsx)(x,{className:"w-6 h-6 text-green-500 mt-0.5"}),(0,E.jsx)("span",{className:"text-gray-700",children:"Video lectures & resources"})]}),(0,E.jsxs)("li",{className:"flex items-start space-x-3",children:[(0,E.jsx)(x,{className:"w-6 h-6 text-green-500 mt-0.5"}),(0,E.jsx)("span",{className:"text-gray-700",children:"Track your progress"})]})]}),(0,E.jsxs)("button",{onClick:()=>t("course-signup"),className:"w-full bg-purple-600 text-white py-4 rounded-lg font-semibold hover:bg-purple-700 transition flex items-center justify-center space-x-2",children:[(0,E.jsx)("span",{children:"Access Course Portal"}),(0,E.jsx)(y,{className:"w-5 h-5"})]})]})]})]})]})]})},j=v("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var A=r(326);class C extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",r=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=r}}class O extends C{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class P extends C{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class R extends C{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var I;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(I||(I={}));class D{constructor(e){let{headers:t={},customFetch:n,region:a=I.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=a,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(r.bind(r,630)).then(e=>{let{default:r}=e;return r(...t)})}:fetch),function(){return t(...arguments)}})(n)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){return(0,A.__awaiter)(this,arguments,void 0,function(e){var t=this;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var n;try{const{headers:a,method:s,body:i,signal:o}=r;let l={},{region:c}=r;c||(c=t.region);const u=new URL("".concat(t.url,"/").concat(e));let d;c&&"any"!==c&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c)),i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?"undefined"!==typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=i):"string"===typeof i?(l["Content-Type"]="text/plain",d=i):"undefined"!==typeof FormData&&i instanceof FormData?d=i:(l["Content-Type"]="application/json",d=JSON.stringify(i)):d=i;const h=yield t.fetch(u.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),t.headers),a),body:d,signal:o}).catch(e=>{if("AbortError"===e.name)throw e;throw new O(e)}),f=h.headers.get("x-relay-error");if(f&&"true"===f)throw new P(h);if(!h.ok)throw new R(h);let m,p=(null!==(n=h.headers.get("Content-Type"))&&void 0!==n?n:"text/plain").split(";")[0].trim();return m="application/json"===p?yield h.json():"application/octet-stream"===p||"application/pdf"===p?yield h.blob():"text/event-stream"===p?h:"multipart/form-data"===p?yield h.formData():yield h.text(),{data:m,error:null,response:h}}catch(a){return a instanceof Error&&"AbortError"===a.name?{data:null,error:new O(a)}:{data:null,error:a,response:a instanceof R||a instanceof P?a.context:void 0}}}()})}}var L=r(980);const{tE:M,lc:F,pT:U,ZS:z,le:B,kf:H}=L;const W=class{static detectEnvironment(){var e;if("undefined"!==typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!==typeof r.g&&"undefined"!==typeof r.g.WebSocket)return{type:"native",constructor:r.g.WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocketPair&&"undefined"===typeof globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!==typeof globalThis&&globalThis.EdgeRuntime||"undefined"!==typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!==typeof process){const e=process.versions;if(e&&e.node){const t=e.node,r=parseInt(t.replace(/^v/,"").split(".")[0]);return r>=22?"undefined"!==typeof globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:"Node.js ".concat(r," detected but native WebSocket not found."),workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:"Node.js ".concat(r," detected without native WebSocket support."),workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+="\n\nSuggested solution: ".concat(e.workaround)),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(Ue){return!1}}},V="realtime-js/".concat("2.76.1"),G=1e4;var q,K,Y,J,X,Q;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(q||(q={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(K||(K={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(Y||(Y={})),function(e){e.websocket="websocket"}(J||(J={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(X||(X={}));class Z{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const n=t.getUint8(1),a=t.getUint8(2);let s=this.HEADER_LENGTH+2;const i=r.decode(e.slice(s,s+n));s+=n;const o=r.decode(e.slice(s,s+a));s+=a;return{ref:null,topic:i,event:o,payload:JSON.parse(r.decode(e.slice(s,e.byteLength)))}}}class ee{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(Q||(Q={}));const te=function(e,t){var r;const n=null!==(r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==r?r:[];return t?Object.keys(t).reduce((r,a)=>(r[a]=re(a,e,t,n),r),{}):{}},re=(e,t,r,n)=>{const a=t.find(t=>t.name===e),s=null===a||void 0===a?void 0:a.type,i=r[e];return s&&!n.includes(s)?ne(s,i):ae(i)},ne=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return le(t,r)}switch(e){case Q.bool:return se(t);case Q.float4:case Q.float8:case Q.int2:case Q.int4:case Q.int8:case Q.numeric:case Q.oid:return ie(t);case Q.json:case Q.jsonb:return oe(t);case Q.timestamp:return ce(t);case Q.abstime:case Q.date:case Q.daterange:case Q.int4range:case Q.int8range:case Q.money:case Q.reltime:case Q.text:case Q.time:case Q.timestamptz:case Q.timetz:case Q.tsrange:case Q.tstzrange:default:return ae(t)}},ae=e=>e,se=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},ie=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},oe=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log("JSON parse error: ".concat(t)),e}return e},le=(e,t)=>{if("string"!==typeof e)return e;const r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){let n;const s=e.slice(1,r);try{n=JSON.parse("["+s+"]")}catch(a){n=s?s.split(","):[]}return n.map(e=>ne(t,e))}return e},ce=e=>"string"===typeof e?e.replace(" ","T"):e,ue=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class de{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:G;this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:r}=e;this.recHooks.filter(e=>e.status===t).forEach(e=>e.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var he,fe,me,pe;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(he||(he={}));class ge{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ge.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=ge.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],n()}),this.channel._on(r.diff,{},e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=ge.syncDiff(this.state,e,t,r),n())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){const a=this.cloneDeep(e),s=this.transformState(t),i={},o={};return this.map(a,(e,t)=>{s[e]||(o[e]=t)}),this.map(s,(e,t)=>{const r=a[e];if(r){const n=t.map(e=>e.presence_ref),a=r.map(e=>e.presence_ref),s=t.filter(e=>a.indexOf(e.presence_ref)<0),l=r.filter(e=>n.indexOf(e.presence_ref)<0);s.length>0&&(i[e]=s),l.length>0&&(o[e]=l)}else i[e]=t}),this.syncDiff(a,{joins:i,leaves:o},r,n)}static syncDiff(e,t,r,n){const{joins:a,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(a,(t,n)=>{var a;const s=null!==(a=e[t])&&void 0!==a?a:[];if(e[t]=this.cloneDeep(n),s.length>0){const r=e[t].map(e=>e.presence_ref),n=s.filter(e=>r.indexOf(e.presence_ref)<0);e[t].unshift(...n)}r(t,s,n)}),this.map(s,(t,r)=>{let a=e[t];if(!a)return;const s=r.map(e=>e.presence_ref);a=a.filter(e=>s.indexOf(e.presence_ref)<0),e[t]=a,n(t,a,r),0===a.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const n=e[r];return t[r]="metas"in n?n.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(fe||(fe={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(me||(me={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(pe||(pe={}));class ve{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},r=arguments.length>2?arguments[2]:void 0;var n,a;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=K.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new de(this,Y.join,this.params,this.timeout),this.rejoinTimer=new ee(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=K.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=K.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=K.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=K.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=K.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Y.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new ge(this),this.broadcastEndpointURL=ue(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(a=null===(n=this.params.config)||void 0===n?void 0:n.broadcast)||void 0===a?void 0:a.replay))throw"tried to use replay on public channel '".concat(this.topic,"'. It must be a private channel.")}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var r,n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==K.closed){const{config:{broadcast:s,presence:i,private:o}}=this.params,l=null!==(n=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==n?n:[],c=!!this.bindings[me.PRESENCE]&&this.bindings[me.PRESENCE].length>0||!0===(null===(a=this.params.config.presence)||void 0===a?void 0:a.enabled),u={},d={broadcast:s,presence:Object.assign(Object.assign({},i),{enabled:c}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(t=>null===e||void 0===e?void 0:e(pe.CHANNEL_ERROR,t)),this._onClose(()=>null===e||void 0===e?void 0:e(pe.CLOSED)),this.updateJoinPayload(Object.assign({config:d},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async t=>{let{postgres_changes:r}=t;var n;if(this.socket.setAuth(),void 0!==r){const t=this.bindings.postgres_changes,a=null!==(n=null===t||void 0===t?void 0:t.length)&&void 0!==n?n:0,s=[];for(let n=0;n<a;n++){const a=t[n],{filter:{event:i,schema:o,table:l,filter:c}}=a,u=r&&r[n];if(!u||u.event!==i||u.schema!==o||u.table!==l||u.filter!==c)return this.unsubscribe(),this.state=K.errored,void(null===e||void 0===e||e(pe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));s.push(Object.assign(Object.assign({},a),{id:u.id}))}return this.bindings.postgres_changes=s,void(e&&e(pe.SUBSCRIBED))}null===e||void 0===e||e(pe.SUBSCRIBED)}).receive("error",t=>{this.state=K.errored,null===e||void 0===e||e(pe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null===e||void 0===e||e(pe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===K.joined&&e===me.PRESENCE&&(this.socket.log("channel","resubscribe to ".concat(this.topic," due to change in presence callbacks on joined channel")),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async httpSend(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var n;const a=this.socket.accessTokenValue?"Bearer ".concat(this.socket.accessTokenValue):"";if(void 0===t||null===t)return Promise.reject("Payload is required for httpSend()");const s={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},i=await this._fetchWithTimeout(this.broadcastEndpointURL,s,null!==(n=r.timeout)&&void 0!==n?n:this.timeout);if(202===i.status)return{success:!0};let o=i.statusText;try{const e=await i.json();o=e.error||e.message||o}catch(l){}return Promise.reject(new Error(o))}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r,n;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var n,a,s;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(s=null===(a=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===a?void 0:a.broadcast)||void 0===s?void 0:s.ack)||r("ok"),i.receive("ok",()=>r("ok")),i.receive("error",()=>r("error")),i.receive("timeout",()=>r("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:i}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?"Bearer ".concat(this.socket.accessTokenValue):"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await(null===(n=e.body)||void 0===n?void 0:n.cancel()),e.ok?"ok":"error"}catch(a){return"AbortError"===a.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=K.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(Y.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(n=>{r=new de(this,Y.leave,{},e),r.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null===r||void 0===r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=K.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const n=new AbortController,a=setTimeout(()=>n.abort(),r),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(a),s}_push(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let n=new de(this,e,t,r);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel","discarded push due to buffer overflow: ".concat(e.event),e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,a;const s=e.toLocaleLowerCase(),{close:i,error:o,leave:l,join:c}=Y;if(r&&[i,o,l,c].indexOf(s)>=0&&r!==this._joinRef())return;let u=this._onMessage(s,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter(e=>{var t,r,n;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(n=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===n?void 0:n.toLocaleLowerCase())===s}).map(e=>e.callback(u,r)):null===(a=this.bindings[s])||void 0===a||a.filter(e=>{var r,n,a,i,o,l;if(["broadcast","presence","postgres_changes"].includes(s)){if("id"in e){const s=e.id,i=null===(r=e.filter)||void 0===r?void 0:r.event;return s&&(null===(n=t.ids)||void 0===n?void 0:n.includes(s))&&("*"===i||(null===i||void 0===i?void 0:i.toLocaleLowerCase())===(null===(a=t.data)||void 0===a?void 0:a.type.toLocaleLowerCase()))}{const r=null===(o=null===(i=null===e||void 0===e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===r||r===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===s}).map(e=>{if("object"===typeof u&&"ids"in u){const e=u.data,{schema:t,table:r,commit_timestamp:n,type:a,errors:s}=e,i={schema:t,table:r,commit_timestamp:n,eventType:a,new:{},old:{},errors:s};u=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(u,r)})}_isClosed(){return this.state===K.closed}_isJoined(){return this.state===K.joined}_isJoining(){return this.state===K.joining}_isLeaving(){return this.state===K.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,r){const n=e.toLocaleLowerCase(),a={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===r&&ve.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Y.close,{},e)}_onError(e){this._on(Y.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=K.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=te(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=te(e.columns,e.old_record)),t}}const be=()=>{},ye=25e3,xe=10,we=100,Se=[1e3,2e3,5e3,1e4];class _e{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=G,this.transport=null,this.heartbeatIntervalMs=ye,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=be,this.ref=0,this.reconnectTimer=null,this.logger=be,this.conn=null,this.sendBuffer=[],this.serializer=new Z,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(r.bind(r,630)).then(e=>{let{default:r}=e;return r(...t)}).catch(e=>{throw new Error("Failed to load @supabase/node-fetch: ".concat(e.message,". ")+"This is required for HTTP requests in Node.js environments without native fetch.")})}:fetch),function(){return t(...arguments)}},!(null===(n=null===t||void 0===t?void 0:t.params)||void 0===n?void 0:n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint="".concat(e,"/").concat(J.websocket),this.httpEndpoint=ue(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=W.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error("".concat(t,"\n\n")+'To use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })');throw new Error("WebSocket not available: ".concat(t))}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case q.connecting:return X.Connecting;case q.open:return X.Open;case q.closing:return X.Closing;default:return X.Closed}}isConnected(){return this.connectionState()===X.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};const r="realtime:".concat(e),n=this.getChannels().find(e=>e.topic===r);if(n)return n;{const r=new ve("realtime:".concat(e),t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:r,payload:n,ref:a}=e,s=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push","".concat(t," ").concat(r," (").concat(a,")"),n),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},we)}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event)try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error")}catch(o){this.log("error","error in heartbeat callback",o)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:r,payload:n,ref:a}=e,s=a?"(".concat(a,")"):"",i=n.status||"";this.log("receive","".concat(i," ").concat(t," ").concat(r," ").concat(s).trim(),n),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,n,a)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport","connected to ".concat(this.endpointURL())),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport","".concat(e)),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Y.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return"".concat(e).concat(r).concat(n)}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=t||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{const r={access_token:e,version:V};e&&t.updateJoinPayload(r),t.joinedOnce&&t._isJoined()&&t._push(Y.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"general";this.setAuth().catch(t=>{this.log("error","error setting auth in ".concat(e),t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(n){this.log("error","error in ".concat(e," callback"),n)}})}catch(r){this.log("error","error triggering ".concat(e," callbacks"),r)}}_setupReconnectionTimer(){this.reconnectTimer=new ee(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},xe)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,n,a,s,i,o,l,c;if(this.transport=null!==(t=null===e||void 0===e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(r=null===e||void 0===e?void 0:e.timeout)&&void 0!==r?r:G,this.heartbeatIntervalMs=null!==(n=null===e||void 0===e?void 0:e.heartbeatIntervalMs)&&void 0!==n?n:ye,this.worker=null!==(a=null===e||void 0===e?void 0:e.worker)&&void 0!==a&&a,this.accessToken=null!==(s=null===e||void 0===e?void 0:e.accessToken)&&void 0!==s?s:null,this.heartbeatCallback=null!==(i=null===e||void 0===e?void 0:e.heartbeatCallback)&&void 0!==i?i:be,(null===e||void 0===e?void 0:e.params)&&(this.params=e.params),(null===e||void 0===e?void 0:e.logger)&&(this.logger=e.logger),((null===e||void 0===e?void 0:e.logLevel)||(null===e||void 0===e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(o=null===e||void 0===e?void 0:e.reconnectAfterMs)&&void 0!==o?o:e=>Se[e-1]||1e4,this.encode=null!==(l=null===e||void 0===e?void 0:e.encode)&&void 0!==l?l:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(c=null===e||void 0===e?void 0:e.decode)&&void 0!==c?c:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null===e||void 0===e?void 0:e.workerUrl}}}class Ee extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ke(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class Te extends Ee{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ne extends Ee{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const je=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(r.bind(r,630)).then(e=>{let{default:r}=e;return r(...t)})}:fetch),function(){return t(...arguments)}},Ae=e=>{if(Array.isArray(e))return e.map(e=>Ae(e));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(e=>{let[r,n]=e;const a=r.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[a]=Ae(n)}),t},Ce=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Oe=(e,t,n)=>(0,A.__awaiter)(void 0,void 0,void 0,function*(){const a=yield(0,A.__awaiter)(void 0,void 0,void 0,function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(r.bind(r,630))).Response:Response});e instanceof a&&!(null===n||void 0===n?void 0:n.noResolveJson)?e.json().then(r=>{const n=e.status||500,a=(null===r||void 0===r?void 0:r.statusCode)||n+"";t(new Te(Ce(r),n,a))}).catch(e=>{t(new Ne(Ce(e),e))}):t(new Ne(Ce(e),e))}),Pe=(e,t,r,n)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"!==e&&n?((e=>{if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(n)?(a.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,(null===t||void 0===t?void 0:t.duplex)&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r)):a};function Re(e,t,r,n,a,s){return(0,A.__awaiter)(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,Pe(t,n,a,s)).then(e=>{if(!e.ok)throw e;return(null===n||void 0===n?void 0:n.noResolveJson)?e:e.json()}).then(e=>i(e)).catch(e=>Oe(e,o,n))})})}function Ie(e,t,r,n){return(0,A.__awaiter)(this,void 0,void 0,function*(){return Re(e,"GET",t,r,n)})}function De(e,t,r,n,a){return(0,A.__awaiter)(this,void 0,void 0,function*(){return Re(e,"POST",t,n,a,r)})}function Le(e,t,r,n,a){return(0,A.__awaiter)(this,void 0,void 0,function*(){return Re(e,"PUT",t,n,a,r)})}function Me(e,t,r,n,a){return(0,A.__awaiter)(this,void 0,void 0,function*(){return Re(e,"DELETE",t,n,a,r)})}class Fe{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ke(e))return{data:null,error:e};throw e}})}}var Ue;Ue=Symbol.toStringTag;const ze=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Ue]="BlobDownloadBuilder",this.promise=null}asStream(){return new Fe(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{const e=yield this.downloadFn();return{data:yield e.blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ke(e))return{data:null,error:e};throw e}})}},Be={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},He={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class We{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=je(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,n){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{let a;const s=Object.assign(Object.assign({},He),n);let i=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(s.upsert)});const o=s.metadata;"undefined"!==typeof Blob&&r instanceof Blob?(a=new FormData,a.append("cacheControl",s.cacheControl),o&&a.append("metadata",this.encodeMetadata(o)),a.append("",r)):"undefined"!==typeof FormData&&r instanceof FormData?(a=r,a.append("cacheControl",s.cacheControl),o&&a.append("metadata",this.encodeMetadata(o))):(a=r,i["cache-control"]="max-age=".concat(s.cacheControl),i["content-type"]=s.contentType,o&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null===n||void 0===n?void 0:n.headers)&&(i=Object.assign(Object.assign({},i),n.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=yield("PUT"==e?Le:De)(this.fetch,"".concat(this.url,"/object/").concat(c),a,Object.assign({headers:i},(null===s||void 0===s?void 0:s.duplex)?{duplex:s.duplex}:{}));return{data:{path:l,id:u.Id,fullPath:u.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ke(a))return{data:null,error:a};throw a}})}upload(e,t,r){return(0,A.__awaiter)(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return(0,A.__awaiter)(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),s=this._getFinalPath(a),i=new URL(this.url+"/object/upload/sign/".concat(s));i.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:He.upsert},n),s=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!==typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,s["cache-control"]="max-age=".concat(t.cacheControl),s["content-type"]=t.contentType);return{data:{path:a,fullPath:(yield Le(this.fetch,i.toString(),e,{headers:s})).Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(ke(o))return{data:null,error:o};throw o}})}createSignedUploadUrl(e,t){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const n=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(n["x-upsert"]="true");const a=yield De(this.fetch,"".concat(this.url,"/object/upload/sign/").concat(r),{},{headers:n}),s=new URL(this.url+a.url),i=s.searchParams.get("token");if(!i)throw new Ee("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:i},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ke(r))return{data:null,error:r};throw r}})}update(e,t,r){return(0,A.__awaiter)(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,"".concat(this.url,"/object/move"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===r||void 0===r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ke(n))return{data:null,error:n};throw n}})}copy(e,t,r){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:{path:(yield De(this.fetch,"".concat(this.url,"/object/copy"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===r||void 0===r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ke(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,r){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),a=yield De(this.fetch,"".concat(this.url,"/object/sign/").concat(n),Object.assign({expiresIn:t},(null===r||void 0===r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers});const s=(null===r||void 0===r?void 0:r.download)?"&download=".concat(!0===r.download?"":r.download):"";return a={signedUrl:encodeURI("".concat(this.url).concat(a.signedURL).concat(s))},{data:a,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ke(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,r){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{const n=yield De(this.fetch,"".concat(this.url,"/object/sign/").concat(this.bucketId),{expiresIn:t,paths:e},{headers:this.headers}),a=(null===r||void 0===r?void 0:r.download)?"&download=".concat(!0===r.download?"":r.download):"";return{data:n.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI("".concat(this.url).concat(e.signedURL).concat(a)):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ke(n))return{data:null,error:n};throw n}})}download(e,t){const r="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",n=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),a=n?"?".concat(n):"",s=this._getFinalPath(e);return new ze(()=>Ie(this.fetch,"".concat(this.url,"/").concat(r,"/").concat(s).concat(a),{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}info(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield Ie(this.fetch,"".concat(this.url,"/object/info/").concat(t),{headers:this.headers});return{data:Ae(e),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ke(r))return{data:null,error:r};throw r}})}exists(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,r,n){return(0,A.__awaiter)(this,void 0,void 0,function*(){return Re(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}(this.fetch,"".concat(this.url,"/object/").concat(t),{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ke(r)&&r instanceof Ne){const e=r.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],a=(null===t||void 0===t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==a&&n.push(a);const s="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==i&&n.push(i);let o=n.join("&");return""!==o&&(o="?".concat(o)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(s,"/public/").concat(r).concat(o))}}}remove(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield Me(this.fetch,"".concat(this.url,"/object/").concat(this.bucketId),{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ke(t))return{data:null,error:t};throw t}})}list(e,t,r){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Be),t),{prefix:e||""});return{data:yield De(this.fetch,"".concat(this.url,"/object/list/").concat(this.bucketId),n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ke(n))return{data:null,error:n};throw n}})}listV2(e,t){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield De(this.fetch,"".concat(this.url,"/object/list-v2/").concat(this.bucketId),r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ke(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e.replace(/^\/+/,""))}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}}const Ve="2.76.1",Ge={"X-Client-Info":"storage-js/".concat(Ve)};class qe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.shouldThrowOnError=!1;const a=new URL(e);if(null===n||void 0===n?void 0:n.useNewHostname){/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase."))}this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ge),t),this.fetch=je(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield Ie(this.fetch,"".concat(this.url,"/bucket"),{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ke(e))return{data:null,error:e};throw e}})}getBucket(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield Ie(this.fetch,"".concat(this.url,"/bucket/").concat(e),{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ke(t))return{data:null,error:t};throw t}})}createBucket(e){return(0,A.__awaiter)(this,arguments,void 0,function(e){var t=this;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return function*(){try{return{data:yield De(t.fetch,"".concat(t.url,"/bucket"),{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(ke(n))return{data:null,error:n};throw n}}()})}updateBucket(e,t){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield Le(this.fetch,"".concat(this.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ke(r))return{data:null,error:r};throw r}})}emptyBucket(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,"".concat(this.url,"/bucket/").concat(e,"/empty"),{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ke(t))return{data:null,error:t};throw t}})}deleteBucket(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield Me(this.fetch,"".concat(this.url,"/bucket/").concat(e),{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ke(t))return{data:null,error:t};throw t}})}}class Ke{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ge),t),this.fetch=je(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,"".concat(this.url,"/bucket"),{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ke(t))return{data:null,error:t};throw t}})}listBuckets(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{const t=new URLSearchParams;void 0!==(null===e||void 0===e?void 0:e.limit)&&t.set("limit",e.limit.toString()),void 0!==(null===e||void 0===e?void 0:e.offset)&&t.set("offset",e.offset.toString()),(null===e||void 0===e?void 0:e.sortColumn)&&t.set("sortColumn",e.sortColumn),(null===e||void 0===e?void 0:e.sortOrder)&&t.set("sortOrder",e.sortOrder),(null===e||void 0===e?void 0:e.search)&&t.set("search",e.search);const r=t.toString(),n=r?"".concat(this.url,"/bucket?").concat(r):"".concat(this.url,"/bucket"),a=yield Ie(this.fetch,n,{headers:this.headers});return{data:Array.isArray(a)?a.filter(e=>"ANALYTICS"===e.type):[],error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ke(t))return{data:null,error:t};throw t}})}deleteBucket(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield Me(this.fetch,"".concat(this.url,"/bucket/").concat(e),{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ke(t))return{data:null,error:t};throw t}})}}const $e={"X-Client-Info":"storage-js/".concat(Ve),"Content-Type":"application/json"};class Ye extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Je(e){return"object"===typeof e&&null!==e&&"__isStorageVectorsError"in e}class Xe extends Ye{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Qe extends Ye{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var Ze;!function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"}(Ze||(Ze={}));const et=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(r.bind(r,630)).then(e=>{let{default:r}=e;return r(...t)})}:fetch),function(){return t(...arguments)}},tt=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),rt=(e,t,r,n)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"!==e&&n?((e=>{if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(n)?(a.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,Object.assign(Object.assign({},a),r)):a};function nt(e,t,r,n,a,s){return(0,A.__awaiter)(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,rt(t,n,a,s)).then(e=>{if(!e.ok)throw e;if(null===n||void 0===n?void 0:n.noResolveJson)return e;const t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json():{}}).then(e=>i(e)).catch(e=>((e,t,r)=>(0,A.__awaiter)(void 0,void 0,void 0,function*(){if(e&&"object"===typeof e&&"status"in e&&"ok"in e&&"number"===typeof e.status&&!(null===r||void 0===r?void 0:r.noResolveJson)){const r=e.status||500,n=e;if("function"===typeof n.json)n.json().then(e=>{const n=(null===e||void 0===e?void 0:e.statusCode)||(null===e||void 0===e?void 0:e.code)||r+"";t(new Xe(tt(e),r,n))}).catch(()=>{const e=r+"",a=n.statusText||"HTTP ".concat(r," error");t(new Xe(a,r,e))});else{const e=r+"",a=n.statusText||"HTTP ".concat(r," error");t(new Xe(a,r,e))}}else t(new Qe(tt(e),e))}))(e,o,n))})})}function at(e,t,r,n,a){return(0,A.__awaiter)(this,void 0,void 0,function*(){return nt(e,"POST",t,n,a,r)})}class st{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},$e),t),this.fetch=et(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:(yield at(this.fetch,"".concat(this.url,"/CreateIndex"),e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Je(t))return{data:null,error:t};throw t}})}getIndex(e,t){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield at(this.fetch,"".concat(this.url,"/GetIndex"),{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Je(r))return{data:null,error:r};throw r}})}listIndexes(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield at(this.fetch,"".concat(this.url,"/ListIndexes"),e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Je(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:(yield at(this.fetch,"".concat(this.url,"/DeleteIndex"),{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Je(r))return{data:null,error:r};throw r}})}}class it{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},$e),t),this.fetch=et(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield at(this.fetch,"".concat(this.url,"/PutVectors"),e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Je(t))return{data:null,error:t};throw t}})}getVectors(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield at(this.fetch,"".concat(this.url,"/GetVectors"),e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Je(t))return{data:null,error:t};throw t}})}listVectors(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error("segmentIndex must be between 0 and ".concat(e.segmentCount-1))}return{data:yield at(this.fetch,"".concat(this.url,"/ListVectors"),e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Je(t))return{data:null,error:t};throw t}})}queryVectors(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield at(this.fetch,"".concat(this.url,"/QueryVectors"),e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Je(t))return{data:null,error:t};throw t}})}deleteVectors(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield at(this.fetch,"".concat(this.url,"/DeleteVectors"),e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Je(t))return{data:null,error:t};throw t}})}}class ot{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},$e),t),this.fetch=et(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:(yield at(this.fetch,"".concat(this.url,"/CreateVectorBucket"),{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Je(t))return{data:null,error:t};throw t}})}getBucket(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield at(this.fetch,"".concat(this.url,"/GetVectorBucket"),{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Je(t))return{data:null,error:t};throw t}})}listBuckets(){return(0,A.__awaiter)(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){try{return{data:yield at(e.fetch,"".concat(e.url,"/ListVectorBuckets"),t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Je(r))return{data:null,error:r};throw r}}()})}deleteBucket(e){return(0,A.__awaiter)(this,void 0,void 0,function*(){try{return{data:(yield at(this.fetch,"".concat(this.url,"/DeleteVectorBucket"),{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Je(t))return{data:null,error:t};throw t}})}}class lt extends ot{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t.headers||{},t.fetch)}from(e){return new ct(this.url,this.headers,e,this.fetch)}}class ct extends st{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return(0,A.__awaiter)(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return(0,A.__awaiter)(this,arguments,void 0,function(){var t=this;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){return e.listIndexes.call(t,Object.assign(Object.assign({},r),{vectorBucketName:t.vectorBucketName}))}()})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return(0,A.__awaiter)(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return(0,A.__awaiter)(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new ut(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class ut extends it{constructor(e,t,r,n,a){super(e,t,a),this.vectorBucketName=r,this.indexName=n}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return(0,A.__awaiter)(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return(0,A.__awaiter)(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return(0,A.__awaiter)(this,arguments,void 0,function(){var t=this;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){return e.listVectors.call(t,Object.assign(Object.assign({},r),{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}()})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return(0,A.__awaiter)(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return(0,A.__awaiter)(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class dt extends qe{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)}from(e){return new We(this.url,this.headers,e,this.fetch)}get vectors(){return new lt(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Ke(this.url+"/iceberg",this.headers,this.fetch)}}let ht="";ht="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const ft={headers:{"X-Client-Info":"supabase-js-".concat(ht,"/").concat("2.76.1")}},mt={schema:"public"},pt={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},gt={};var vt=r(630);const bt=e=>{let t;return t=e||("undefined"===typeof fetch?vt.default:fetch),function(){return t(...arguments)}},yt=(e,t,r)=>{const n=bt(r),a="undefined"===typeof Headers?vt.Headers:Headers;return async(r,s)=>{var i;const o=null!==(i=await t())&&void 0!==i?i:e;let l=new a(null===s||void 0===s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization","Bearer ".concat(o)),n(r,Object.assign(Object.assign({},s),{headers:l}))}};const xt="2.76.1",wt=3e4,St=9e4,_t={"X-Client-Info":"gotrue-js/".concat(xt)},Et="X-Supabase-Api-Version",kt={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Tt=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Nt extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function jt(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class At extends Nt{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class Ct extends Nt{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Ot extends Nt{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class Pt extends Ot{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Rt extends Ot{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class It extends Ot{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Dt extends Ot{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Lt extends Ot{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Mt extends Ot{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ft(e){return jt(e)&&"AuthRetryableFetchError"===e.name}class Ut extends Ot{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class zt extends Ot{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Bt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ht=" \t\n\r=".split(""),Wt=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Ht.length;t+=1)e[Ht[t].charCodeAt(0)]=-2;for(let t=0;t<Bt.length;t+=1)e[Bt[t].charCodeAt(0)]=t;return e})();function Vt(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(Bt[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(Bt[e]),t.queuedBits-=6}}function Gt(e,t,r){const n=Wt[e];if(!(n>-1)){if(-2===n)return;throw new Error('Invalid Base64-URL character "'.concat(String.fromCharCode(e),'"'))}for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function qt(e){const t=[],r=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return void r(e);for(let r=1;r<6;r+=1)if(0===(e>>7-r&1)){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,n,r)};for(let i=0;i<e.length;i+=1)Gt(e.charCodeAt(i),a,s);return t.join("")}function Kt(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error("Unrecognized Unicode codepoint: ".concat(e.toString(16)))}t(e)}function $t(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const t=1024*(n-55296)&65535;n=65536+(e.charCodeAt(r+1)-56320&65535|t),r+=1}Kt(n,t)}}function Yt(e){const t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};for(let a=0;a<e.length;a+=1)Gt(e.charCodeAt(a),r,n);return new Uint8Array(t)}function Jt(e){const t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};return e.forEach(e=>Vt(e,r,n)),Vt(null,r,n),t.join("")}const Xt=()=>"undefined"!==typeof window&&"undefined"!==typeof document,Qt={tested:!1,writable:!1},Zt=()=>{if(!Xt())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(Qt.tested)return Qt.writable;const e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Qt.tested=!0,Qt.writable=!0}catch(t){Qt.tested=!0,Qt.writable=!1}return Qt.writable};const er=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(r.bind(r,630)).then(e=>{let{default:r}=e;return r(...t)})}:fetch),function(){return t(...arguments)}},tr=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},rr=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(Ue){return r}},nr=async(e,t)=>{await e.removeItem(t)};class ar{constructor(){this.promise=new ar.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function sr(e){const t=e.split(".");if(3!==t.length)throw new zt("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!Tt.test(t[r]))throw new zt("JWT not in base64url format");return{header:JSON.parse(qt(t[0])),payload:JSON.parse(qt(t[1])),signature:Yt(t[2]),raw:{header:t[0],payload:t[1]}}}function ir(e){return("0"+e.toString(16)).substr(-2)}async function or(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(r);return Array.from(n).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function lr(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let n=0;n<56;n++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,ir).join("")}();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await tr(e,"".concat(t,"-code-verifier"),a);const s=await or(n);return[s,n===s?"plain":"s256"]}ar.promiseConstructor=Promise;const cr=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const ur=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function dr(e){if(!ur.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function hr(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"===typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "'.concat(t,'" property of the session object is not supported. Please use getUser() instead.'))},set:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))},deleteProperty:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))}})}function fr(e){return JSON.parse(JSON.stringify(e))}const mr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),pr=[502,503,504];async function gr(e){var t,r;if(!("object"===typeof(r=e)&&null!==r&&"status"in r&&"ok"in r&&"json"in r&&"function"===typeof r.json))throw new Mt(mr(e),0);if(pr.includes(e.status))throw new Mt(mr(e),e.status);let n,a;try{n=await e.json()}catch(i){throw new Ct(mr(i),i)}const s=function(e){const t=e.headers.get(Et);if(!t)return null;if(!t.match(cr))return null;try{return new Date("".concat(t,"T00:00:00.0Z"))}catch(i){return null}}(e);if(s&&s.getTime()>=kt.timestamp&&"object"===typeof n&&n&&"string"===typeof n.code?a=n.code:"object"===typeof n&&n&&"string"===typeof n.error_code&&(a=n.error_code),a){if("weak_password"===a)throw new Ut(mr(n),e.status,(null===(t=n.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===a)throw new Pt}else if("object"===typeof n&&n&&"object"===typeof n.weak_password&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0))throw new Ut(mr(n),e.status,n.weak_password.reasons);throw new At(mr(n),e.status||500,a)}async function vr(e,t,r,n){var a;const s=Object.assign({},null===n||void 0===n?void 0:n.headers);s[Et]||(s[Et]=kt.name),(null===n||void 0===n?void 0:n.jwt)&&(s.Authorization="Bearer ".concat(n.jwt));const i=null!==(a=null===n||void 0===n?void 0:n.query)&&void 0!==a?a:{};(null===n||void 0===n?void 0:n.redirectTo)&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await async function(e,t,r,n,a,s){const i=((e,t,r,n)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))})(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new Mt(mr(l),0)}o.ok||await gr(o);if(null===n||void 0===n?void 0:n.noResolveJson)return o;try{return await o.json()}catch(l){await gr(l)}}(e,t,r+o,{headers:s,noResolveJson:null===n||void 0===n?void 0:n.noResolveJson},{},null===n||void 0===n?void 0:n.body);return(null===n||void 0===n?void 0:n.xform)?null===n||void 0===n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}function br(e){var t;let r=null;var n;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=(n=e.expires_in,Math.round(Date.now()/1e3)+n)));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function yr(e){const t=br(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function xr(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function wr(e){return{data:e,error:null}}function Sr(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=(0,A.__rest)(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},user:Object.assign({},i)},error:null}}function _r(e){return e}const Er=["global","local","others"];class kr{constructor(e){let{url:t="",headers:r={},fetch:n}=e;this.url=t,this.headers=r,this.fetch=er(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Er[0];if(Er.indexOf(t)<0)throw new Error("@supabase/auth-js: Parameter scope must be one of ".concat(Er.join(", ")));try{return await vr(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(jt(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await vr(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:xr})}catch(r){if(jt(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=(0,A.__rest)(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=null===r||void 0===r?void 0:r.newEmail,delete n.newEmail),await vr(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:n,headers:this.headers,xform:Sr,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(jt(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await vr(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:xr})}catch(t){if(jt(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,n,a,s,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await vr(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(a=null===(n=null===e||void 0===e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==a?a:""},xform:_r});if(c.error)throw c.error;const u=await c.json(),d=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(r,"Page")]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(jt(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){dr(e);try{return await vr(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:xr})}catch(t){if(jt(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){dr(e);try{return await vr(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:xr})}catch(r){if(jt(r))return{data:{user:null},error:r};throw r}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];dr(e);try{return await vr(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:xr})}catch(r){if(jt(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){dr(e.userId);try{const{data:t,error:r}=await vr(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(t){if(jt(t))return{data:null,error:t};throw t}}async _deleteFactor(e){dr(e.userId),dr(e.id);try{return{data:await vr(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if(jt(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,n,a,s,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await vr(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(a=null===(n=null===e||void 0===e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==a?a:""},xform:_r});if(c.error)throw c.error;const u=await c.json(),d=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(r,"Page")]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(jt(l))return{data:{clients:[]},error:l};throw l}}async _createOAuthClient(e){try{return await vr(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients"),{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(jt(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await vr(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(jt(t))return{data:null,error:t};throw t}}async _deleteOAuthClient(e){try{return await vr(this.fetch,"DELETE","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(jt(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await vr(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients/").concat(e,"/regenerate_secret"),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(jt(t))return{data:null,error:t};throw t}}}function Tr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Nr=!!(globalThis&&Zt()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class jr extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Ar extends jr{}async function Cr(e,t,r){Nr&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Nr&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async n=>{if(!n){if(0===t)throw Nr&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Ar('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));if(Nr)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}Nr&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{Nr&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}))}function Or(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error('@supabase/auth-js: Address "'.concat(e,'" is invalid.'));return e.toLowerCase()}function Pr(e){const t=(new TextEncoder).encode(e);return"0x"+Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}class Rr extends Error{constructor(e){let{message:t,code:r,cause:n,name:a}=e;var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=null!==(s=null!==a&&void 0!==a?a:n instanceof Error?n.name:void 0)&&void 0!==s?s:"Unknown Error",this.code=r}}class Ir extends Rr{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function Dr(e){let{error:t,options:r}=e;var n,a,s;const{publicKey:i}=r;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(r.signal instanceof AbortSignal)return new Rr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if("ConstraintError"===t.name){if(!0===(null===(n=i.authenticatorSelection)||void 0===n?void 0:n.requireResidentKey))return new Rr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if("conditional"===r.mediation&&"required"===(null===(a=i.authenticatorSelection)||void 0===a?void 0:a.userVerification))return new Rr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if("required"===(null===(s=i.authenticatorSelection)||void 0===s?void 0:s.userVerification))return new Rr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if("InvalidStateError"===t.name)return new Rr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if("NotAllowedError"===t.name)return new Rr({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("NotSupportedError"===t.name){return 0===i.pubKeyCredParams.filter(e=>"public-key"===e.type).length?new Rr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Rr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t})}if("SecurityError"===t.name){const e=window.location.hostname;if(!Hr(e))return new Rr({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(i.rp.id!==e)return new Rr({message:'The RP ID "'.concat(i.rp.id,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("TypeError"===t.name){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Rr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if("UnknownError"===t.name)return new Rr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Rr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Lr(e){let{error:t,options:r}=e;const{publicKey:n}=r;if(!n)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(r.signal instanceof AbortSignal)return new Rr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if("NotAllowedError"===t.name)return new Rr({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("SecurityError"===t.name){const e=window.location.hostname;if(!Hr(e))return new Rr({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(n.rpId!==e)return new Rr({message:'The RP ID "'.concat(n.rpId,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("UnknownError"===t.name)return new Rr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Rr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}const Mr=new class{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}};function Fr(e){if(!e)throw new Error("Credential creation options are required");if("undefined"!==typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=(0,A.__rest)(e,["challenge","user","excludeCredentials"]),s=Yt(t).buffer,i=Object.assign(Object.assign({},r),{id:Yt(r.id).buffer}),o=Object.assign(Object.assign({},a),{challenge:s,user:i});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let e=0;e<n.length;e++){const t=n[e];o.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:Yt(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return o}function Ur(e){if(!e)throw new Error("Credential request options are required");if("undefined"!==typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=(0,A.__rest)(e,["challenge","allowCredentials"]),a=Yt(t).buffer,s=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let e=0;e<r.length;e++){const t=r[e];s.allowCredentials[e]=Object.assign(Object.assign({},t),{id:Yt(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return s}function zr(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Jt(new Uint8Array(e.response.attestationObject)),clientDataJSON:Jt(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:null!==(t=r.authenticatorAttachment)&&void 0!==t?t:void 0}}function Br(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Jt(new Uint8Array(a.authenticatorData)),clientDataJSON:Jt(new Uint8Array(a.clientDataJSON)),signature:Jt(new Uint8Array(a.signature)),userHandle:a.userHandle?Jt(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:null!==(t=r.authenticatorAttachment)&&void 0!==t?t:void 0}}function Hr(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Wr(){var e,t;return!!(Xt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"===typeof(null===(e=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"===typeof(null===(t=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}const Vr={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},Gr={userVerification:"preferred",hints:["security-key"]};function qr(){const e=e=>null!==e&&"object"===typeof e&&!Array.isArray(e),t=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),r={};for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];for(const i of a)if(i)for(const n in i){const a=i[n];if(void 0!==a)if(Array.isArray(a))r[n]=a;else if(t(a))r[n]=a;else if(e(a)){const t=r[n];e(t)?r[n]=qr(t,a):r[n]=qr(a)}else r[n]=a}return r}class Kr{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge(e,t){let{factorId:r,webauthn:n,friendlyName:a,signal:s}=e;try{const{data:e,error:i}=await this.client.mfa.challenge({factorId:r,webauthn:n});if(!e)return{data:null,error:i};const o=null!==s&&void 0!==s?s:Mr.createNewAbortSignal();if("create"===e.webauthn.type){const{user:t}=e.webauthn.credential_options.publicKey;t.name||(t.name="".concat(t.id,":").concat(a)),t.displayName||(t.displayName=t.name)}switch(e.webauthn.type){case"create":{const n=function(e,t){return qr(Vr,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.create),{data:a,error:s}=await async function(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ir("Browser returned unexpected credential type",t)}:{data:null,error:new Ir("Empty credential response",t)}}catch(t){return{data:null,error:Dr({error:t,options:e})}}}({publicKey:n,signal:o});return a?{data:{factorId:r,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:a}},error:null}:{data:null,error:s}}case"request":{const n=function(e,t){return qr(Gr,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.request),{data:a,error:s}=await async function(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ir("Browser returned unexpected credential type",t)}:{data:null,error:new Ir("Empty credential response",t)}}catch(t){return{data:null,error:Lr({error:t,options:e})}}}(Object.assign(Object.assign({},e.webauthn.credential_options),{publicKey:n,signal:o}));return a?{data:{factorId:r,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:a}},error:null}:{data:null,error:s}}}}catch(i){return jt(i)?{data:null,error:i}:{data:null,error:new Ct("Unexpected error in challenge",i)}}}async _verify(e){let{challengeId:t,factorId:r,webauthn:n}=e;return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate(e,t){let{factorId:r,webauthn:{rpId:n=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:a=("undefined"!==typeof window?[window.location.origin]:void 0),signal:s}}=e;if(!n)return{data:null,error:new Nt("rpId is required for WebAuthn authentication")};try{if(!Wr())return{data:null,error:new Ct("Browser does not support WebAuthn",null)};const{data:e,error:i}=await this.challenge({factorId:r,webauthn:{rpId:n,rpOrigins:a},signal:s},{request:t});if(!e)return{data:null,error:i};const{webauthn:o}=e;return this._verify({factorId:r,challengeId:e.challengeId,webauthn:{type:o.type,rpId:n,rpOrigins:a,credential_response:o.credential_response}})}catch(i){return jt(i)?{data:null,error:i}:{data:null,error:new Ct("Unexpected error in authenticate",i)}}}async _register(e,t){let{friendlyName:r,rpId:n=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:a=("undefined"!==typeof window?[window.location.origin]:void 0),signal:s}=e;if(!n)return{data:null,error:new Nt("rpId is required for WebAuthn registration")};try{if(!Wr())return{data:null,error:new Ct("Browser does not support WebAuthn",null)};const{data:e,error:i}=await this._enroll({friendlyName:r});if(!e)return await this.client.mfa.listFactors().then(e=>{var t;return null===(t=e.data)||void 0===t?void 0:t.all.find(e=>"webauthn"===e.factor_type&&e.friendly_name===r&&"unverified"!==e.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null===e||void 0===e?void 0:e.id}):void 0),{data:null,error:i};const{data:o,error:l}=await this._challenge({factorId:e.id,friendlyName:e.friendly_name,webauthn:{rpId:n,rpOrigins:a},signal:s},{create:t});return o?this._verify({factorId:e.id,challengeId:o.challengeId,webauthn:{rpId:n,rpOrigins:a,type:o.webauthn.type,credential_response:o.webauthn.credential_response}}):{data:null,error:l}}catch(i){return jt(i)?{data:null,error:i}:{data:null,error:new Ct("Unexpected error in register",i)}}}}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const $r={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:_t,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Yr(e,t,r){return await r()}const Jr={};class Xr{get jwks(){var e,t;return null!==(t=null===(e=Jr[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){Jr[this.storageKey]=Object.assign(Object.assign({},Jr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=Jr[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Jr[this.storageKey]=Object.assign(Object.assign({},Jr[this.storageKey]),{cachedAt:e})}constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Xr.nextInstanceID,Xr.nextInstanceID+=1,this.instanceID>0&&Xt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},$r),e);if(this.logDebugMessages=!!n.debug,"function"===typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new kr({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=er(n.fetch),this.lock=n.lock||Yr,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Xt()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=Cr:this.lock=Yr,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Kr(this)},this.persistSession?(n.storage?this.storage=n.storage:Zt()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Tr(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Tr(this.memoryStorage)),Xt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.logger("GoTrueClient@".concat(this.instanceID," (").concat(xt,") ").concat((new Date).toISOString()),...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(n){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),Xt()&&this.detectSessionInUrl&&"none"!==r){const{data:n,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),function(e){return jt(e)&&"AuthImplicitGrantRedirectError"===e.name}(a)){const t=null===(e=a.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:a}}return await this._removeSession(),{error:a}}const{session:s,redirectType:i}=n;return this._debug("#_initialize()","detected session in URL",s,"redirect type",i),await this._saveSession(s),setTimeout(async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return jt(t)?{error:t}:{error:new Ct("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{const a=await vr(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!==(r=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:br}),{data:s,error:i}=a;if(i||!s)return{data:{user:null,session:null},error:i};const o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(a){if(jt(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,r,n;try{let a;if("email"in e){const{email:r,password:n,options:s}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await lr(this.storage,this.storageKey)),a=await vr(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null===s||void 0===s?void 0:s.emailRedirectTo,body:{email:r,password:n,data:null!==(t=null===s||void 0===s?void 0:s.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},code_challenge:i,code_challenge_method:o},xform:br})}else{if(!("phone"in e))throw new It("You must provide either an email or phone number and a password");{const{phone:t,password:s,options:i}=e;a=await vr(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:s,data:null!==(r=null===i||void 0===i?void 0:i.data)&&void 0!==r?r:{},channel:null!==(n=null===i||void 0===i?void 0:i.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:br})}}const{data:s,error:i}=a;if(i||!s)return{data:{user:null,session:null},error:i};const o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(a){if(jt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:n,options:a}=e;t=await vr(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:r,password:n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:yr})}else{if(!("phone"in e))throw new It("You must provide either an email or phone number and a password");{const{phone:r,password:n,options:a}=e;t=await vr(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:r,password:n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:yr})}}const{data:r,error:n}=t;return n?{data:{user:null,session:null},error:n}:r&&r.session&&r.user?(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n}):{data:{user:null,session:null},error:new Rt}}catch(t){if(jt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error('@supabase/auth-js: Unsupported chain "'.concat(t,'"'))}}async signInWithEthereum(e){var t,r,n,a,s,i,o,l,c,u,d;let h,f;if("message"in e)h=e.message,f=e.signature;else{const{chain:u,wallet:d,statement:m,options:p}=e;let g;if(Xt())if("object"===typeof d)g=d;else{const e=window;if(!("ethereum"in e)||"object"!==typeof e.ethereum||!("request"in e.ethereum)||"function"!==typeof e.ethereum.request)throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.");g=e.ethereum}else{if("object"!==typeof d||!(null===p||void 0===p?void 0:p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=d}const v=new URL(null!==(t=null===p||void 0===p?void 0:p.url)&&void 0!==t?t:window.location.href),b=await g.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!b||0===b.length)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const y=Or(b[0]);let x=null===(r=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===r?void 0:r.chainId;if(!x){const e=await g.request({method:"eth_chainId"});x=parseInt(e,16)}h=function(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:s=new Date,nonce:i,notBefore:o,requestId:l,resources:c,scheme:u,uri:d,version:h}=e;if(!Number.isInteger(r))throw new Error('@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: '.concat(r));if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error('@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: '.concat(i));if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==h)throw new Error("@supabase/auth-js: Invalid SIWE message field \"version\". Version must be '1'. Provided value: ".concat(h));if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw new Error("@supabase/auth-js: Invalid SIWE message field \"statement\". Statement must not include '\\n'. Provided value: ".concat(e.statement));const f=Or(e.address),m=u?"".concat(u,"://").concat(n):n,p=e.statement?"".concat(e.statement,"\n"):"",g="".concat(m," wants you to sign in with your Ethereum account:\n").concat(f,"\n\n").concat(p);let v="URI: ".concat(d,"\nVersion: ").concat(h,"\nChain ID: ").concat(r).concat(i?"\nNonce: ".concat(i):"","\nIssued At: ").concat(s.toISOString());if(a&&(v+="\nExpiration Time: ".concat(a.toISOString())),o&&(v+="\nNot Before: ".concat(o.toISOString())),l&&(v+="\nRequest ID: ".concat(l)),c){let e="\nResources:";for(const t of c){if(!t||"string"!==typeof t)throw new Error('@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: '.concat(t));e+="\n- ".concat(t)}v+=e}return"".concat(g,"\n").concat(v)}({domain:v.host,address:y,statement:m,uri:v.href,version:"1",chainId:x,nonce:null===(n=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===n?void 0:n.nonce,issuedAt:null!==(s=null===(a=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===a?void 0:a.issuedAt)&&void 0!==s?s:new Date,expirationTime:null===(i=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===i?void 0:i.expirationTime,notBefore:null===(o=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===o?void 0:o.notBefore,requestId:null===(l=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===l?void 0:l.requestId,resources:null===(c=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===c?void 0:c.resources}),f=await g.request({method:"personal_sign",params:[Pr(h),y]})}try{const{data:t,error:r}=await vr(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:f},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=e.options)||void 0===d?void 0:d.captchaToken}}:null),xform:br});if(r)throw r;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:r}):{data:{user:null,session:null},error:new Rt}}catch(m){if(jt(m))return{data:{user:null,session:null},error:m};throw m}}async signInWithSolana(e){var t,r,n,a,s,i,o,l,c,u,d,h;let f,m;if("message"in e)f=e.message,m=e.signature;else{const{chain:d,wallet:h,statement:p,options:g}=e;let v;if(Xt())if("object"===typeof h)v=h;else{const e=window;if(!("solana"in e)||"object"!==typeof e.solana||!("signIn"in e.solana&&"function"===typeof e.solana.signIn||"signMessage"in e.solana&&"function"===typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");v=e.solana}else{if("object"!==typeof h||!(null===g||void 0===g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=h}const b=new URL(null!==(t=null===g||void 0===g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in v&&v.signIn){const e=await v.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null===g||void 0===g?void 0:g.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),p?{statement:p}:null));let t;if(Array.isArray(e)&&e[0]&&"object"===typeof e[0])t=e[0];else{if(!(e&&"object"===typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"===typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");f="string"===typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),m=t.signature}else{if(!("signMessage"in v)||"function"!==typeof v.signMessage||!("publicKey"in v)||"object"!==typeof v||!v.publicKey||!("toBase58"in v.publicKey)||"function"!==typeof v.publicKey.toBase58)throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=["".concat(b.host," wants you to sign in with your Solana account:"),v.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1","URI: ".concat(b.href),"Issued At: ".concat(null!==(n=null===(r=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===r?void 0:r.issuedAt)&&void 0!==n?n:(new Date).toISOString()),...(null===(a=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===a?void 0:a.notBefore)?["Not Before: ".concat(g.signInWithSolana.notBefore)]:[],...(null===(s=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===s?void 0:s.expirationTime)?["Expiration Time: ".concat(g.signInWithSolana.expirationTime)]:[],...(null===(i=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===i?void 0:i.chainId)?["Chain ID: ".concat(g.signInWithSolana.chainId)]:[],...(null===(o=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===o?void 0:o.nonce)?["Nonce: ".concat(g.signInWithSolana.nonce)]:[],...(null===(l=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===l?void 0:l.requestId)?["Request ID: ".concat(g.signInWithSolana.requestId)]:[],...(null===(u=null===(c=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===u?void 0:u.length)?["Resources",...g.signInWithSolana.resources.map(e=>"- ".concat(e))]:[]].join("\n");const e=await v.signMessage((new TextEncoder).encode(f),"utf8");if(!e||!(e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=e}}try{const{data:t,error:r}=await vr(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:Jt(m)},(null===(d=e.options)||void 0===d?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:br});if(r)throw r;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:r}):{data:{user:null,session:null},error:new Rt}}catch(p){if(jt(p))return{data:{user:null,session:null},error:p};throw p}}async _exchangeCodeForSession(e){const t=await rr(this.storage,"".concat(this.storageKey,"-code-verifier")),[r,n]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:a}=await vr(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:br});if(await nr(this.storage,"".concat(this.storageKey,"-code-verifier")),a)throw a;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==n&&void 0!==n?n:null}),error:a}):{data:{user:null,session:null,redirectType:null},error:new Rt}}catch(a){if(jt(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:r,token:n,access_token:a,nonce:s}=e,i=await vr(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:r,id_token:n,access_token:a,nonce:s,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:br}),{data:o,error:l}=i;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new Rt}}catch(t){if(jt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,n,a,s;try{if("email"in e){const{email:n,options:a}=e;let s=null,i=null;"pkce"===this.flowType&&([s,i]=await lr(this.storage,this.storageKey));const{error:o}=await vr(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:n,data:null!==(t=null===a||void 0===a?void 0:a.data)&&void 0!==t?t:{},create_user:null===(r=null===a||void 0===a?void 0:a.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken},code_challenge:s,code_challenge_method:i},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:r}=e,{data:i,error:o}=await vr(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!==(n=null===r||void 0===r?void 0:r.data)&&void 0!==n?n:{},create_user:null===(a=null===r||void 0===r?void 0:r.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},channel:null!==(s=null===r||void 0===r?void 0:r.channel)&&void 0!==s?s:"sms"}});return{data:{user:null,session:null,messageId:null===i||void 0===i?void 0:i.message_id},error:o}}throw new It("You must provide either an email or phone number.")}catch(i){if(jt(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(e){var t,r;try{let n,a;"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,a=null===(r=e.options)||void 0===r?void 0:r.captchaToken);const{data:s,error:i}=await vr(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:br});if(i)throw i;if(!s)throw new Error("An error occurred on token verification.");const o=s.session,l=s.user;return(null===o||void 0===o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(n){if(jt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,r,n;try{let a=null,s=null;return"pkce"===this.flowType&&([a,s]=await lr(this.storage,this.storageKey)),await vr(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:s}),headers:this.headers,xform:wr})}catch(a){if(jt(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Pt;const{error:n}=await vr(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(jt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t="".concat(this.url,"/resend");if("email"in e){const{email:r,type:n,options:a}=e,{error:s}=await vr(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:s}}if("phone"in e){const{phone:r,type:n,options:a}=e,{data:s,error:i}=await vr(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:null===s||void 0===s?void 0:s.message_id},error:i}}throw new It("You must provide either an email or phone number and a type")}catch(t){if(jt(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock("lock:".concat(this.storageKey),e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await rr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=!!e.expires_at&&1e3*e.expires_at-Date.now()<St;if(this._debug("#__loadSession()","session has".concat(r?"":" not"," expired"),"expires_at",e.expires_at),!r){if(this.userStorage){const t=await rr(this.userStorage,this.storageKey+"-user");(null===t||void 0===t?void 0:t.user)?e.user=t.user:e.user=hr()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,n)=>(t||"user"!==r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,n))})}return{data:{session:e},error:null}}const{data:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await vr(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:xr}):await this._useSession(async e=>{var t,r,n;const{data:a,error:s}=e;if(s)throw s;return(null===(t=a.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await vr(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!==(n=null===(r=a.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0,xform:xr}):{data:{user:null},error:new Pt}})}catch(t){if(jt(t))return function(e){return jt(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await nr(this.storage,"".concat(this.storageKey,"-code-verifier"))),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession(async r=>{const{data:n,error:a}=r;if(a)throw a;if(!n.session)throw new Pt;const s=n.session;let i=null,o=null;"pkce"===this.flowType&&null!=e.email&&([i,o]=await lr(this.storage,this.storageKey));const{data:l,error:c}=await vr(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:o}),jwt:s.access_token,xform:xr});if(c)throw c;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(r){if(jt(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Pt;const t=Date.now()/1e3;let r=t,n=!0,a=null;const{payload:s}=sr(e.access_token);if(s.exp&&(r=s.exp,n=r<=t),n){const{data:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};a=t}else{const{data:n,error:s}=await this._getUser(e.access_token);if(s)throw s;a={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(jt(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:n,error:a}=t;if(a)throw a;e=null!==(r=n.session)&&void 0!==r?r:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new Pt;const{data:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(jt(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Xt())throw new Dt("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Dt(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Lt("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Dt("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Lt("No code detected.");const{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;const n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:a,refresh_token:s,expires_in:i,expires_at:o,token_type:l}=e;if(!a||!i||!s||!l)throw new Dt("No session defined in URL");const c=Math.round(Date.now()/1e3),u=parseInt(i);let d=c+u;o&&(d=parseInt(o));const h=d-c;1e3*h<=wt&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(h,"s, should have been closer to ").concat(u,"s"));const f=d-u;c-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,d,c):c-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,d,c);const{data:m,error:p}=await this._getUser(a);if(p)throw p;const g={provider_token:r,provider_refresh_token:n,access_token:a,expires_in:u,expires_at:d,refresh_token:s,token_type:l,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(r){if(jt(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await rr(this.storage,"".concat(this.storageKey,"-code-verifier"));return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession(async t=>{var r;const{data:n,error:a}=t;if(a)return{error:a};const s=null===(r=n.session)||void 0===r?void 0:r.access_token;if(s){const{error:t}=await this.admin.signOut(s,e);if(t&&(!function(e){return jt(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await nr(this.storage,"".concat(this.storageKey,"-code-verifier"))),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{const{data:{session:n},error:a}=t;if(a)throw a;await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(a){await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,n=null;"pkce"===this.flowType&&([r,n]=await lr(this.storage,this.storageKey,!0));try{return await vr(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(jt(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(jt(t))return{data:null,error:t};throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:n}=await this._useSession(async t=>{var r,n,a,s,i;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:!0});return await vr(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(s=o.session)||void 0===s?void 0:s.access_token)&&void 0!==i?i:void 0})});if(n)throw n;return Xt()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===r||void 0===r?void 0:r.url),{data:{provider:e.provider,url:null===r||void 0===r?void 0:r.url},error:null}}catch(r){if(jt(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:n,data:{session:a}}=t;if(n)throw n;const{options:s,provider:i,token:o,access_token:l,nonce:c}=e,u=await vr(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,jwt:null!==(r=null===a||void 0===a?void 0:a.access_token)&&void 0!==r?r:void 0,body:{provider:i,id_token:o,access_token:l,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken}},xform:br}),{data:d,error:h}=u;return h?{data:{user:null,session:null},error:h}:d&&d.session&&d.user?(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("USER_UPDATED",d.session)),{data:d,error:h}):{data:{user:null,session:null},error:new Rt}}catch(n){if(jt(n))return{data:{user:null,session:null},error:n};throw n}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;const{data:a,error:s}=t;if(s)throw s;return await vr(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:null!==(n=null===(r=a.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0})})}catch(t){if(jt(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const a=Date.now();return await(r=async r=>(r>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await vr(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:br})),n=(e,t)=>{const r=200*Math.pow(2,e);return t&&Ft(t)&&Date.now()+r-a<wt},new Promise((e,t)=>{(async()=>{for(let s=0;s<1/0;s++)try{const t=await r(s);if(!n(s,null,t))return void e(t)}catch(a){if(!n(s,a))return void t(a)}})()}))}catch(a){if(this._debug(t,"error",a),jt(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(t,"end")}var r,n}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Xt()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await rr(this.storage,this.storageKey);if(a&&this.userStorage){let t=await rr(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:a.user},await tr(this.userStorage,this.storageKey+"-user",t)),a.user=null!==(e=null===t||void 0===t?void 0:t.user)&&void 0!==e?e:hr()}else if(a&&!a.user&&!a.user){const e=await rr(this.storage,this.storageKey+"-user");e&&(null===e||void 0===e?void 0:e.user)?(a.user=e.user,await nr(this.storage,this.storageKey+"-user"),await tr(this.storage,this.storageKey,a)):a.user=hr()}if(this._debug(r,"session from storage",a),!this._isValidSession(a))return this._debug(r,"session is not valid"),void(null!==a&&await this._removeSession());const s=1e3*(null!==(t=a.expires_at)&&void 0!==t?t:1/0)-Date.now()<St;if(this._debug(r,"session has".concat(s?"":" not"," expired with margin of ").concat(St,"s")),s){if(this.autoRefreshToken&&a.refresh_token){const{error:e}=await this._callRefreshToken(a.refresh_token);e&&(console.error(e),Ft(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(a.user&&!0===a.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(a.access_token);!t&&(null===e||void 0===e?void 0:e.user)?(a.user=e.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(n){console.error("Error getting user data:",n),this._debug(r,"error getting user data, skipping SIGNED_IN notification",n)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){return this._debug(r,"error",a),void console.error(a)}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Pt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(n,"begin");try{this.refreshingDeferred=new ar;const{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new Pt;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const n={data:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(a){if(this._debug(n,"error",a),jt(a)){const e={data:null,error:a};return Ft(a)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n="#_notifyAllSubscribers(".concat(e,")");this._debug(n,"begin",t,"broadcast = ".concat(r));try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],a=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(a){n.push(a)}});if(await Promise.all(a),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await tr(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const n=fr(e);await tr(this.storage,this.storageKey,n)}else{const e=fr(t);await tr(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await nr(this.storage,this.storageKey),await nr(this.storage,this.storageKey+"-code-verifier"),await nr(this.storage,this.storageKey+"-user"),this.userStorage&&await nr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Xt()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),wt);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:r}}=e;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const n=Math.floor((1e3*r.expires_at-t)/wt);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(n," ticks, a tick lasts ").concat(wt,"ms, refresh threshold is ").concat(3," ticks")),n<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof jr))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Xt()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const n=["provider=".concat(encodeURIComponent(t))];if((null===r||void 0===r?void 0:r.redirectTo)&&n.push("redirect_to=".concat(encodeURIComponent(r.redirectTo))),(null===r||void 0===r?void 0:r.scopes)&&n.push("scopes=".concat(encodeURIComponent(r.scopes))),"pkce"===this.flowType){const[e,t]=await lr(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(e)),code_challenge_method:"".concat(encodeURIComponent(t))});n.push(r.toString())}if(null===r||void 0===r?void 0:r.queryParams){const e=new URLSearchParams(r.queryParams);n.push(e.toString())}return(null===r||void 0===r?void 0:r.skipBrowserRedirect)&&n.push("skip_http_redirect=".concat(r.skipBrowserRedirect)),"".concat(e,"?").concat(n.join("&"))}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:n,error:a}=t;return a?{data:null,error:a}:await vr(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null===(r=null===n||void 0===n?void 0:n.session)||void 0===r?void 0:r.access_token})})}catch(t){if(jt(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;const{data:a,error:s}=t;if(s)return{data:null,error:s};const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:o,error:l}=await vr(this.fetch,"POST","".concat(this.url,"/factors"),{body:i,headers:this.headers,jwt:null===(r=null===a||void 0===a?void 0:a.session)||void 0===r?void 0:r.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&"totp"===o.type&&(null===(n=null===o||void 0===o?void 0:o.totp)||void 0===n?void 0:n.qr_code)&&(o.totp.qr_code="data:image/svg+xml;utf-8,".concat(o.totp.qr_code)),{data:o,error:null})})}catch(t){if(jt(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:a}=t;if(a)return{data:null,error:a};const s=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?zr(e.webauthn.credential_response):Br(e.webauthn.credential_response)})}:{code:e.code}),{data:i,error:o}=await vr(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:s,headers:this.headers,jwt:null===(r=null===n||void 0===n?void 0:n.session)||void 0===r?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(t){if(jt(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:a}=t;if(a)return{data:null,error:a};const s=await vr(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:e,headers:this.headers,jwt:null===(r=null===n||void 0===n?void 0:n.session)||void 0===r?void 0:r.access_token});if(s.error)return s;const{data:i}=s;if("webauthn"!==i.type)return{data:i,error:null};switch(i.webauthn.type){case"create":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:Fr(i.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:Ur(i.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(jt(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n={all:[],phone:[],totp:[],webauthn:[]};for(const a of null!==(e=null===t||void 0===t?void 0:t.factors)&&void 0!==e?e:[])n.all.push(a),"verified"===a.status&&n[a.factor_type].push(a);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:n},error:a}=e;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=sr(n.access_token);let i=null;s.aal&&(i=s.aal);let o=i;(null!==(r=null===(t=n.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(o="aal2");return{data:{currentLevel:i,nextLevel:o,currentAuthenticationMethods:s.amr||[]},error:null}}))}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find(t=>t.kid===e);if(t)return t;const r=Date.now();if(t=this.jwks.keys.find(t=>t.kid===e),t&&this.jwks_cached_at+6e5>r)return t;const{data:n,error:a}=await vr(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(a)throw a;return n.keys&&0!==n.keys.length?(this.jwks=n,this.jwks_cached_at=r,t=n.keys.find(t=>t.kid===e),t||null):null}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=e;if(!r){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};r=e.session.access_token}const{header:n,payload:a,signature:s,raw:{header:i,payload:o}}=sr(r);(null===t||void 0===t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(a.exp);const l=n.alg&&!n.alg.startsWith("HS")&&n.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(n.kid,(null===t||void 0===t?void 0:t.keys)?{keys:t.keys}:null===t||void 0===t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:a,header:n,signature:s},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(n.alg),u=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,u,s,function(e){const t=[];return $t(e,e=>t.push(e)),new Uint8Array(t)}("".concat(i,".").concat(o))))throw new zt("Invalid JWT signature");return{data:{claims:a,header:n,signature:s},error:null}}catch(r){if(jt(r))return{data:null,error:r};throw r}}}Xr.nextInstanceID=0;const Qr=Xr;class Zr extends Qr{constructor(e){super(e)}}class en{constructor(e,t,r){var n,a,s;this.supabaseUrl=e,this.supabaseKey=t;const i=function(e){const t=null===e||void 0===e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((r=t).endsWith("/")?r:r+"/")}catch(n){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var r}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o="sb-".concat(i.hostname.split(".")[0],"-auth-token"),l=function(e,t){var r,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:l,auth:c,realtime:u,global:d}=t,h={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),i),storage:{},global:Object.assign(Object.assign(Object.assign({},d),o),{headers:Object.assign(Object.assign({},null!==(r=null===d||void 0===d?void 0:d.headers)&&void 0!==r?r:{}),null!==(n=null===o||void 0===o?void 0:o.headers)&&void 0!==n?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!==r&&void 0!==r?r:{},{db:mt,realtime:gt,auth:Object.assign(Object.assign({},pt),{storageKey:o}),global:ft});this.storageKey=null!==(n=l.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(a=l.global.headers)&&void 0!==a?a:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(t)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!==(s=l.auth)&&void 0!==s?s:{},this.headers,l.global.fetch),this.fetch=yt(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new M(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new dt(this.storageUrl.href,this.headers,this.fetch,null===r||void 0===r?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new D(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{head:!1,get:!1,count:void 0};return this.rest.rpc(e,t,r)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:r}=await this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey}_initSupabaseAuthClient(e,t,r){let{autoRefreshToken:n,persistSession:a,detectSessionInUrl:s,storage:i,userStorage:o,storageKey:l,flowType:c,lock:u,debug:d}=e;const h={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new Zr({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),t),storageKey:l,autoRefreshToken:n,persistSession:a,detectSessionInUrl:s,storage:i,userStorage:o,flowType:c,lock:u,debug:d,fetch:r,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new _e(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=r,this.realtime.setAuth(r))}}(function(){if("undefined"!==typeof window)return!1;if("undefined"===typeof process)return!1;const e=process.version;if(void 0===e||null===e)return!1;const t=e.match(/^v(\d+)\./);return!!t&&parseInt(t[1],10)<=18})()&&console.warn("\u26a0\ufe0f  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const tn=((e,t,r)=>new en(e,t,r))("https://didqjsfsqysndyirrjpq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRpZHFqc2ZzcXlzbmR5aXJyanBxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjExNjQ0ODAsImV4cCI6MjA3Njc0MDQ4MH0.hJJqPgJiJPJNmgv8fhNIpmeV1N2NhR6nH5t0oiheiNc");function rn(e){let{onLogin:t}=e;const[r,a]=(0,n.useState)("admin"),[s,i]=(0,n.useState)(""),[o,l]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[d,h]=(0,n.useState)(""),[f,m]=(0,n.useState)(""),[p,g]=(0,n.useState)(!1);return(0,E.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 p-4",children:(0,E.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden",children:[(0,E.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 p-8 text-center",children:[(0,E.jsx)("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:(0,E.jsx)(w,{className:"w-10 h-10 text-indigo-600"})}),(0,E.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Exam Portal"}),(0,E.jsx)("p",{className:"text-indigo-100",children:"Welcome back! Please login to continue"})]}),(0,E.jsxs)("div",{className:"p-8",children:[(0,E.jsxs)("div",{className:"flex mb-6 bg-gray-100 rounded-lg p-1",children:[(0,E.jsx)("button",{onClick:()=>a("admin"),className:"flex-1 py-2 px-4 rounded-md font-medium transition ".concat("admin"===r?"bg-white text-indigo-600 shadow":"text-gray-600 hover:text-gray-800"),children:"Admin Login"}),(0,E.jsx)("button",{onClick:()=>a("student"),className:"flex-1 py-2 px-4 rounded-md font-medium transition ".concat("student"===r?"bg-white text-indigo-600 shadow":"text-gray-600 hover:text-gray-800"),children:"Student Login"})]}),f&&(0,E.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-600 text-sm flex items-center",children:[(0,E.jsx)(j,{className:"w-4 h-4 mr-2"}),f]}),"admin"===r?(0,E.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),m(""),g(!0),setTimeout(()=>{"venu"===s&&"Lion@2004"===o?t({username:"venu",name:"Admin Venu"},"admin"):m("Invalid admin credentials"),g(!1)},500)},className:"space-y-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),(0,E.jsx)("input",{type:"text",value:s,onChange:e=>i(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Enter username",required:!0})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,E.jsx)("input",{type:"password",value:o,onChange:e=>l(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Enter password",required:!0})]}),(0,E.jsx)("button",{type:"submit",disabled:p,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 rounded-lg font-medium hover:from-indigo-700 hover:to-purple-700 transition disabled:opacity-50",children:p?"Logging in...":"Login as Admin"})]}):(0,E.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),m(""),g(!0);try{const{data:e,error:r}=await tn.from("students").select("*").eq("email",c).single();if(r||!e)return m("Student not found. Please contact admin."),void g(!1);e.password===d?t({id:e.id,email:c,name:e.name,mobile:e.mobile},"student"):m("Invalid password")}catch(r){m("Login failed: "+r.message)}g(!1)},className:"space-y-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,E.jsx)("input",{type:"email",value:c,onChange:e=>u(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Enter your email",required:!0})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,E.jsx)("input",{type:"password",value:d,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Enter your password",required:!0})]}),(0,E.jsx)("button",{type:"submit",disabled:p,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 rounded-lg font-medium hover:from-indigo-700 hover:to-purple-700 transition disabled:opacity-50",children:p?"Logging in...":"Login as Student"})]})]}),(0,E.jsx)("div",{className:"bg-gray-50 px-8 py-4 text-center text-sm text-gray-600",children:(0,E.jsxs)("p",{children:["Developed by ",(0,E.jsx)("span",{className:"font-semibold text-indigo-600",children:"Gaddam Venu"})]})})]})})}const nn=function(e){let{onNavigate:t,onLogin:r}=e;const[a,s]=(0,n.useState)({email:"",password:""}),[i,o]=(0,n.useState)(!1);return(0,E.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-indigo-50 flex items-center justify-center p-4",children:(0,E.jsxs)("div",{className:"max-w-md w-full",children:[(0,E.jsxs)("div",{className:"text-center mb-8",children:[(0,E.jsx)(S,{className:"w-16 h-16 text-purple-600 mx-auto mb-4"}),(0,E.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Sign In"}),(0,E.jsx)("p",{className:"text-gray-600",children:"Access your courses"})]}),(0,E.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[(0,E.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),o(!0);try{const{data:e,error:t}=await tn.from("users").select("*").eq("email",a.email).single();if(t){if("PGRST116"!==t.code)throw t;return alert("No account found! Please sign up first."),void o(!1)}if(!e)return alert("No account found! Please sign up first."),void o(!1);if(e.password!==a.password)return alert("Invalid email or password!"),void o(!1);alert("Welcome back, ".concat(e.full_name,"!")),r&&r({id:e.id,fullName:e.full_name,email:e.email})}catch(t){console.error("Login error:",t),alert("Error: "+t.message)}finally{o(!1)}},className:"space-y-6",children:[(0,E.jsx)("input",{type:"email",placeholder:"Email",required:!0,value:a.email,onChange:e=>s(c(c({},a),{},{email:e.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none",disabled:i}),(0,E.jsx)("input",{type:"password",placeholder:"Password",required:!0,value:a.password,onChange:e=>s(c(c({},a),{},{password:e.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none",disabled:i}),(0,E.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,E.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-purple-600",disabled:i}),(0,E.jsx)("span",{className:"text-gray-600 text-sm",children:"Remember me"})]}),(0,E.jsx)("button",{type:"submit",disabled:i,className:"w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Signing In...":"Sign In"})]}),(0,E.jsxs)("p",{className:"mt-4 text-center text-gray-600",children:["Forgot password?"," ",(0,E.jsx)("button",{type:"button",onClick:()=>t("forgot-password"),className:"text-purple-600 font-semibold hover:text-purple-700",disabled:i,children:"Reset"})]}),(0,E.jsxs)("p",{className:"mt-4 text-center text-gray-600",children:["Don't have an account?"," ",(0,E.jsx)("button",{type:"button",onClick:()=>t("course-signup"),className:"text-purple-600 font-semibold hover:text-purple-700",disabled:i,children:"Sign Up"})]}),(0,E.jsx)("button",{type:"button",onClick:()=>t("portal-selector"),className:"w-full mt-4 text-gray-600 py-2 hover:text-purple-600 transition",disabled:i,children:"\u2190 Back to Portal Selection"})]})]})})},an=v("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);const sn=function(e){let{onNavigate:t}=e;const[r,a]=(0,n.useState)({fullName:"",email:"",password:"",confirmPassword:""}),[s,i]=(0,n.useState)(!1);return(0,E.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-indigo-50 flex items-center justify-center p-4",children:(0,E.jsxs)("div",{className:"max-w-md w-full",children:[(0,E.jsxs)("div",{className:"text-center mb-8",children:[(0,E.jsx)(an,{className:"w-16 h-16 text-purple-600 mx-auto mb-4"}),(0,E.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Sign Up"}),(0,E.jsx)("p",{className:"text-gray-600",children:"Create your account to access courses"})]}),(0,E.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[(0,E.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),r.password===r.confirmPassword)if(r.password.length<6)alert("Password must be at least 6 characters long!");else{i(!0);try{const{data:e,error:n}=await tn.from("users").select("*").eq("email",r.email);if(n)throw n;if(e&&e.length>0)return alert("An account with this email already exists!"),void i(!1);const{error:a}=await tn.from("users").insert([{full_name:r.fullName,email:r.email,password:r.password}]).select();if(a)throw a;alert("Registration successful! Please sign in."),t("course-login")}catch(n){console.error("Signup error:",n),alert("Error: "+n.message)}finally{i(!1)}}else alert("Passwords do not match!")},className:"space-y-5",children:[(0,E.jsx)("input",{type:"text",placeholder:"Full Name",required:!0,value:r.fullName,onChange:e=>a(c(c({},r),{},{fullName:e.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none",disabled:s}),(0,E.jsx)("input",{type:"email",placeholder:"Email",required:!0,value:r.email,onChange:e=>a(c(c({},r),{},{email:e.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none",disabled:s}),(0,E.jsx)("input",{type:"password",placeholder:"Password",required:!0,minLength:"6",value:r.password,onChange:e=>a(c(c({},r),{},{password:e.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none",disabled:s}),(0,E.jsx)("input",{type:"password",placeholder:"Confirm Password",required:!0,value:r.confirmPassword,onChange:e=>a(c(c({},r),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none",disabled:s}),(0,E.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,E.jsx)("input",{type:"checkbox",required:!0,className:"w-4 h-4 text-purple-600",disabled:s}),(0,E.jsx)("span",{className:"text-gray-600 text-sm",children:"I agree to Terms & Privacy"})]}),(0,E.jsx)("button",{type:"submit",disabled:s,className:"w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Creating Account...":"Sign Up"})]}),(0,E.jsxs)("p",{className:"mt-6 text-center text-gray-600",children:["Already have an account?"," ",(0,E.jsx)("button",{type:"button",onClick:()=>t("course-login"),className:"text-purple-600 font-semibold hover:text-purple-700",disabled:s,children:"Sign In"})]}),(0,E.jsx)("button",{type:"button",onClick:()=>t("portal-selector"),className:"w-full mt-4 text-gray-600 py-2 hover:text-purple-600 transition",disabled:s,children:"\u2190 Back to Portal Selection"})]})]})})},on=v("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);const ln=function(e){let{onNavigate:t}=e;const[r,a]=(0,n.useState)("email"),[s,i]=(0,n.useState)(""),[o,l]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[d,h]=(0,n.useState)(!1),f=async e=>{if(e.preventDefault(),o===c)if(o.length<6)alert("Password must be at least 6 characters long!");else{h(!0);try{const{error:e}=await tn.from("users").update({password:o}).eq("email",s);if(e)throw e;alert("Password reset successful! Please sign in with your new password."),t("course-login")}catch(r){console.error("Password reset error:",r),alert("Error: "+r.message)}finally{h(!1)}}else alert("Passwords do not match!")};return"reset"===r?(0,E.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-indigo-50 flex items-center justify-center p-4",children:(0,E.jsxs)("div",{className:"max-w-md w-full",children:[(0,E.jsxs)("div",{className:"text-center mb-8",children:[(0,E.jsx)(x,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),(0,E.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Reset Password"}),(0,E.jsx)("p",{className:"text-gray-600",children:"Enter your new password"}),(0,E.jsxs)("p",{className:"text-sm text-purple-600 mt-2",children:["Account: ",s]})]}),(0,E.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[(0,E.jsxs)("form",{onSubmit:f,className:"space-y-6",children:[(0,E.jsx)("input",{type:"password",placeholder:"New Password",required:!0,minLength:"6",value:o,onChange:e=>l(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none",disabled:d}),(0,E.jsx)("input",{type:"password",placeholder:"Confirm New Password",required:!0,value:c,onChange:e=>u(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none",disabled:d}),(0,E.jsx)("button",{type:"submit",disabled:d,className:"w-full bg-purple-600 text-white py-4 rounded-lg font-semibold hover:bg-purple-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Resetting Password...":"Reset Password"})]}),(0,E.jsx)("button",{type:"button",onClick:()=>{a("email"),l(""),u("")},className:"w-full mt-4 text-gray-600 py-2 hover:text-purple-600 transition",disabled:d,children:"\u2190 Back to Email Verification"})]})]})}):(0,E.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-indigo-50 flex items-center justify-center p-4",children:(0,E.jsxs)("div",{className:"max-w-md w-full",children:[(0,E.jsxs)("div",{className:"text-center mb-8",children:[(0,E.jsx)(on,{className:"w-16 h-16 text-purple-600 mx-auto mb-4"}),(0,E.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Forgot Password"}),(0,E.jsx)("p",{className:"text-gray-600",children:"Enter your email to reset your password"})]}),(0,E.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[(0,E.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),h(!0);try{const{data:e,error:t}=await tn.from("users").select("*").eq("email",s).single();if(t){if("PGRST116"!==t.code)throw t;return alert("No account found with this email address!"),void h(!1)}if(!e)return alert("No account found with this email address!"),void h(!1);a("reset")}catch(t){console.error("Email verification error:",t),alert("Error: "+t.message)}finally{h(!1)}},className:"space-y-6",children:[(0,E.jsx)("input",{type:"email",placeholder:"Email",required:!0,value:s,onChange:e=>i(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none",disabled:d}),(0,E.jsx)("button",{type:"submit",disabled:d,className:"w-full bg-purple-600 text-white py-4 rounded-lg font-semibold hover:bg-purple-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Verifying Email...":"Continue"})]}),(0,E.jsx)("button",{type:"button",onClick:()=>t("course-login"),className:"w-full mt-4 text-gray-600 py-2 hover:text-purple-600 transition",disabled:d,children:"\u2190 Back to Sign In"})]})]})})},cn=v("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),un=v("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),dn=v("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),hn=v("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);function fn(e){var t;let{user:r,userType:n,activeTab:a,setActiveTab:s,onLogout:i}=e;const o="student"===n?[{id:"dashboard",label:"Dashboard",icon:cn},{id:"attendance",label:"Attendance",icon:_},{id:"exam",label:"Exams",icon:w}]:[{id:"dashboard",label:"Dashboard",icon:cn},{id:"students",label:"Students",icon:an},{id:"attendance",label:"Attendance",icon:_},{id:"exam",label:"Exams",icon:w},{id:"enrollments",label:"Enrollments",icon:un},{id:"announcements",label:"Announcements",icon:dn}];return(0,E.jsx)("header",{className:"bg-green-600/90 backdrop-blur-md shadow-md sticky top-0 z-40 border-b border-green-200 transition-all duration-300",children:(0,E.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-3 cursor-pointer group",onClick:()=>s("dashboard"),title:"Go to Dashboard",children:[(0,E.jsxs)("div",{className:"relative w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center shadow-md group-hover:scale-110 transition-all duration-300",children:[(0,E.jsx)("span",{className:"text-white font-bold text-xl animate-pulse",children:"S"}),(0,E.jsx)("div",{className:"absolute inset-0 rounded-xl bg-green-300/30 opacity-0 group-hover:opacity-100 blur-sm transition"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("h1",{className:"text-xl font-extrabold text-white group-hover:text-yellow-200 transition duration-300 tracking-tight",children:"NextGen Portal"}),(0,E.jsx)("p",{className:"text-xs text-green-100 font-medium tracking-wide",children:"admin"===n?"Venu App":"Student Pannel"})]})]}),(0,E.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,E.jsxs)("div",{className:"hidden md:flex items-center space-x-3 bg-white/10 px-4 py-2 rounded-xl shadow-inner hover:shadow-lg transition-all duration-300 border border-white/20",children:[(0,E.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center shadow-inner",children:(0,E.jsx)("span",{className:"text-white font-semibold text-sm",children:null===(t=r.name)||void 0===t?void 0:t.charAt(0).toUpperCase()})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-sm font-semibold text-white",children:r.name}),(0,E.jsx)("p",{className:"text-xs text-green-100",children:r.email})]})]}),(0,E.jsxs)("button",{onClick:i,className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-red-500 to-rose-600 text-white rounded-xl hover:from-red-600 hover:to-rose-700 shadow-md hover:shadow-lg transition-all duration-300 transform hover:-translate-y-0.5",title:"Logout",children:[(0,E.jsx)(hn,{className:"w-4 h-4"}),(0,E.jsx)("span",{className:"hidden md:inline font-medium",children:"Logout"})]})]})]}),(0,E.jsx)("nav",{className:"flex space-x-3 overflow-x-auto pb-3 mt-2 scrollbar-thin scrollbar-thumb-green-300 scrollbar-track-transparent",children:o.map(e=>{const t=e.icon,r=a===e.id;return(0,E.jsxs)("button",{onClick:()=>s(e.id),className:"flex items-center space-x-2 px-5 py-2 rounded-xl font-semibold text-sm transition-all duration-300 whitespace-nowrap ".concat(r?"bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-lg scale-105":"bg-white/90 text-gray-700 hover:bg-green-50 hover:text-green-700 hover:scale-105"),children:[(0,E.jsx)(t,{className:"w-4 h-4 ".concat(r?"text-white":"text-gray-600")}),(0,E.jsx)("span",{children:e.label})]},e.id)})})]})})}function mn(){return(0,E.jsxs)("footer",{className:"bg-gray-900 text-white py-8 mt-auto shadow-inner",children:[(0,E.jsxs)("div",{className:"max-w-7xl mx-auto px-4 text-center space-y-2",children:[(0,E.jsxs)("p",{className:"text-lg md:text-xl font-medium text-indigo-400 hover:text-purple-400 transition duration-300 cursor-pointer",children:["Developed by ",(0,E.jsx)("span",{className:"font-bold text-pink-400 hover:text-indigo-300 transition",children:"Gaddam Venu"})]}),(0,E.jsxs)("p",{className:"text-sm md:text-base text-gray-300 mt-1",children:["\xa9 ",(new Date).getFullYear()," Exam Portal. All rights reserved."]})]}),(0,E.jsx)("div",{className:"mt-4 h-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 rounded-full w-1/2 mx-auto"})]})}const pn=v("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),gn=v("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),vn=v("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),bn=v("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),yn=v("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),xn=v("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),wn=v("key-round",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]),Sn=v("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),_n=v("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);function En(e){let{students:t,onRefresh:r}=e;const[a,s]=(0,n.useState)(!1),[i,o]=(0,n.useState)(!1),[l,u]=(0,n.useState)(null),[d,h]=(0,n.useState)(""),[f,m]=(0,n.useState)(!1),[p,g]=(0,n.useState)({name:"",email:"",mobile:"",password:""}),v=()=>{g({name:"",email:"",mobile:"",password:""})},b=()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let r=0;r<8;r++)t+=e.charAt(Math.floor(62*Math.random()));return t},y=()=>{o(!1),u(null),v()},x=()=>{s(!1),v()},w=t.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.email.toLowerCase().includes(d.toLowerCase())||e.mobile.includes(d));return(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-lg shadow-lg p-6 text-white",children:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsx)("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:(0,E.jsx)(an,{className:"w-6 h-6"})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("h1",{className:"text-2xl font-bold",children:"Student Management"}),(0,E.jsx)("p",{className:"text-blue-100 text-sm",children:"Add, edit, and manage student accounts"})]})]}),(0,E.jsxs)("div",{className:"bg-white bg-opacity-20 px-4 py-2 rounded-lg",children:[(0,E.jsx)("p",{className:"text-xs text-blue-100",children:"Total Students"}),(0,E.jsx)("p",{className:"text-3xl font-bold",children:t.length})]})]})}),(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[(0,E.jsx)("div",{className:"flex-1 max-w-md",children:(0,E.jsxs)("div",{className:"relative",children:[(0,E.jsx)(gn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,E.jsx)("input",{type:"text",placeholder:"Search by name, email, or mobile...",value:d,onChange:e=>h(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})}),(0,E.jsxs)("div",{className:"flex space-x-2",children:[(0,E.jsxs)("button",{onClick:()=>{const e=[["S.No","Name","Email","Mobile","Password"].join(","),...t.map((e,t)=>[t+1,e.name,e.email,e.mobile,e.password].join(","))].join("\n"),r=new Blob([e],{type:"text/csv"}),n=window.URL.createObjectURL(r),a=document.createElement("a");a.href=n,a.download="students_".concat((new Date).toISOString().split("T")[0],".csv"),a.click()},disabled:0===t.length,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition shadow-md disabled:bg-gray-400 disabled:cursor-not-allowed",children:[(0,E.jsx)(vn,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Export"})]}),(0,E.jsxs)("button",{onClick:()=>s(!0),className:"flex items-center space-x-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition shadow-md",children:[(0,E.jsx)(bn,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Add Student"})]})]})]}),a&&(0,E.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,E.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 p-6 text-white relative",children:[(0,E.jsx)("button",{onClick:x,className:"absolute top-4 right-4 text-white hover:bg-white hover:bg-opacity-20 rounded-full p-1",children:(0,E.jsx)(yn,{className:"w-5 h-5"})}),(0,E.jsxs)("h3",{className:"text-2xl font-bold flex items-center",children:[(0,E.jsx)(bn,{className:"w-6 h-6 mr-2"}),"Add New Student"]}),(0,E.jsx)("p",{className:"text-indigo-100 text-sm mt-1",children:"Enter student details"})]}),(0,E.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!p.name.trim()||!p.email.trim()||!p.mobile.trim()||!p.password.trim())return void alert("Please fill all fields");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(p.email))return void alert("Please enter a valid email address");if(/^[0-9]{10}$/.test(p.mobile)){m(!0);try{const{error:e}=await tn.from("students").insert([{name:p.name.trim(),email:p.email.trim().toLowerCase(),mobile:p.mobile.trim(),password:p.password.trim()}]);if(e){if("23505"!==e.code)throw e;return void alert("\u274c A student with this email already exists")}alert("\u2705 Student added successfully!"),v(),s(!1),r()}catch(t){console.error("Error adding student:",t),alert("\u274c Error adding student: "+t.message)}finally{m(!1)}}else alert("Please enter a valid 10-digit mobile number")},className:"p-6 space-y-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),(0,E.jsx)("input",{type:"text",placeholder:"Enter full name",value:p.name,onChange:e=>g(c(c({},p),{},{name:e.target.value})),disabled:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100",maxLength:"100"})]}),(0,E.jsxs)("div",{children:[(0,E.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,E.jsx)(on,{className:"w-4 h-4 mr-1"}),"Email Address *"]}),(0,E.jsx)("input",{type:"email",placeholder:"student@example.com",value:p.email,onChange:e=>g(c(c({},p),{},{email:e.target.value})),disabled:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100"})]}),(0,E.jsxs)("div",{children:[(0,E.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,E.jsx)(xn,{className:"w-4 h-4 mr-1"}),"Mobile Number *"]}),(0,E.jsx)("input",{type:"tel",placeholder:"10-digit mobile number",value:p.mobile,onChange:e=>g(c(c({},p),{},{mobile:e.target.value.replace(/\D/g,"").slice(0,10)})),disabled:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100",maxLength:"10"})]}),(0,E.jsxs)("div",{children:[(0,E.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,E.jsx)(wn,{className:"w-4 h-4 mr-1"}),"Password *"]}),(0,E.jsxs)("div",{className:"flex space-x-2",children:[(0,E.jsx)("input",{type:"text",placeholder:"Enter password",value:p.password,onChange:e=>g(c(c({},p),{},{password:e.target.value})),disabled:f,className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100"}),(0,E.jsx)("button",{type:"button",onClick:()=>g(c(c({},p),{},{password:b()})),disabled:f,className:"px-4 py-3 bg-indigo-100 text-indigo-600 rounded-lg hover:bg-indigo-200 disabled:opacity-50 transition font-bold",title:"Generate password",children:"\ud83d\udd04"})]}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Student will use this to login"})]}),(0,E.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,E.jsxs)("button",{type:"submit",disabled:f,className:"flex-1 flex items-center justify-center space-x-2 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition disabled:bg-gray-400 disabled:cursor-not-allowed font-medium",children:[f&&(0,E.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,E.jsx)(bn,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:f?"Adding...":"Add Student"})]}),(0,E.jsx)("button",{type:"button",onClick:x,disabled:f,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium disabled:opacity-50",children:"Cancel"})]})]})]})}),i&&l&&(0,E.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,E.jsxs)("div",{className:"bg-gradient-to-r from-green-600 to-teal-600 p-6 text-white relative",children:[(0,E.jsx)("button",{onClick:y,className:"absolute top-4 right-4 text-white hover:bg-white hover:bg-opacity-20 rounded-full p-1",children:(0,E.jsx)(yn,{className:"w-5 h-5"})}),(0,E.jsxs)("h3",{className:"text-2xl font-bold flex items-center",children:[(0,E.jsx)(Sn,{className:"w-6 h-6 mr-2"}),"Edit Student"]}),(0,E.jsx)("p",{className:"text-green-100 text-sm mt-1",children:"Update student details"})]}),(0,E.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!p.name.trim()||!p.email.trim()||!p.mobile.trim())return void alert("Please fill all required fields");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(p.email))return void alert("Please enter a valid email address");if(/^[0-9]{10}$/.test(p.mobile)){m(!0);try{const e={name:p.name.trim(),email:p.email.trim().toLowerCase(),mobile:p.mobile.trim()};p.password.trim()&&(e.password=p.password.trim());const{error:t}=await tn.from("students").update(e).eq("id",l.id);if(t)throw t;alert("\u2705 Student updated successfully!"),v(),o(!1),u(null),r()}catch(t){console.error("Error updating student:",t),alert("\u274c Error updating student: "+t.message)}finally{m(!1)}}else alert("Please enter a valid 10-digit mobile number")},className:"p-6 space-y-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),(0,E.jsx)("input",{type:"text",placeholder:"Enter full name",value:p.name,onChange:e=>g(c(c({},p),{},{name:e.target.value})),disabled:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 disabled:bg-gray-100",maxLength:"100"})]}),(0,E.jsxs)("div",{children:[(0,E.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,E.jsx)(on,{className:"w-4 h-4 mr-1"}),"Email Address *"]}),(0,E.jsx)("input",{type:"email",placeholder:"student@example.com",value:p.email,onChange:e=>g(c(c({},p),{},{email:e.target.value})),disabled:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 disabled:bg-gray-100"})]}),(0,E.jsxs)("div",{children:[(0,E.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,E.jsx)(xn,{className:"w-4 h-4 mr-1"}),"Mobile Number *"]}),(0,E.jsx)("input",{type:"tel",placeholder:"10-digit mobile number",value:p.mobile,onChange:e=>g(c(c({},p),{},{mobile:e.target.value.replace(/\D/g,"").slice(0,10)})),disabled:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 disabled:bg-gray-100",maxLength:"10"})]}),(0,E.jsxs)("div",{children:[(0,E.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,E.jsx)(wn,{className:"w-4 h-4 mr-1"}),"New Password (optional)"]}),(0,E.jsxs)("div",{className:"flex space-x-2",children:[(0,E.jsx)("input",{type:"text",placeholder:"Leave blank to keep current password",value:p.password,onChange:e=>g(c(c({},p),{},{password:e.target.value})),disabled:f,className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 disabled:bg-gray-100"}),(0,E.jsx)("button",{type:"button",onClick:()=>g(c(c({},p),{},{password:b()})),disabled:f,className:"px-4 py-3 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 disabled:opacity-50 transition font-bold",title:"Generate password",children:"\ud83d\udd04"})]}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Only fill if you want to change the password"})]}),(0,E.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,E.jsxs)("button",{type:"submit",disabled:f,className:"flex-1 flex items-center justify-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:bg-gray-400 disabled:cursor-not-allowed font-medium",children:[f&&(0,E.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,E.jsx)(Sn,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:f?"Updating...":"Update Student"})]}),(0,E.jsx)("button",{type:"button",onClick:y,disabled:f,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium disabled:opacity-50",children:"Cancel"})]})]})]})}),(0,E.jsx)("div",{className:"space-y-4",children:0===w.length?(0,E.jsxs)("div",{className:"text-center py-16",children:[(0,E.jsx)("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,E.jsx)(an,{className:"w-10 h-10 text-gray-400"})}),(0,E.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:d?"No students found":"No Students Yet"}),(0,E.jsx)("p",{className:"text-gray-500 mb-4",children:d?"Try a different search term":"Add your first student to get started"}),!d&&(0,E.jsxs)("button",{onClick:()=>s(!0),className:"inline-flex items-center space-x-2 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition",children:[(0,E.jsx)(bn,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Add Student"})]})]}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{className:"overflow-x-auto",children:(0,E.jsxs)("table",{className:"w-full",children:[(0,E.jsx)("thead",{className:"bg-gray-50 border-b-2 border-gray-200",children:(0,E.jsxs)("tr",{children:[(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mobile"}),(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Password"}),(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,E.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map((e,t)=>(0,E.jsxs)("tr",{className:"hover:bg-gray-50 transition",children:[(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t+1}),(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,E.jsxs)("div",{className:"flex items-center",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center mr-3",children:(0,E.jsx)("span",{className:"text-indigo-600 font-semibold text-sm",children:e.name.charAt(0).toUpperCase()})}),(0,E.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})]})}),(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,E.jsxs)("div",{className:"flex items-center text-sm text-gray-900",children:[(0,E.jsx)(on,{className:"w-4 h-4 mr-2 text-gray-400"}),e.email]})}),(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,E.jsxs)("div",{className:"flex items-center text-sm text-gray-900",children:[(0,E.jsx)(xn,{className:"w-4 h-4 mr-2 text-gray-400"}),e.mobile]})}),(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,E.jsx)("span",{className:"font-mono bg-gray-100 px-3 py-1 rounded text-xs text-gray-700",children:e.password})}),(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("button",{onClick:()=>(e=>{u(e),g({name:e.name,email:e.email,mobile:e.mobile,password:""}),o(!0)})(e),className:"text-green-600 hover:text-green-900 p-2 hover:bg-green-50 rounded-lg transition",title:"Edit Student",children:(0,E.jsx)(Sn,{className:"w-4 h-4"})}),(0,E.jsx)("button",{onClick:()=>(async(e,t)=>{if(window.confirm("\u26a0\ufe0f Are you sure you want to delete ".concat(t,"? This action cannot be undone.")))try{const{error:t}=await tn.from("students").delete().eq("id",e);if(t)throw t;alert("\ud83d\uddd1\ufe0f Student deleted successfully!"),r()}catch(n){console.error("Error deleting student:",n),alert("\u274c Error deleting student: "+n.message)}})(e.id,e.name),className:"text-red-600 hover:text-red-900 p-2 hover:bg-red-50 rounded-lg transition",title:"Delete Student",children:(0,E.jsx)(_n,{className:"w-4 h-4"})})]})})]},e.id))})]})}),(0,E.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,E.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center",children:(0,E.jsx)(an,{className:"w-5 h-5 text-white"})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-xs text-blue-600 font-medium",children:"Total Students"}),(0,E.jsx)("p",{className:"text-2xl font-bold text-blue-700",children:t.length})]})]})}),(0,E.jsx)("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center",children:(0,E.jsx)(gn,{className:"w-5 h-5 text-white"})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-xs text-green-600 font-medium",children:"Search Results"}),(0,E.jsx)("p",{className:"text-2xl font-bold text-green-700",children:w.length})]})]})}),(0,E.jsx)("div",{className:"bg-purple-50 p-4 rounded-lg",children:(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center",children:(0,E.jsx)(bn,{className:"w-5 h-5 text-white"})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-xs text-purple-600 font-medium",children:"Status"}),(0,E.jsx)("p",{className:"text-sm font-bold text-purple-700",children:"All Active"})]})]})})]})})]})})]})]})}const kn=v("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Tn=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",Nn=e=>{if(!e||0===e.length)return 0;const t=e.filter(e=>"present"===e.status).length;return Math.round(t/e.length*100)};function jn(e){let{students:t,attendance:r,onRefresh:a}=e;const[s,i]=(0,n.useState)((new Date).toISOString().split("T")[0]),[o,l]=(0,n.useState)({}),[u,d]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!1),[m,p]=(0,n.useState)(!1);(0,n.useEffect)(()=>{const e=r.filter(e=>e.date===s),t={};e.forEach(e=>{t[e.student_id]=e.status}),l(t),p(!1)},[s,r]);const g=(e,t)=>{l(c(c({},o),{},{[e]:t})),p(!0)},v=r.filter(e=>e.date===(new Date).toISOString().split("T")[0]).filter(e=>"present"===e.status).length,b=t.length>0?Math.round(v/t.length*100):0;return(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,E.jsx)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow p-6 text-white",children:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-blue-100 text-sm mb-1",children:"Total Students"}),(0,E.jsx)("p",{className:"text-3xl font-bold",children:t.length})]}),(0,E.jsx)(an,{className:"w-12 h-12 text-blue-200"})]})}),(0,E.jsx)("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-lg shadow p-6 text-white",children:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-green-100 text-sm mb-1",children:"Today Present"}),(0,E.jsx)("p",{className:"text-3xl font-bold",children:v})]}),(0,E.jsx)(x,{className:"w-12 h-12 text-green-200"})]})}),(0,E.jsx)("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-lg shadow p-6 text-white",children:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-red-100 text-sm mb-1",children:"Today Absent"}),(0,E.jsx)("p",{className:"text-3xl font-bold",children:t.length-v})]}),(0,E.jsx)(kn,{className:"w-12 h-12 text-red-200"})]})}),(0,E.jsx)("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg shadow p-6 text-white",children:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-purple-100 text-sm mb-1",children:"Today's Rate"}),(0,E.jsxs)("p",{className:"text-3xl font-bold",children:[b,"%"]})]}),(0,E.jsx)(pn,{className:"w-12 h-12 text-purple-200"})]})})]}),(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,E.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[(0,E.jsx)(_,{className:"w-6 h-6 mr-2 text-indigo-600"}),"Mark Attendance"]}),(0,E.jsxs)("button",{onClick:()=>d(!u),disabled:h,className:"flex items-center space-x-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition shadow-md",children:[(0,E.jsx)(_,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:u?"Hide Form":"Mark Attendance"})]})]}),u&&(0,E.jsxs)("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 p-6 rounded-lg mb-6 border-2 border-indigo-200",children:[(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Date"}),(0,E.jsx)("input",{type:"date",value:s,onChange:e=>i(e.target.value),disabled:h,max:(new Date).toISOString().split("T")[0],className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed"})]}),(0,E.jsxs)("div",{className:"flex space-x-2 mb-4",children:[(0,E.jsxs)("button",{onClick:()=>{const e={};t.forEach(t=>{e[t.id]="present"}),l(e),p(!0)},disabled:h,className:"flex items-center space-x-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 text-sm font-medium disabled:bg-gray-400 disabled:cursor-not-allowed transition shadow-md",children:[(0,E.jsx)(x,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Mark All Present"})]}),(0,E.jsxs)("button",{onClick:()=>{const e={};t.forEach(t=>{e[t.id]="absent"}),l(e),p(!0)},disabled:h,className:"flex items-center space-x-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 text-sm font-medium disabled:bg-gray-400 disabled:cursor-not-allowed transition shadow-md",children:[(0,E.jsx)(kn,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Mark All Absent"})]})]}),m&&(0,E.jsx)("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,E.jsxs)("p",{className:"text-sm text-yellow-800 font-medium flex items-center",children:[(0,E.jsx)("span",{className:"mr-2",children:"\u26a0\ufe0f"}),'You have unsaved changes. Click "Save Attendance" to save.']})}),(0,E.jsx)("div",{className:"space-y-3 mb-4 max-h-96 overflow-y-auto",children:t.map(e=>(0,E.jsxs)("div",{className:"flex items-center justify-between bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center",children:(0,E.jsx)("span",{className:"text-indigo-600 font-semibold",children:e.name.charAt(0)})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"font-medium text-gray-800",children:e.name}),(0,E.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]})]}),(0,E.jsxs)("div",{className:"flex space-x-2",children:[(0,E.jsxs)("button",{onClick:()=>g(e.id,"present"),disabled:h,className:"px-4 py-2 rounded-lg font-medium transition flex items-center space-x-1 ".concat("present"===o[e.id]?"bg-green-500 text-white shadow-md":"bg-gray-200 text-gray-700 hover:bg-gray-300"," disabled:opacity-50 disabled:cursor-not-allowed"),children:[(0,E.jsx)(x,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Present"})]}),(0,E.jsxs)("button",{onClick:()=>g(e.id,"absent"),disabled:h,className:"px-4 py-2 rounded-lg font-medium transition flex items-center space-x-1 ".concat("absent"===o[e.id]?"bg-red-500 text-white shadow-md":"bg-gray-200 text-gray-700 hover:bg-gray-300"," disabled:opacity-50 disabled:cursor-not-allowed"),children:[(0,E.jsx)(kn,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Absent"})]})]})]},e.id))}),0===t.length&&(0,E.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No students available. Please add students first."}),(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,E.jsx)("span",{children:"Attendance Marked"}),(0,E.jsxs)("span",{className:"font-medium",children:[Object.keys(o).length," / ",t.length," students"]})]}),(0,E.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,E.jsx)("div",{className:"bg-indigo-600 h-3 rounded-full transition-all duration-300",style:{width:"".concat(t.length>0?Object.keys(o).length/t.length*100:0,"%")}})})]}),(0,E.jsxs)("div",{className:"flex space-x-3",children:[(0,E.jsxs)("button",{onClick:async()=>{if(Object.keys(o).length>0){f(!0);try{for(const e in o){const t=r.find(t=>t.student_id===e&&t.date===s);t?await tn.from("attendance").update({status:o[e]}).eq("id",t.id):await tn.from("attendance").insert([{student_id:e,date:s,status:o[e]}])}alert("\u2705 Attendance saved successfully!"),d(!1),p(!1),a()}catch(e){console.error("Error saving attendance:",e),alert("\u274c Error saving attendance: "+e.message)}finally{f(!1)}}else alert("Please mark attendance for at least one student")},disabled:h||0===t.length,className:"flex items-center space-x-2 px-6 py-3 rounded-lg font-medium transition ".concat(h||0===t.length?"bg-gray-400 cursor-not-allowed text-white":"bg-green-600 hover:bg-green-700 text-white shadow-md"),children:[h&&(0,E.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,E.jsx)(x,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:h?"Saving Attendance...":"Save Attendance"})]}),(0,E.jsx)("button",{onClick:()=>{m?window.confirm("You have unsaved changes. Are you sure you want to cancel?")&&(d(!1),p(!1)):d(!1)},disabled:h,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium disabled:opacity-50 disabled:cursor-not-allowed transition",children:"Cancel"})]})]})]}),(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,E.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Attendance Summary"}),(0,E.jsxs)("button",{onClick:()=>{const e=[["S.No","Name","Email","Present Days","Total Days","Percentage"].join(","),...t.map((e,t)=>{const n=r.filter(t=>t.student_id===e.id),a=n.filter(e=>"present"===e.status).length,s=n.length,i=Nn(n);return[t+1,e.name,e.email,a,s,i+"%"].join(",")})].join("\n"),n=new Blob([e],{type:"text/csv"}),a=window.URL.createObjectURL(n),s=document.createElement("a");s.href=a,s.download="attendance_".concat((new Date).toISOString().split("T")[0],".csv"),s.click()},className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition shadow-md",children:[(0,E.jsx)(vn,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Export"})]})]}),(0,E.jsx)("div",{className:"overflow-x-auto",children:(0,E.jsxs)("table",{className:"w-full",children:[(0,E.jsx)("thead",{className:"bg-gray-50",children:(0,E.jsxs)("tr",{children:[(0,E.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"S.No"}),(0,E.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,E.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,E.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Present Days"}),(0,E.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Days"}),(0,E.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentage"})]})}),(0,E.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[t.map((e,t)=>{const n=r.filter(t=>t.student_id===e.id),a=Nn(n),s=n.filter(e=>"present"===e.status).length,i=n.length;return(0,E.jsxs)("tr",{className:"hover:bg-gray-50 transition",children:[(0,E.jsx)("td",{className:"px-4 py-4 text-sm text-gray-900",children:t+1}),(0,E.jsx)("td",{className:"px-4 py-4",children:(0,E.jsxs)("div",{className:"flex items-center",children:[(0,E.jsx)("div",{className:"w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center mr-3",children:(0,E.jsx)("span",{className:"text-indigo-600 font-semibold text-sm",children:e.name.charAt(0)})}),(0,E.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.name})]})}),(0,E.jsx)("td",{className:"px-4 py-4 text-sm text-gray-600",children:e.email}),(0,E.jsx)("td",{className:"px-4 py-4 text-sm",children:(0,E.jsx)("span",{className:"font-semibold text-green-600",children:s})}),(0,E.jsx)("td",{className:"px-4 py-4 text-sm",children:(0,E.jsx)("span",{className:"font-semibold text-gray-900",children:i})}),(0,E.jsx)("td",{className:"px-4 py-4 text-sm",children:(0,E.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(a>=75?"bg-green-100 text-green-800":a>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:[a,"%"]})})]},e.id)}),0===t.length&&(0,E.jsx)("tr",{children:(0,E.jsxs)("td",{colSpan:"6",className:"px-4 py-12 text-center",children:[(0,E.jsx)(an,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,E.jsx)("p",{className:"text-gray-500 font-medium",children:"No students added yet. Please add students first."})]})})]})]})})]})]})}const An=v("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),Cn=v("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),On=v("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var Pn={version:"0.18.5"},Rn=1200,In=1252,Dn=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ln={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Mn=function(e){-1!=Dn.indexOf(e)&&(In=Ln[0]=e)};var Fn=function(e){Rn=e,Mn(e)};function Un(){Fn(1200),Mn(1252)}function zn(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Bn,Hn=function(e){return String.fromCharCode(e)},Wn=function(e){return String.fromCharCode(e)};var Vn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Gn(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)s=(r=e.charCodeAt(c++))>>2,i=(3&r)<<4|(n=e.charCodeAt(c++))>>4,o=(15&n)<<2|(a=e.charCodeAt(c++))>>6,l=63&a,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Vn.charAt(s)+Vn.charAt(i)+Vn.charAt(o)+Vn.charAt(l);return t}function qn(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)r=Vn.indexOf(e.charAt(l++))<<2|(s=Vn.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(r),n=(15&s)<<4|(i=Vn.indexOf(e.charAt(l++)))>>2,64!==i&&(t+=String.fromCharCode(n)),a=(3&i)<<6|(o=Vn.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var Kn=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),$n=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Yn(e){return Kn?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Jn(e){return Kn?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Xn=function(e){return Kn?$n(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function Qn(e){if("undefined"===typeof ArrayBuffer)return Xn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}function Zn(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}var ea=Kn?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:$n(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var ta=/\u0000/g,ra=/[\u0001-\u0006]/g;function na(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function aa(e,t){var r=""+e;return r.length>=t?r:gs("0",t-r.length)+r}function sa(e,t){var r=""+e;return r.length>=t?r:gs(" ",t-r.length)+r}function ia(e,t){var r=""+e;return r.length>=t?r:r+gs(" ",t-r.length)}var oa=Math.pow(2,32);function la(e,t){return e>oa||e<-oa?function(e,t){var r=""+Math.round(e);return r.length>=t?r:gs("0",t-r.length)+r}(e,t):function(e,t){var r=""+e;return r.length>=t?r:gs("0",t-r.length)+r}(Math.round(e),t)}function ca(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var ua=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],da=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var ha={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},fa={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ma={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function pa(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,u=0,d=Math.floor(a);c<t&&(o=(d=Math.floor(a))*i+s,u=d*c+l,!(a-d<5e-8));)a=1/(a-d),s=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=i)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function ga(e,t,r){if(e>2958465||e<0)return null;var n=0|e,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++n,++o.D)),60===n)i=r?[1317,10,29]:[1900,2,29],s=3;else if(0===n)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=function(e,t){t[0]-=581;var r=e.getDay();e<60&&(r=(r+6)%7);return r}(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var va=new Date(1899,11,31,0,0,0),ba=va.getTime(),ya=new Date(1900,2,1,0,0,0);function xa(e,t){var r=e.getTime();return t?r-=1262304e5:e>=ya&&(r+=864e5),(r-(ba+6e4*(e.getTimezoneOffset()-va.getTimezoneOffset())))/864e5}function wa(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Sa(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function(e){var t=e<0?12:11,r=wa(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function(e){var t=wa(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),wa(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function _a(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Sa(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Va(14,xa(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Ea(e,t,r,n){var a,s="",i=0,o=0,l=r.y,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,c=2;break;default:a=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=r.m,c=t.length;break;case 3:return da[r.m-1][1];case 5:return da[r.m-1][0];default:return da[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,c=t.length;break;case 3:return ua[r.q][0];default:return ua[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(o=n>=2?3===n?1e3:100:1===n?10:1,(i=Math.round(o*(r.S+r.u)))>=60*o&&(i=0),"s"===t?0===i?"0":""+i/o:(s=aa(i,2+n),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):aa(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*r.D+r.H;break;case"[m]":case"[mm]":a=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":a=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=l,c=1}return c>0?aa(a,c):""}function ka(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var Ta=/%/g;function Na(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Na(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),-1===(r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a)).indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(a+s)%a)+"."+n.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var ja=/# (\?+)( ?)\/( ?)(\d+)/;var Aa=/^#*0*\.([0#]+)/,Ca=/\).*[0#]/,Oa=/\(###\) ###\\?-####/;function Pa(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Ra(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ia(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Da(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Ca)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Da("n",n,r):"("+Da("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return Fa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(Ta,""),a=t.length-n.length;return Fa(e,n,r*Math.pow(10,2*a))+gs("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return Na(t,r);if(36===t.charCodeAt(0))return"$"+Da(e,t.substr(" "==t.charAt(1)?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+la(l,t.length);if(t.match(/^[#?]+$/))return"0"===(a=la(r,0))&&(a=""),a.length>t.length?a:Pa(t.substr(0,t.length-a.length))+a;if(s=t.match(ja))return function(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(0===s?"":""+s)+" "+(0===i?gs(" ",e[1].length+1+e[4].length):sa(i,e[1].length)+e[2]+"/"+e[3]+aa(o,e[4].length))}(s,l,c);if(t.match(/^#+0+$/))return c+la(l,t.length-t.indexOf("0"));if(s=t.match(Aa))return a=Ra(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Pa(s[1])).replace(/\.$/,"."+Pa(s[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+gs("0",Pa(s[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+Ra(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+ka(la(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Da(e,t,-r):ka(""+(Math.floor(r)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,s[1].length)))+"."+aa(Ia(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Da(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=na(Da(e,t.replace(/[\\-]/g,""),r)),i=0,na(na(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""}));if(t.match(Oa))return"("+(a=Da(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=pa(l,Math.pow(10,i)-1,!1),a=""+c," "==(u=Fa("n",s[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],(u=ia(o[2],i)).length<s[4].length&&(u=Pa(s[4].substr(s[4].length-u.length))+u),a+=u;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=pa(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?sa(o[1],i)+s[2]+"/"+s[3]+ia(o[2],i):gs(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=la(r,0),t.length<=a.length?a:Pa(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Pa(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=Ia(r,s[1].length),r<0?"-"+Da(e,t,-r):ka(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?aa(0,3-e.length):"")+e})+"."+aa(i,s[1].length);switch(t){case"###,##0.00":return Da(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=ka(la(l,0));return"0"!==f?c+f:"";case"###,###.00":return Da(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Da(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function La(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+La(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),!(r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a)).match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(a+s)%a)+"."+n.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ma(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Ca)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ma("n",n,r):"("+Ma("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return Fa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(Ta,""),a=t.length-n.length;return Fa(e,n,r*Math.pow(10,2*a))+gs("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return La(t,r);if(36===t.charCodeAt(0))return"$"+Ma(e,t.substr(" "==t.charAt(1)?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+aa(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,0===r&&(a=""),a.length>t.length?a:Pa(t.substr(0,t.length-a.length))+a;if(s=t.match(ja))return function(e,t,r){return r+(0===t?"":""+t)+gs(" ",e[1].length+2+e[4].length)}(s,l,c);if(t.match(/^#+0+$/))return c+aa(l,t.length-t.indexOf("0"));if(s=t.match(Aa))return a=(a=(""+r).replace(/^([^\.]+)$/,"$1."+Pa(s[1])).replace(/\.$/,"."+Pa(s[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+gs("0",Pa(s[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+ka(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ma(e,t,-r):ka(""+r)+"."+gs("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Ma(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=na(Ma(e,t.replace(/[\\-]/g,""),r)),i=0,na(na(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""}));if(t.match(Oa))return"("+(a=Ma(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=pa(l,Math.pow(10,i)-1,!1),a=""+c," "==(u=Fa("n",s[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],(u=ia(o[2],i)).length<s[4].length&&(u=Pa(s[4].substr(s[4].length-u.length))+u),a+=u;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=pa(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?sa(o[1],i)+s[2]+"/"+s[3]+ia(o[2],i):gs(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Pa(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Pa(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ma(e,t,-r):ka(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?aa(0,3-e.length):"")+e})+"."+aa(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=ka(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return Ma(e,t.slice(0,t.lastIndexOf(".")),r)+Pa(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Fa(e,t,r){return(0|r)===r?Ma(e,t,r):Da(e,t,r)}var Ua=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function za(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":ca(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(Ua))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Ba=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ha(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function Wa(e,t){var r=function(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!==typeof t)return[4,4===r.length||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var s=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,s];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var i=r[0].match(Ba),o=r[1].match(Ba);return Ha(t,i)?[n,r[0]]:Ha(t,o)?[n,r[1]]:[n,r[null!=i&&null!=o?2:1]]}return[n,s]}function Va(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:ha)[e])&&(n=r.table&&r.table[fa[e]]||ha[fa[e]]),null==n&&(n=ma[e]||"General")}if(ca(n,0))return _a(t,r);t instanceof Date&&(t=xa(t,r.date1904));var a=Wa(n,t);if(ca(a[1]))return _a(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,n){for(var a,s,i,o=[],l="",c=0,u="",d="t",h="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!ca(e,c))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(i=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(i);o[o.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),m="("===f||")"===f?f:"t";o[o.length]={t:m,v:f},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=ga(t,r,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=ga(t,r)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===d.toLowerCase()&&(u="M"),"h"===u&&(u=h),o[o.length]={t:u,v:l},d=u;break;case"A":case"a":case"\u4e0a":var p={t:u,v:u};if(null==a&&(a=ga(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(p.v=a.H>=12?"P":"A"),p.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(p.v=a.H>=12?"PM":"AM"),p.t="T",c+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=a&&(p.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),p.t="T",c+=5,h="h"):(p.t="t",++c),null==a&&"T"===p.t)return"";o[o.length]=p,d=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(Ua)){if(null==a&&null==(a=ga(t,r)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",za(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=a){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;o[o.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;o[o.length]={t:u,v:l},d=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===n?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:u,v:u},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++c}var g,v=0,b=0;for(c=o.length-1,d="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=h,d="h",v<1&&(v=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(b=Math.max(b,g[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":d=o[c].t;break;case"m":"s"===d&&(o[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[c].v.match(/[Hh]/)&&(v=1),v<2&&o[c].v.match(/[Mm]/)&&(v=2),v<3&&o[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var y,x="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=Ea(o[c].t.charCodeAt(0),o[c].v,a,b),o[c].t="t";break;case"n":case"?":for(y=c+1;null!=o[y]&&("?"===(u=o[y].t)||"D"===u||(" "===u||"t"===u)&&null!=o[y+1]&&("?"===o[y+1].t||"t"===o[y+1].t&&"/"===o[y+1].v)||"("===o[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[y].v||" "===o[y].v&&null!=o[y+1]&&"?"==o[y+1].t));)o[c].v+=o[y].v,o[y]={v:"",t:";"},++y;x+=o[c].v,c=y-1;break;case"G":o[c].t="t",o[c].v=_a(t,r)}var w,S,_="";if(x.length>0){40==x.charCodeAt(0)?(w=t<0&&45===x.charCodeAt(0)?-t:t,S=Fa("n",x,w)):(S=Fa("n",x,w=t<0&&n>1?-t:t),w<0&&o[0]&&"t"==o[0].t&&(S=S.substr(1),o[0].v="-"+o[0].v)),y=S.length-1;var E=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){E=c;break}var k=o.length;if(E===o.length&&-1===S.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(y>=o[c].v.length-1?(y-=o[c].v.length,o[c].v=S.substr(y+1,o[c].v.length)):y<0?o[c].v="":(o[c].v=S.substr(0,y+1),y=-1),o[c].t="t",k=c);y>=0&&k<o.length&&(o[k].v=S.substr(0,y+1)+o[k].v)}else if(E!==o.length&&-1===S.indexOf("E")){for(y=S.indexOf(".")-1,c=E;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(s=o[c].v.indexOf(".")>-1&&c===E?o[c].v.indexOf(".")-1:o[c].v.length-1,_=o[c].v.substr(s+1);s>=0;--s)y>=0&&("0"===o[c].v.charAt(s)||"#"===o[c].v.charAt(s))&&(_=S.charAt(y--)+_);o[c].v=_,o[c].t="t",k=c}for(y>=0&&k<o.length&&(o[k].v=S.substr(0,y+1)+o[k].v),y=S.indexOf(".")+1,c=E;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===E)){for(s=o[c].v.indexOf(".")>-1&&c===E?o[c].v.indexOf(".")+1:0,_=o[c].v.substr(0,s);s<o[c].v.length;++s)y<S.length&&(_+=S.charAt(y++));o[c].v=_,o[c].t="t",k=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(w=n>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=Fa(o[c].t,o[c].v,w),o[c].t="t");var T="";for(c=0;c!==o.length;++c)null!=o[c]&&(T+=o[c].v);return T}(a[1],t,r,a[0])}function Ga(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=ha[r]){if(ha[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return ha[t]=e,t}function qa(e){for(var t=0;392!=t;++t)void 0!==e[t]&&Ga(e[t],t)}function Ka(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',ha=e}var $a=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Ya=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var r=function(e){var t=0,r=0,n=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)a[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=a[t]=r>>>8^e[255&r];var s=[];for(n=1;16!=n;++n)s[n-1]="undefined"!==typeof Int32Array?a.subarray(256*n,256*n+256):a.slice(256*n,256*n+256);return s}(t),n=r[0],a=r[1],s=r[2],i=r[3],o=r[4],l=r[5],c=r[6],u=r[7],d=r[8],h=r[9],f=r[10],m=r[11],p=r[12],g=r[13],v=r[14];return e.table=t,e.bstr=function(e,r){for(var n=-1^r,a=0,s=e.length;a<s;)n=n>>>8^t[255&(n^e.charCodeAt(a++))];return~n},e.buf=function(e,r){for(var b=-1^r,y=e.length-15,x=0;x<y;)b=v[e[x++]^255&b]^g[e[x++]^b>>8&255]^p[e[x++]^b>>16&255]^m[e[x++]^b>>>24]^f[e[x++]]^h[e[x++]]^d[e[x++]]^u[e[x++]]^c[e[x++]]^l[e[x++]]^o[e[x++]]^i[e[x++]]^s[e[x++]]^a[e[x++]]^n[e[x++]]^t[e[x++]];for(y+=15;x<y;)b=b>>>8^t[255&(b^e[x++])];return~b},e.str=function(e,r){for(var n=-1^r,a=0,s=e.length,i=0,o=0;a<s;)(i=e.charCodeAt(a++))<128?n=n>>>8^t[255&(n^i)]:i<2048?n=(n=n>>>8^t[255&(n^(192|i>>6&31))])>>>8^t[255&(n^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),o=1023&e.charCodeAt(a++),n=(n=(n=(n=n>>>8^t[255&(n^(240|i>>8&7))])>>>8^t[255&(n^(128|i>>2&63))])>>>8^t[255&(n^(128|o>>6&15|(3&i)<<4))])>>>8^t[255&(n^(128|63&o))]):n=(n=(n=n>>>8^t[255&(n^(224|i>>12&15))])>>>8^t[255&(n^(128|i>>6&63))])>>>8^t[255&(n^(128|63&i))];return~n},e}(),Ja=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var n=t.getFullYear()-1980;n=(n=n<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,n)}function s(e){Gi(e,0);for(var t={},r=0;e.l<=e.length-4;){var n=e.read_shift(2),a=e.read_shift(2),s=e.l+a,i={};if(21589===n)1&(r=e.read_shift(1))&&(i.mtime=e.read_shift(4)),a>5&&(2&r&&(i.atime=e.read_shift(4)),4&r&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=s,t[n]=i}return t}function i(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return ne(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=S(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",n=(Kn&&Buffer.isBuffer(e)?e.toString("binary"):S(e)).split("\r\n"),a=0,s="";for(a=0;a<n.length;++a)if(s=n[a],/^Content-Location:/i.test(s)&&(s=s.slice(s.indexOf("file")),r||(r=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),s.slice(0,r.length)!=r););var i=(n[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var o="--"+(i[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};h(u);var d,f=0;for(a=0;a<n.length;++a){var m=n[a];m!==o&&m!==o+"--"||(f++&&ce(u,n.slice(d,a),r),d=a)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,n,a,s,i,o,f=512,m=[],p=e.slice(0,512);Gi(p,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(b,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(r=g[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==g[1])return ne(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==f&&Gi(p=e.slice(0,f),28);var y=e.slice(0,f);!function(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,r);var x=p.read_shift(4,"i");if(3===r&&0!==x)throw new Error("# Directory Sectors: Expected 0 saw "+x);p.l+=4,s=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),i=p.read_shift(4,"i"),n=p.read_shift(4,"i"),o=p.read_shift(4,"i"),a=p.read_shift(4,"i");for(var w=-1,_=0;_<109&&!((w=p.read_shift(4,"i"))<0);++_)m[_]=w;var E=function(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],a=1;a<r;++a)n[a-1]=e.slice(a*t,(a+1)*t);return n[r-1]=e.slice(r*t),n}(e,f);c(o,a,E,f,m);var k=function(e,t,r,n){var a=e.length,s=[],i=[],o=[],l=[],c=n-1,u=0,d=0,h=0,f=0;for(u=0;u<a;++u)if(o=[],(h=u+t)>=a&&(h-=a),!i[h]){l=[];var m=[];for(d=h;d>=0;){m[d]=!0,i[d]=!0,o[o.length]=d,l.push(e[d]);var p=r[Math.floor(4*d/n)];if(n<4+(f=4*d&c))throw new Error("FAT boundary crossed: "+d+" 4 "+n);if(!e[p])break;if(m[d=Mi(e[p],f)])break}s[h]={nodes:o,data:hi([l])}}return s}(E,s,m,f);k[s].name="!Directory",n>0&&i!==v&&(k[i].name="!MiniFAT"),k[m[0]].name="!FAT",k.fat_addrs=m,k.ssz=f;var T=[],N=[],j=[];!function(e,t,r,n,a,s,i,o){for(var c,h=0,f=n.length?2:0,m=t[e].data,p=0,g=0;p<m.length;p+=128){var b=m.slice(p,p+128);Gi(b,64),g=b.read_shift(2),c=mi(b,0,g-f),n.push(c);var y={name:c,type:b.read_shift(1),color:b.read_shift(1),L:b.read_shift(4,"i"),R:b.read_shift(4,"i"),C:b.read_shift(4,"i"),clsid:b.read_shift(16),state:b.read_shift(4,"i"),start:0,size:0};0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(y.ct=d(b,b.l-8)),0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(y.mt=d(b,b.l-8)),y.start=b.read_shift(4,"i"),y.size=b.read_shift(4,"i"),y.size<0&&y.start<0&&(y.size=y.type=0,y.start=v,y.name=""),5===y.type?(h=y.start,a>0&&h!==v&&(t[h].name="!StreamData")):y.size>=4096?(y.storage="fat",void 0===t[y.start]&&(t[y.start]=u(r,y.start,t.fat_addrs,t.ssz)),t[y.start].name=y.name,y.content=t[y.start].data.slice(0,y.size)):(y.storage="minifat",y.size<0?y.size=0:h!==v&&y.start!==v&&t[h]&&(y.content=l(y,t[h].data,(t[o]||{}).data))),y.content&&Gi(y.content,0),s[c]=y,i.push(y)}}(s,k,E,T,n,{},N,i),function(e,t,r){for(var n=0,a=0,s=0,i=0,o=0,l=r.length,c=[],u=[];n<l;++n)c[n]=u[n]=n,t[n]=r[n];for(;o<u.length;++o)a=e[n=u[o]].L,s=e[n].R,i=e[n].C,c[n]===n&&(-1!==a&&c[a]!==a&&(c[n]=c[a]),-1!==s&&c[s]!==s&&(c[n]=c[s])),-1!==i&&(c[i]=n),-1!==a&&n!=c[n]&&(c[a]=c[n],u.lastIndexOf(a)<o&&u.push(a)),-1!==s&&n!=c[n]&&(c[s]=c[n],u.lastIndexOf(s)<o&&u.push(s));for(n=1;n<l;++n)c[n]===n&&(-1!==s&&c[s]!==s?c[n]=c[s]:-1!==a&&c[a]!==a&&(c[n]=c[a]));for(n=1;n<l;++n)if(0!==e[n].type){if((o=n)!=c[o])do{o=c[o],t[n]=t[o]+"/"+t[n]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[n]=-1}for(t[0]+="/",n=1;n<l;++n)2!==e[n].type&&(t[n]+="/")}(N,j,T),T.shift();var A={FileIndex:N,FullPaths:j};return t&&t.raw&&(A.raw={header:y,sectors:E}),A}function l(e,t,r){for(var n=e.start,a=e.size,s=[],i=n;r&&a>0&&i>=0;)s.push(t.slice(i*g,i*g+g)),a-=g,i=Mi(r,4*i);return 0===s.length?Ki(0):ea(s).slice(0,e.size)}function c(e,t,r,n,a){var s=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=r[e],o=(n>>>2)-1;if(!i)return;for(var l=0;l<o&&(s=Mi(i,4*l))!==v;++l)a.push(s);c(Mi(i,n-4),t-1,r,n,a)}}function u(e,t,r,n,a){var s=[],i=[];a||(a=[]);var o=n-1,l=0,c=0;for(l=t;l>=0;){a[l]=!0,s[s.length]=l,i.push(e[l]);var u=r[Math.floor(4*l/n)];if(n<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!e[u])break;l=Mi(e[u],c)}return{nodes:s,data:hi([i])}}function d(e,t){return new Date(1e3*(Li(e,t+4)/1e7*Math.pow(2,32)+Li(e,t)/1e7-11644473600))}function h(e,t){var r=t||{},n=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(Ja.find(e,"/"+t))return;var r=Ki(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){h(e);for(var a=!1,s=!1,i=e.FullPaths.length-1;i>=0;--i){var o=e.FileIndex[i];switch(o.type){case 0:s?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},d=[];for(i=0;i<e.FullPaths.length;++i)u[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&d.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<d.length;++i){var f=r(d[i][0]);(s=u[f])||(d.push([f,{name:n(f).replace("/",""),type:1,clsid:x,ct:l,mt:l,content:null}]),u[f]=!0)}for(d.sort(function(e,t){return function(e,t){for(var r=e.split("/"),n=t.split("/"),a=0,s=0,i=Math.min(r.length,n.length);a<i;++a){if(s=r[a].length-n[a].length)return s;if(r[a]!=n[a])return r[a]<n[a]?-1:1}return r.length-n.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<d.length;++i)e.FullPaths[i]=d[i][0],e.FileIndex[i]=d[i][1];for(i=0;i<d.length;++i){var m=e.FileIndex[i],p=e.FullPaths[i];if(m.name=n(p).replace("/",""),m.L=m.R=m.C=-(m.color=1),m.size=m.content?m.content.length:0,m.start=0,m.clsid=m.clsid||x,0===i)m.C=d.length>1?1:-1,m.size=0,m.type=5;else if("/"==p.slice(-1)){for(c=i+1;c<d.length&&r(e.FullPaths[c])!=p;++c);for(m.C=c>=d.length?-1:c,c=i+1;c<d.length&&r(e.FullPaths[c])!=r(p);++c);m.R=c>=d.length?-1:c,m.type=1}else r(e.FullPaths[i+1]||"")==r(p)&&(m.R=i+1),m.type=2}}}function m(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},n=r.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],s=e.FullPaths[0],i=s,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(i=e.FullPaths[l].slice(s.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,u=Kn&&Buffer.isBuffer(c)?c.toString("binary"):S(c),d=0,h=Math.min(1024,u.length),f=0,m=0;m<=h;++m)(f=u.charCodeAt(m))>=32&&f<128&&++d;var p=d>=4*h/5;a.push(n),a.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+i),a.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),a.push("Content-Type: "+ie(o,i)),a.push(""),a.push(p?le(u):oe(u))}return a.push(n+"--\r\n"),a.join("\r\n")}(e,r);if(f(e),"zip"===r.fileType)return function(e,t){var r=t||{},n=[],s=[],i=Ki(1),o=r.compression?8:0,l=0;0;var c=0,u=0,d=0,h=0,f=e.FullPaths[0],m=f,p=e.FileIndex[0],g=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(m=e.FullPaths[c].slice(f.length),(p=e.FileIndex[c]).size&&p.content&&"\x01Sh33tJ5"!=m){var b=d,y=Ki(m.length);for(u=0;u<m.length;++u)y.write_shift(1,127&m.charCodeAt(u));y=y.slice(0,y.l),g[h]=Ya.buf(p.content,0);var x=p.content;8==o&&(x=_(x)),(i=Ki(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),p.mt?a(i,p.mt):i.write_shift(4,0),i.write_shift(-4,8&l?0:g[h]),i.write_shift(4,8&l?0:x.length),i.write_shift(4,8&l?0:p.content.length),i.write_shift(2,y.length),i.write_shift(2,0),d+=i.length,n.push(i),d+=y.length,n.push(y),d+=x.length,n.push(x),8&l&&((i=Ki(12)).write_shift(-4,g[h]),i.write_shift(4,x.length),i.write_shift(4,p.content.length),d+=i.l,n.push(i)),(i=Ki(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),i.write_shift(4,0),i.write_shift(-4,g[h]),i.write_shift(4,x.length),i.write_shift(4,p.content.length),i.write_shift(2,y.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,b),v+=i.l,s.push(i),v+=y.length,s.push(y),++h}return i=Ki(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,h),i.write_shift(2,h),i.write_shift(4,v),i.write_shift(4,d),i.write_shift(2,0),ea([ea(n),ea(s),i])}(e,r);var n=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var a=e.FileIndex[n];if(a.content){var s=a.content.length;s>0&&(s<4096?t+=s+63>>6:r+=s+511>>9)}}for(var i=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+r+i+o,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var d=[1,u,c,o,i,r,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),s=Ki(n[7]<<9),i=0,o=0;for(i=0;i<8;++i)s.write_shift(1,y[i]);for(i=0;i<8;++i)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),i=0;i<3;++i)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,n[2]),s.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:v),s.write_shift(4,n[3]),s.write_shift(-4,n[1]?n[0]-1:v),s.write_shift(4,n[1]),i=0;i<109;++i)s.write_shift(-4,i<n[2]?n[1]+i:-1);if(n[1])for(o=0;o<n[1];++o){for(;i<236+127*o;++i)s.write_shift(-4,i<n[2]?n[1]+i:-1);s.write_shift(-4,o===n[1]-1?v:o+1)}var l=function(e){for(o+=e;i<o-1;++i)s.write_shift(-4,i+1);e&&(++i,s.write_shift(-4,v))};for(o=i=0,o+=n[1];i<o;++i)s.write_shift(-4,w.DIFSECT);for(o+=n[2];i<o;++i)s.write_shift(-4,w.FATSECT);l(n[3]),l(n[4]);for(var c=0,u=0,d=e.FileIndex[0];c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&((u=d.content.length)<4096||(d.start=o,l(u+511>>9)));for(l(n[6]+7>>3);511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(o=i=0,c=0;c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&(!(u=d.content.length)||u>=4096||(d.start=o,l(u+63>>6)));for(;511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(i=0;i<n[4]<<2;++i){var h=e.FullPaths[i];if(h&&0!==h.length){d=e.FileIndex[i],0===i&&(d.start=d.size?d.start-1:v);var m=0===i&&r.root||d.name;if(u=2*(m.length+1),s.write_shift(64,m,"utf16le"),s.write_shift(2,u),s.write_shift(1,d.type),s.write_shift(1,d.color),s.write_shift(-4,d.L),s.write_shift(-4,d.R),s.write_shift(-4,d.C),d.clsid)s.write_shift(16,d.clsid,"hex");else for(c=0;c<4;++c)s.write_shift(4,0);s.write_shift(4,d.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,d.start),s.write_shift(4,d.size),s.write_shift(4,0)}else{for(c=0;c<17;++c)s.write_shift(4,0);for(c=0;c<3;++c)s.write_shift(4,-1);for(c=0;c<12;++c)s.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((d=e.FileIndex[i]).size>=4096)if(s.l=d.start+1<<9,Kn&&Buffer.isBuffer(d.content))d.content.copy(s,s.l,0,d.size),s.l+=d.size+511&-512;else{for(c=0;c<d.size;++c)s.write_shift(1,d.content[c]);for(;511&c;++c)s.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((d=e.FileIndex[i]).size>0&&d.size<4096)if(Kn&&Buffer.isBuffer(d.content))d.content.copy(s,s.l,0,d.size),s.l+=d.size+63&-64;else{for(c=0;c<d.size;++c)s.write_shift(1,d.content[c]);for(;63&c;++c)s.write_shift(1,0)}if(Kn)s.l=s.length;else for(;s.l<s.length;)s.write_shift(1,0);return s}t.version="1.2.1";var p,g=64,v=-2,b="d0cf11e0a1b11ae1",y=[208,207,17,224,161,177,26,225],x="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:b,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:x,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function S(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function _(e){return p?p.deflateRawSync(e):$(e)}var E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function N(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var j="undefined"!==typeof Uint8Array,A=j?new Uint8Array(256):[],C=0;C<256;++C)A[C]=N(C);function O(e,t){var r=A[255&e];return t<=8?r>>>8-t:(r=r<<8|A[e>>8&255],t<=16?r>>>16-t:(r=r<<8|A[e>>16&255])>>>24-t)}function P(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function R(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function I(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function D(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function L(e,t,r){var n=7&t,a=t>>>3,s=(1<<r)-1,i=e[a]>>>n;return r<8-n?i&s:(i|=e[a+1]<<8-n,r<16-n?i&s:(i|=e[a+2]<<16-n,r<24-n?i&s:(i|=e[a+3]<<24-n)&s))}function M(e,t,r){var n=7&t,a=t>>>3;return n<=5?e[a]|=(7&r)<<n:(e[a]|=r<<n&255,e[a+1]=(7&r)>>8-n),t+3}function F(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function U(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=r,t+8}function z(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=255&r,e[n+2]=r>>>8,t+16}function B(e,t){var r=e.length,n=2*r>t?2*r:t+5,a=0;if(r>=t)return e;if(Kn){var s=Jn(n);if(e.copy)e.copy(s);else for(;a<e.length;++a)s[a]=e[a];return s}if(j){var i=new Uint8Array(n);if(i.set)i.set(e);else for(;a<r;++a)i[a]=e[a];return i}return e.length=n,e}function H(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function W(e,t,r){var n=1,a=0,s=0,i=0,o=0,l=e.length,c=j?new Uint16Array(32):H(32);for(s=0;s<32;++s)c[s]=0;for(s=l;s<r;++s)e[s]=0;l=e.length;var u=j?new Uint16Array(l):H(l);for(s=0;s<l;++s)c[a=e[s]]++,n<a&&(n=a),u[s]=0;for(c[0]=0,s=1;s<=n;++s)c[s+16]=o=o+c[s-1]<<1;for(s=0;s<l;++s)0!=(o=e[s])&&(u[s]=c[o+16]++);var d=0;for(s=0;s<l;++s)if(0!=(d=e[s]))for(o=O(u[s],n)>>n-d,i=(1<<n+4-d)-1;i>=0;--i)t[o|i<<d]=15&d|s<<4;return n}var V=j?new Uint16Array(512):H(512),G=j?new Uint16Array(32):H(32);if(!j){for(var q=0;q<512;++q)V[q]=0;for(q=0;q<32;++q)G[q]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);W(e,G,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);W(r,V,288)}();var K=function(){for(var e=j?new Uint8Array(32768):[],t=0,r=0;t<T.length-1;++t)for(;r<T[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var n=j?new Uint8Array(259):[];for(t=0,r=0;t<k.length-1;++t)for(;r<k[t+1];++r)n[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var n=Math.min(65535,e.length-r),a=r+n==e.length;for(t.write_shift(1,+a),t.write_shift(2,n),t.write_shift(2,65535&~n);n-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var a=0,s=0,i=j?new Uint16Array(32768):[];s<t.length;){var o=Math.min(65535,t.length-s);if(o<10){for(7&(a=M(r,a,+!(s+o!=t.length)))&&(a+=8-(7&a)),r.l=a/8|0,r.write_shift(2,o),r.write_shift(2,65535&~o);o-- >0;)r[r.l++]=t[s++];a=8*r.l}else{a=M(r,a,+!(s+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[s],u=-1,d=0;if((u=i[l=32767&(l<<5^c)])&&((u|=-32768&s)>s&&(u-=32768),u<s))for(;t[u+d]==t[s+d]&&d<250;)++d;if(d>2){(c=n[d])<=22?a=U(r,a,A[c+1]>>1)-1:(U(r,a,3),U(r,a+=5,A[c-23]>>5),a+=3);var h=c<8?0:c-4>>2;h>0&&(z(r,a,d-k[c]),a+=h),c=e[s-u],a=U(r,a,A[c]>>3),a-=3;var f=c<4?0:c-2>>1;f>0&&(z(r,a,s-u-T[c]),a+=f);for(var m=0;m<d;++m)i[l]=32767&s,l=32767&(l<<5^t[s]),++s;o-=d-1}else c<=143?c+=48:a=F(r,a,1),a=U(r,a,A[c]),i[l]=32767&s,++s}a=U(r,a,0)-1}}return r.l=(a+7)/8|0,r.l}(t,r)}}();function $(e){var t=Ki(50+Math.floor(1.1*e.length)),r=K(e,t);return t.slice(0,r)}var Y=j?new Uint16Array(32768):H(32768),J=j?new Uint16Array(32768):H(32768),X=j?new Uint16Array(128):H(128),Q=1,Z=1;function ee(e,t){var r=I(e,t)+257,n=I(e,t+=5)+1,a=function(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var s=0,i=j?new Uint8Array(19):H(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=j?new Uint8Array(8):H(8),u=j?new Uint8Array(8):H(8),d=i.length,h=0;h<a;++h)i[E[h]]=s=R(e,t),l<s&&(l=s),c[s]++,t+=3;var f=0;for(c[0]=0,h=1;h<=l;++h)u[h]=f=f+c[h-1]<<1;for(h=0;h<d;++h)0!=(f=i[h])&&(o[h]=u[f]++);var m=0;for(h=0;h<d;++h)if(0!=(m=i[h])){f=A[o[h]]>>8-m;for(var p=(1<<7-m)-1;p>=0;--p)X[f|p<<m]=7&m|h<<3}var g=[];for(l=1;g.length<r+n;)switch(t+=7&(f=X[D(e,t)]),f>>>=3){case 16:for(s=3+P(e,t),t+=2,f=g[g.length-1];s-- >0;)g.push(f);break;case 17:for(s=3+R(e,t),t+=3;s-- >0;)g.push(0);break;case 18:for(s=11+D(e,t),t+=7;s-- >0;)g.push(0);break;default:g.push(f),l<f&&(l=f)}var v=g.slice(0,r),b=g.slice(r);for(h=r;h<286;++h)v[h]=0;for(h=n;h<30;++h)b[h]=0;return Q=W(v,Y,286),Z=W(b,J,30),t}function te(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[Yn(t),2];for(var r=0,n=0,a=Jn(t||1<<18),s=0,i=a.length>>>0,o=0,l=0;0==(1&n);)if(n=R(e,r),r+=3,n>>>1!=0)for(n>>1==1?(o=9,l=5):(r=ee(e,r),o=Q,l=Z);;){!t&&i<s+32767&&(i=(a=B(a,s+32767)).length);var c=L(e,r,o),u=n>>>1==1?V[c]:Y[c];if(r+=15&u,0===((u>>>=4)>>>8&255))a[s++]=u;else{if(256==u)break;var d=(u-=257)<8?0:u-4>>2;d>5&&(d=0);var h=s+k[u];d>0&&(h+=L(e,r,d),r+=d),c=L(e,r,l),r+=15&(u=n>>>1==1?G[c]:J[c]);var f=(u>>>=4)<4?0:u-2>>1,m=T[u];for(f>0&&(m+=L(e,r,f),r+=f),!t&&i<h&&(i=(a=B(a,h+100)).length);s<h;)a[s]=a[s-m],++s}}else{7&r&&(r+=8-(7&r));var p=e[r>>>3]|e[(r>>>3)+1]<<8;if(r+=32,p>0)for(!t&&i<s+p&&(i=(a=B(a,s+p)).length);p-- >0;)a[s++]=e[r>>>3],r+=8}return t?[a,r+7>>>3]:[a.slice(0,s),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function re(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function ne(e,t){var r=e;Gi(r,0);var n={FileIndex:[],FullPaths:[]};h(n,{root:t.root});for(var a=r.length-4;(80!=r[a]||75!=r[a+1]||5!=r[a+2]||6!=r[a+3])&&a>=0;)--a;r.l=a+4,r.l+=4;var i=r.read_shift(2);r.l+=6;var o=r.read_shift(4);for(r.l=o,a=0;a<i;++a){r.l+=20;var l=r.read_shift(4),c=r.read_shift(4),u=r.read_shift(2),d=r.read_shift(2),f=r.read_shift(2);r.l+=8;var m=r.read_shift(4),p=s(r.slice(r.l+u,r.l+u+d));r.l+=u+d+f;var g=r.l;r.l=m+4,ae(r,l,c,n,p),r.l=g}return n}function ae(e,t,r,n,a){e.l+=2;var i=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),n=new Date,a=31&r,s=15&(r>>>=5);r>>>=4,n.setMilliseconds(0),n.setFullYear(r+1980),n.setMonth(s-1),n.setDate(a);var i=31&t,o=63&(t>>>=5);return t>>>=6,n.setHours(t),n.setMinutes(o),n.setSeconds(i<<1),n}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2),h=e.read_shift(2),f="",m=0;m<d;++m)f+=String.fromCharCode(e[e.l++]);if(h){var g=s(e.slice(e.l,e.l+h));(g[21589]||{}).mt&&(l=g[21589].mt),((a||{})[21589]||{}).mt&&(l=a[21589].mt)}e.l+=h;var v=e.slice(e.l,e.l+c);switch(o){case 8:v=function(e,t){if(!p)return te(e,t);var r=new(0,p.InflateRaw),n=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,n}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var b=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),b=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&re(b,"Bad compressed size: "+t+" != "+c),u!=r&&re(b,"Bad uncompressed size: "+r+" != "+u),ue(n,f,v,{unsafe:!0,mt:l})}var se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,t){if(e.ctype)return e.ctype;var r=e.name||"",n=r.match(/\.([^\.]+)$/);return n&&se[n[1]]||t&&(n=(r=t).match(/[\.\\]([^\.\\])+$/))&&se[n[1]]?se[n[1]]:"application/octet-stream"}function oe(e){for(var t=Gn(e),r=[],n=0;n<t.length;n+=76)r.push(t.slice(n,n+76));return r.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],n=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<n.length;++a){var s=n[a];if(0!=s.length)for(var i=0;i<s.length;){var o=76,l=s.slice(i,i+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=s.slice(i,i+o),(i+=o)<s.length&&(l+="="),r.push(l)}else r.push("")}return r.join("\r\n")}function ce(e,t,r){for(var n,a="",s="",i="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":s=c[2].trim()}}switch(++o,s.toLowerCase()){case"base64":n=Xn(qn(t.slice(o).join("")));break;case"quoted-printable":n=function(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r];r<=e.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+e[++r];t.push(n)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return Xn(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+s)}var u=ue(e,a.slice(r.length),n,{unsafe:!0});i&&(u.ctype=i)}function ue(e,t,r,a){var s=a&&a.unsafe;s||h(e);var i=!s&&Ja.find(e,t);if(!i){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),i={name:n(t),type:2},e.FileIndex.push(i),e.FullPaths.push(o),s||Ja.utils.cfb_gc(e)}return i.content=r,i.size=r?r.length:0,a&&(a.CLSID&&(i.clsid=a.CLSID),a.mt&&(i.mt=a.mt),a.ct&&(i.ct=a.ct)),i}return t.find=function(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()}),n=r.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),a=!1;47===t.charCodeAt(0)?(a=!0,t=r[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var s=t.toUpperCase(),i=!0===a?r.indexOf(s):n.indexOf(s);if(-1!==i)return e.FileIndex[i];var o=!s.match(ra);for(s=s.replace(ta,""),o&&(s=s.replace(ra,"!")),i=0;i<r.length;++i){if((o?r[i].replace(ra,"!"):r[i]).replace(ta,"")==s)return e.FileIndex[i];if((o?n[i].replace(ra,"!"):n[i]).replace(ta,"")==s)return e.FileIndex[i]}return null},t.read=function(t,r){var n=r&&r.type;switch(n||Kn&&Buffer.isBuffer(t)&&(n="buffer"),n||"base64"){case"file":return function(t,r){return i(),o(e.readFileSync(t),r)}(t,r);case"base64":return o(Xn(qn(t)),r);case"binary":return o(Xn(t),r)}return o(t,r)},t.parse=o,t.write=function(t,r){var n=m(t,r);switch(r&&r.type||"buffer"){case"file":return i(),e.writeFileSync(r.filename,n),n;case"binary":return"string"==typeof n?n:S(n);case"base64":return Gn("string"==typeof n?n:S(n));case"buffer":if(Kn)return Buffer.isBuffer(n)?n:$n(n);case"array":return"string"==typeof n?Xn(n):n}return n},t.writeFile=function(t,r,n){i();var a=m(t,n);e.writeFileSync(r,a)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:ue,cfb_del:function(e,t){h(e);var r=Ja.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,r){h(e);var a=Ja.find(e,t);if(a)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==a)return e.FileIndex[s].name=n(r),e.FullPaths[s]=r,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:Ui,CheckField:Vi,prep_blob:Gi,bconcat:ea,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(r){console.error("cannot use native zlib: "+(r.message||r))}},_deflateRaw:$,_inflateRaw:te,consts:w},t}();let Xa;function Qa(e){return"string"===typeof e?Qn(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function Za(e,t,r){if("undefined"!==typeof Xa&&Xa.writeFileSync)return r?Xa.writeFileSync(e,t,r):Xa.writeFileSync(e,t);if("undefined"!==typeof Deno){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Qn(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n="utf8"==r?Ms(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(n,e);if("undefined"!==typeof Blob){var a=new Blob([Qa(n)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if("undefined"!==typeof saveAs)return saveAs(a,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(null!=i.download)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Zn(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function es(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function ts(e,t){for(var r=[],n=es(e),a=0;a!==n.length;++a)null==r[e[n[a]][t]]&&(r[e[n[a]][t]]=n[a]);return r}function rs(e){for(var t=[],r=es(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function ns(e){for(var t=[],r=es(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}var as=new Date(1899,11,30,0,0,0);function ss(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(as.getTime()+6e4*(e.getTimezoneOffset()-as.getTimezoneOffset())))/864e5}var is=new Date,os=as.getTime()+6e4*(is.getTimezoneOffset()-as.getTimezoneOffset()),ls=is.getTimezoneOffset();function cs(e){var t=new Date;return t.setTime(24*e*60*60*1e3+os),t.getTimezoneOffset()!==ls&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-ls)),t}var us=new Date("2017-02-19T19:06:09.000Z"),ds=isNaN(us.getFullYear())?new Date("2/19/17"):us,hs=2017==ds.getFullYear();function fs(e,t){var r=new Date(e);if(hs)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==ds.getFullYear()&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function ms(e,t){if(Kn&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return Ms(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Ms(zn(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Ms(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Ms(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return r[e]||e})}catch(s){}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function ps(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ps(e[r]));return t}function gs(e,t){for(var r="";r.length<t;)r+=e;return r}function vs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return isNaN(t=Number(n))?(n=n.replace(/[(](.*)[)]/,function(e,t){return r=-r,t}),isNaN(t=Number(n))?t:t/r):t/r}var bs=["january","february","march","april","may","june","july","august","september","october","november","december"];function ys(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==bs.indexOf(i))return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&101!=n?t:e.match(/[^-0-9:,\/\\]/)?r:t}function xs(e,t,r){if(e.FullPaths){var n;if("string"==typeof r)return n=Kn?$n(r):function(e){for(var t=[],r=0,n=e.length+250,a=Yn(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var o=1023&e.charCodeAt(++s);a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(3&i)<<4,a[r++]=128|63&o}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|63&i;r>n&&(t.push(a.slice(0,r)),r=0,a=Yn(65535),n=65530)}return t.push(a.slice(0,r)),ea(t)}(r),Ja.utils.cfb_add(e,t,n);Ja.utils.cfb_add(e,t,r)}else e.file(t,r)}function ws(){return Ja.utils.cfb_new()}var Ss='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var _s={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Es=rs(_s),ks=/[&<>'"]/g,Ts=/[\u0000-\u0008\u000b-\u001f]/g;function Ns(e){return(e+"").replace(ks,function(e){return Es[e]}).replace(Ts,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function js(e){return Ns(e).replace(/ /g,"_x0020_")}var As=/[\u0000-\u001f]/g;function Cs(e){return(e+"").replace(ks,function(e){return Es[e]}).replace(/\n/g,"<br/>").replace(As,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function Os(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ps(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;)(n=e.charCodeAt(r++))<128?t+=String.fromCharCode(n):(a=e.charCodeAt(r++),n>191&&n<224?(i=(31&n)<<6,i|=63&a,t+=String.fromCharCode(i)):(s=e.charCodeAt(r++),n<240?t+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&s):(o=((7&n)<<18|(63&a)<<12|(63&s)<<6|63&(i=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function Rs(e){var t,r,n,a=Yn(2*e.length),s=1,i=0,o=0;for(r=0;r<e.length;r+=s)s=1,(n=e.charCodeAt(r))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(r+1)),s=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),s=3):(s=4,t=262144*(7&n)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[i++]=255&o,a[i++]=o>>>8,o=0),a[i++]=t%256,a[i++]=t>>>8;return a.slice(0,i).toString("ucs2")}function Is(e){return $n(e,"binary").toString("utf8")}var Ds="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Ls=Kn&&(Is(Ds)==Ps(Ds)&&Is||Rs(Ds)==Ps(Ds)&&Rs)||Ps,Ms=Kn?function(e){return $n(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")},Fs=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)r=r.replace(e[n][0],e[n][1]);return r}}();var Us=/(^\s|\s$|\n)/;function zs(e,t){return"<"+e+(t.match(Us)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Bs(e){return es(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Hs(e,t,r){return"<"+e+(null!=r?Bs(r):"")+(null!=t?(t.match(Us)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ws(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}var Vs="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Gs="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",qs="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Ks="http://schemas.openxmlformats.org/package/2006/content-types",$s="http://schemas.openxmlformats.org/package/2006/relationships",Ys="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Js="http://purl.org/dc/elements/1.1/",Xs="http://purl.org/dc/terms/",Qs="http://purl.org/dc/dcmitype/",Zs="http://schemas.openxmlformats.org/officeDocument/2006/relationships",ei="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",ti="http://www.w3.org/2001/XMLSchema-instance",ri="http://www.w3.org/2001/XMLSchema",ni=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ai="urn:schemas-microsoft-com:office:office",si="urn:schemas-microsoft-com:office:excel",ii="urn:schemas-microsoft-com:office:spreadsheet",oi="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",li="http://macVmlSchemaUri",ci="urn:schemas-microsoft-com:vml",ui="http://www.w3.org/TR/REC-html40";var di=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var n=0,a=e[0][r].length;n<a;n+=10240)t.push.apply(t,e[0][r].slice(n,n+10240));return t},hi=Kn?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:$n(e)})):di(e)}:di,fi=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ii(e,a)));return n.join("").replace(ta,"")},mi=Kn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ta,""):fi(e,t,r)}:fi,pi=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},gi=Kn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):pi(e,t,r)}:pi,vi=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Ri(e,a)));return n.join("")},bi=Kn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):vi(e,t,r)}:vi,yi=function(e,t){var r=Li(e,t);return r>0?bi(e,t+4,t+4+r-1):""},xi=yi,wi=function(e,t){var r=Li(e,t);return r>0?bi(e,t+4,t+4+r-1):""},Si=wi,_i=function(e,t){var r=2*Li(e,t);return r>0?bi(e,t+4,t+4+r-1):""},Ei=_i,ki=function(e,t){var r=Li(e,t);return r>0?mi(e,t+4,t+4+r):""},Ti=ki,Ni=function(e,t){var r=Li(e,t);return r>0?bi(e,t+4,t+4+r):""},ji=Ni,Ai=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],s=5;s>=0;--s)a=256*a+e[t+s];return 2047==n?0==a?r*(1/0):NaN:(0==n?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}(e,t)},Ci=Ai,Oi=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function Pi(){mi=function(e,t,r){return Bn.utils.decode(1200,e.slice(t,r)).replace(ta,"")},bi=function(e,t,r){return Bn.utils.decode(65001,e.slice(t,r))},xi=function(e,t){var r=Li(e,t);return r>0?Bn.utils.decode(In,e.slice(t+4,t+4+r-1)):""},Si=function(e,t){var r=Li(e,t);return r>0?Bn.utils.decode(Rn,e.slice(t+4,t+4+r-1)):""},Ei=function(e,t){var r=2*Li(e,t);return r>0?Bn.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Ti=function(e,t){var r=Li(e,t);return r>0?Bn.utils.decode(1200,e.slice(t+4,t+4+r)):""},ji=function(e,t){var r=Li(e,t);return r>0?Bn.utils.decode(65001,e.slice(t+4,t+4+r)):""}}Kn&&(xi=function(e,t){if(!Buffer.isBuffer(e))return yi(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Si=function(e,t){if(!Buffer.isBuffer(e))return wi(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Ei=function(e,t){if(!Buffer.isBuffer(e))return _i(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},Ti=function(e,t){if(!Buffer.isBuffer(e))return ki(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},ji=function(e,t){if(!Buffer.isBuffer(e))return Ni(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},Ci=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Ai(e,t)},Oi=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof Bn&&Pi();var Ri=function(e,t){return e[t]},Ii=function(e,t){return 256*e[t+1]+e[t]},Di=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},Li=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Mi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Fi=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ui(e,t){var r,n,a,s,i,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,Kn&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)l+=String.fromCharCode(Ii(this,o)),o+=2;e*=2;break;case"utf8":l=bi(this,this.l,this.l+e);break;case"utf16le":e*=2,l=mi(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof Bn)return Ui.call(this,e,"dbcs");l=Bn.utils.decode(Rn,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=xi(this,this.l),e=4+Li(this,this.l);break;case"lpstr-cp":l=Si(this,this.l),e=4+Li(this,this.l);break;case"lpwstr":l=Ei(this,this.l),e=4+2*Li(this,this.l);break;case"lpp4":e=4+Li(this,this.l),l=Ti(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Li(this,this.l),l=ji(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(a=Ri(this,this.l+e++));)c.push(Hn(a));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(a=Ii(this,this.l+e));)c.push(Hn(a)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=Ri(this,o),this.l=o+1,s=Ui.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(Hn(Ii(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof Bn){l=Bn.utils.decode(Rn,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=Ri(this,o),this.l=o+1,s=Ui.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(Hn(Ri(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return r=Ri(this,this.l),this.l++,r;case 2:return r=("i"===t?Di:Ii)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(r=(e>0?Mi:Fi)(this,this.l),this.l+=4,r):(n=Li(this,this.l),this.l+=4,n);case 8:case-8:if("f"===t)return n=8==e?Ci(this,this.l):Ci([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:l=gi(this,this.l,e)}}return this.l+=e,l}var zi=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Bi=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Hi=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function Wi(e,t,r){var n=0,a=0;if("dbcs"===r){for(a=0;a!=t.length;++a)Hi(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if("sbcs"===r){if("undefined"!==typeof Bn&&874==In)for(a=0;a!=t.length;++a){var s=Bn.utils.encode(In,t.charAt(a));this[this.l+a]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);n=t.length}else{if("hex"===r){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===r){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,zi(this,t,this.l);break;case 8:if(n=8,"f"===r){!function(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?0==i?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=255&s;e[r+6]=(15&a)<<4|15&s,e[r+7]=a>>4|n}(this,t,this.l);break}case 16:break;case-4:n=4,Bi(this,t,this.l)}}return this.l+=n,this}function Vi(e,t){var r=gi(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Gi(e,t){e.l=t,e.read_shift=Ui,e.chk=Vi,e.write_shift=Wi}function qi(e,t){e.l+=t}function Ki(e){var t=Yn(e);return Gi(t,0),t}function $i(){var e=[],t=Kn?256:2048,r=function(e){var t=Ki(e);return Gi(t,0),t},n=r(t),a=function(){n&&(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&e.push(n),n=null)},s=function(e){return n&&e<n.length-n.l?n:(a(),n=r(Math.max(e+1,t)))};return{next:s,push:function(e){a(),null==(n=e).l&&(n.l=n.length),s(t)},end:function(){return a(),ea(e)},_bufs:e}}function Yi(e,t,r,n){var a,s=+t;if(!isNaN(s)){n||(n=dd[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,128+(127&s)),i.write_shift(1,s>>7));for(var o=0;4!=o;++o){if(!(n>=128)){i.write_shift(1,n);break}i.write_shift(1,128+(127&n)),n>>=7}n>0&&Oi(r)&&e.push(r)}}function Ji(e,t,r){var n=ps(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Xi(e,t,r){var n=ps(e);return n.s=Ji(n.s,t.s,r),n.e=Ji(n.e,t.s,r),n}function Qi(e,t){if(e.cRel&&e.c<0)for(e=ps(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ps(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=so(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function Zi(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?Qi(e.s,t.biff)+":"+Qi(e.e,t.biff):(e.s.rRel?"":"$")+to(e.s.r)+":"+(e.e.rRel?"":"$")+to(e.e.r):(e.s.cRel?"":"$")+no(e.s.c)+":"+(e.e.cRel?"":"$")+no(e.e.c)}function eo(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function to(e){return""+(e+1)}function ro(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function no(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function ao(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function so(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function io(e){var t=e.indexOf(":");return-1==t?{s:ao(e),e:ao(e)}:{s:ao(e.slice(0,t)),e:ao(e.slice(t+1))}}function oo(e,t){return"undefined"===typeof t||"number"===typeof t?oo(e.s,e.e):("string"!==typeof e&&(e=so(e)),"string"!==typeof t&&(t=so(t)),e==t?e:e+":"+t)}function lo(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function co(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Va(e.z,r?ss(t):t)}catch(n){}try{return e.w=Va((e.XF||{}).numFmtId||(r?14:0),r?ss(t):t)}catch(n){return""+t}}function uo(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?qo[e.v]||e.v:co(e,void 0==t?e.v:t))}function ho(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function fo(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense;var s=e||(a?[]:{}),i=0,o=0;if(s&&null!=n.origin){if("number"==typeof n.origin)i=n.origin;else{var l="string"==typeof n.origin?ao(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=lo(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==i&&(c.e.r=i=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if("undefined"!==typeof t[d][h]){var f={v:t[d][h]},m=i+d,p=o+h;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),!t[d][h]||"object"!==typeof t[d][h]||Array.isArray(t[d][h])||t[d][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[d][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else{if(!n.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=n.dateNF||ha[14],n.cellDates?(f.t="d",f.w=Va(f.z,ss(f.v))):(f.t="n",f.v=ss(f.v),f.w=Va(f.z,f.v))):f.t="s";else f=t[d][h];if(a)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(f.z=s[m][p].z),s[m][p]=f;else{var g=so({c:p,r:m});s[g]&&s[g].z&&(f.z=s[g].z),s[g]=f}}}return c.s.c<1e7&&(s["!ref"]=oo(c)),s}function mo(e,t){return fo(null,e,t)}function po(e,t){return t||(t=Ki(4)),t.write_shift(4,e),t}function go(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function vo(e,t){var r=!1;return null==t&&(r=!0,t=Ki(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function bo(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function yo(e,t){var r=e.l,n=e.read_shift(1),a=go(e),s=[],i={t:a,h:a};if(0!==(1&n)){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(bo(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var xo=yo;function wo(e,t){var r=!1;return null==t&&(r=!0,t=Ki(23+4*e.t.length)),t.write_shift(1,1),vo(e.t,t),t.write_shift(4,1),function(e,t){t||(t=Ki(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function So(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function _o(e,t){return null==t&&(t=Ki(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Eo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ko(e,t){return null==t&&(t=Ki(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var To=go,No=vo;function jo(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function Ao(e,t){var r=!1;return null==t&&(r=!0,t=Ki(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Co=go,Oo=jo,Po=Ao;function Ro(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0];e.l+=4;var a=0===n?Ci([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Mi(t,0)>>2;return r?a/100:a}function Io(e,t){null==t&&(t=Ki(4));var r=0,n=0,a=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?n=1:a==(0|a)&&a>=-(1<<29)&&a<1<<29&&(n=1,r=1),!n)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((r?a:e)<<2)+(r+2))}function Do(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Lo=Do,Mo=function(e,t){return t||(t=Ki(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function Fo(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Uo(e,t){return(t||Ki(8)).write_shift(8,e,"f")}function zo(e,t){if(t||(t=Ki(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),e.rgb&&null==e.theme){var n=e.rgb||"FFFFFF";"number"==typeof n&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}var Bo=80,Ho={1:{n:"CodePage",t:2},2:{n:"Category",t:Bo},3:{n:"PresentationFormat",t:Bo},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Bo},15:{n:"Company",t:Bo},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Bo},27:{n:"ContentStatus",t:Bo},28:{n:"Language",t:Bo},29:{n:"Version",t:Bo},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Wo={1:{n:"CodePage",t:2},2:{n:"Title",t:Bo},3:{n:"Subject",t:Bo},4:{n:"Author",t:Bo},5:{n:"Keywords",t:Bo},6:{n:"Comments",t:Bo},7:{n:"Template",t:Bo},8:{n:"LastAuthor",t:Bo},9:{n:"RevNumber",t:Bo},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Bo},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function Vo(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var Go=ps(Vo([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),qo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ko={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},$o={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Yo(e,t){var r,n=function(e){for(var t=[],r=es(e),n=0;n!==r.length;++n)null==t[e[r[n]]]&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}(Ko),a=[];a[a.length]=Ss,a[a.length]=Hs("Types",null,{xmlns:Ks,"xmlns:xsd":ri,"xmlns:xsi":ti}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return Hs("Default",null,{Extension:e[0],ContentType:e[1]})}));var s=function(n){e[n]&&e[n].length>0&&(r=e[n][0],a[a.length]=Hs("Override",null,{PartName:("/"==r[0]?"":"/")+r,ContentType:$o[n][t.bookType]||$o[n].xlsx}))},i=function(r){(e[r]||[]).forEach(function(e){a[a.length]=Hs("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:$o[r][t.bookType]||$o[r].xlsx})})},o=function(t){(e[t]||[]).forEach(function(e){a[a.length]=Hs("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:n[t][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Jo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Xo(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Qo(e){var t=[Ss,Hs("Relationships",null,{xmlns:$s})];return es(e["!id"]).forEach(function(r){t[t.length]=Hs("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Zo(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,s?a.TargetMode=s:[Jo.HLINK,Jo.XPATH,Jo.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function el(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function tl(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function rl(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Pn.version+"</meta:generator></office:meta></office:document-meta>"}var nl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function al(e,t,r,n,a){null==a[e]&&null!=t&&""!==t&&(a[e]=t,t=Ns(t),n[n.length]=r?Hs(e,t,r):zs(e,t))}function sl(e,t){var r=t||{},n=[Ss,Hs("cp:coreProperties",null,{"xmlns:cp":Vs,"xmlns:dc":Js,"xmlns:dcterms":Xs,"xmlns:dcmitype":Qs,"xmlns:xsi":ti})],a={};if(!e&&!r.Props)return n.join("");e&&(null!=e.CreatedDate&&al("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:Ws(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),null!=e.ModifiedDate&&al("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:Ws(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=nl.length;++s){var i=nl[s],o=r.Props&&null!=r.Props[i[1]]?r.Props[i[1]]:e?e[i[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&al(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var il=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],ol=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ll(e){var t=[],r=Hs;return e||(e={}),e.Application="SheetJS",t[t.length]=Ss,t[t.length]=Hs("Properties",null,{xmlns:qs,"xmlns:vt":ei}),il.forEach(function(n){if(void 0!==e[n[1]]){var a;switch(n[2]){case"string":a=Ns(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false"}void 0!==a&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+Ns(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function cl(e){var t=[Ss,Hs("Properties",null,{xmlns:Gs,"xmlns:vt":ei})];if(!e)return t.join("");var r=1;return es(e).forEach(function(n){++r,t[t.length]=Hs("property",function(e,t){switch(typeof e){case"string":var r=Hs("vt:lpwstr",Ns(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return Hs((0|e)==e?"vt:i4":"vt:r8",Ns(String(e)));case"boolean":return Hs("vt:bool",e?"true":"false")}if(e instanceof Date)return Hs("vt:filetime",Ws(e));throw new Error("Unable to serialize "+e)}(e[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ns(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ul={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function dl(e,t){var r=Ki(4),n=Ki(4);switch(r.write_shift(4,80==e?31:e),e){case 3:n.write_shift(-4,t);break;case 5:(n=Ki(8)).write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,r=t%Math.pow(2,32),n=(t-r)/Math.pow(2,32);n*=1e7;var a=(r*=1e7)/Math.pow(2,32)|0;a>0&&(r%=Math.pow(2,32),n+=a);var s=Ki(8);return s.write_shift(4,r),s.write_shift(4,n),s}(t);break;case 31:case 80:for((n=Ki(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ea([r,n])}var hl=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function fl(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function ml(e,t,r){var n=Ki(8),a=[],s=[],i=8,o=0,l=Ki(8),c=Ki(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),a.push(c),i+=8+l.length,!t){(c=Ki(8)).write_shift(4,0),a.unshift(c);var u=[Ki(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for((l=Ki(8+2*(d.length+1)+(d.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=ea(u),s.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(hl.indexOf(e[o][0])>-1||ol.indexOf(e[o][0])>-1)&&null!=e[o][1]){var h=e[o][1],f=0;if(t){var m=r[f=+t[e[o][0]]];if("version"==m.p&&"string"==typeof h){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=dl(m.t,h)}else{var g=fl(h);-1==g&&(g=31,h=String(h)),l=dl(g,h)}s.push(l),(c=Ki(8)).write_shift(4,t?f:2+o),a.push(c),i+=8+l.length}var v=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,v),v+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),ea([n].concat(a).concat(s))}function pl(e,t,r,n,a,s){var i=Ki(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ja.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var l=ml(e,r,n);if(o.push(l),a){var c=ml(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+l.length),o.push(c)}return ea(o)}function gl(e,t){return 1===e.read_shift(t)}function vl(e,t){return t||(t=Ki(2)),t.write_shift(2,+!!e),t}function bl(e){return e.read_shift(2,"u")}function yl(e,t){return t||(t=Ki(2)),t.write_shift(2,e),t}function xl(e,t,r){return r||(r=Ki(2)),r.write_shift(1,"e"==t?+e:+!!e),r.write_shift(1,"e"==t?1:0),r}function wl(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",s=Rn;(r&&r.biff>=8&&(Rn=1200),r&&8!=r.biff)?12==r.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return Rn=s,i}function Sl(e){var t=e.t||"",r=Ki(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Ki(2*t.length);return n.write_shift(2*t.length,t,"utf16le"),ea([r,n])}function _l(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function El(e,t,r){var n=e.read_shift(r&&2==r.biff?1:2);return 0===n?(e.l++,""):_l(e,n,r)}function kl(e,t,r){if(r.biff>5)return El(e,0,r);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Tl(e,t,r){return r||(r=Ki(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Nl(e,t){t||(t=Ki(6+2*e.length)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function jl(e){var t=Ki(512),r=0,n=e.Target;"file://"==n.slice(0,7)&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(28==s)Nl(n=n.slice(1),t);else if(2&s){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),8&s&&Nl(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;"../"==n.slice(3*l,3*l+3)||"..\\"==n.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,255&n.charCodeAt(r+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Al(e,t,r,n){return n||(n=Ki(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Cl(e,t,r){var n=r.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function Ol(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function Pl(e,t){return t||(t=Ki(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Rl(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":case"xla":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;default:throw new Error("unsupported BIFF version")}var s=Ki(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Il(e,t){var r=!t||t.biff>=8?2:1,n=Ki(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function Dl(e,t,r,n){var a=r&&5==r.biff;n||(n=Ki(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return null==s.l&&(s.l=s.length),s}function Ll(e,t,r,n){var a=r&&5==r.biff;n||(n=Ki(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function Ml(e,t,r){if(r.biff<8)return function(e,t,r){3==e[e.l+1]&&e[e.l]++;var n=wl(e,0,r);return 3==n.charCodeAt(0)?n.slice(1):n}(e,0,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);0!==s--;)n.push(Cl(e,r.biff,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Fl(e){var t=Ki(24),r=ao(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return ea([t,jl(e[1])])}function Ul(e){var t=e[1].Tooltip,r=Ki(10+2*(t.length+1));r.write_shift(2,2048);var n=ao(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function zl(e,t,r){if(!r.cellStyles)return qi(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);2==n&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}var Bl=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=rs({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var n=r||{};n.dateNF||(n.dateNF="yyyymmdd");var a=mo(function(t,r){var n=[],a=Yn(1);switch(r.type){case"base64":a=Xn(qn(t));break;case"binary":a=Xn(t);break;case"buffer":case"array":a=t}Gi(a,0);var s=a.read_shift(1),i=!!(136&s),o=!1,l=!1;switch(s){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,i=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var c=0,u=521;2==s&&(c=a.read_shift(2)),a.l+=3,2!=s&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=s&&(u=a.read_shift(2));var d=a.read_shift(2),h=r.codepage||1252;2!=s&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(h=e[a[a.l]]),a.l+=1,a.l+=2),l&&(a.l+=36);for(var f=[],m={},p=Math.min(a.length,2==s?521:u-10-(o?264:0)),g=l?32:11;a.l<p&&13!=a[a.l];)switch((m={}).name=Bn.utils.decode(h,a.slice(a.l,a.l+g)).replace(/[\u0000\r\n].*$/g,""),a.l+=g,m.type=String.fromCharCode(a.read_shift(1)),2==s||l||(m.offset=a.read_shift(4)),m.len=a.read_shift(1),2==s&&(m.offset=a.read_shift(2)),m.dec=a.read_shift(1),m.name.length&&f.push(m),2!=s&&(a.l+=l?13:14),m.type){case"B":o&&8==m.len||!r.WTF||console.log("Skipping "+m.name+":"+m.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+m.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var v=0,b=0;for(n[0]=[],b=0;b!=f.length;++b)n[0][b]=f[b].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,n[++v]=[],b=0,b=0;b!=f.length;++b){var y=a.slice(a.l,a.l+f[b].len);a.l+=f[b].len,Gi(y,0);var x=Bn.utils.decode(h,y);switch(f[b].type){case"C":x.trim().length&&(n[v][b]=x.replace(/\s+$/,""));break;case"D":8===x.length?n[v][b]=new Date(+x.slice(0,4),+x.slice(4,6)-1,+x.slice(6,8)):n[v][b]=x;break;case"F":n[v][b]=parseFloat(x.trim());break;case"+":case"I":n[v][b]=l?2147483648^y.read_shift(-4,"i"):y.read_shift(4,"i");break;case"L":switch(x.trim().toUpperCase()){case"Y":case"T":n[v][b]=!0;break;case"N":case"F":n[v][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+x+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));n[v][b]="##MEMO##"+(l?parseInt(x.trim(),10):y.read_shift(4));break;case"N":(x=x.replace(/\u0000/g,"").trim())&&"."!=x&&(n[v][b]=+x||0);break;case"@":n[v][b]=new Date(y.read_shift(-8,"f")-621356832e5);break;case"T":n[v][b]=new Date(864e5*(y.read_shift(4)-2440588)+y.read_shift(4));break;case"Y":n[v][b]=y.read_shift(4,"i")/1e4+y.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[v][b]=-y.read_shift(-8,"f");break;case"B":if(o&&8==f[b].len){n[v][b]=y.read_shift(8,"f");break}case"G":case"P":y.l+=f[b].len;break;case"0":if("_NullFlags"===f[b].name)break;default:throw new Error("DBF Unsupported data type "+f[b].type)}}else a.l+=d;if(2!=s&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return r&&r.sheetRows&&(n=n.slice(0,r.sheetRows)),r.DBF=f,n}(t,n),n);return a["!cols"]=n.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete n.DBF,a}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return ho(r(e,t),t)}catch(n){if(t&&t.WTF)throw n}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var a=r||{};if(+a.codepage>=0&&Fn(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var s=$i(),i=lh(e,{header:1,raw:!0,cellDates:!0}),o=i[0],l=i.slice(1),c=e["!cols"]||[],u=0,d=0,h=0,f=1;for(u=0;u<o.length;++u)if(((c[u]||{}).DBF||{}).name)o[u]=c[u].DBF.name,++h;else if(null!=o[u]){if(++h,"number"===typeof o[u]&&(o[u]=o[u].toString(10)),"string"!==typeof o[u])throw new Error("DBF Invalid column name "+o[u]+" |"+typeof o[u]+"|");if(o.indexOf(o[u])!==u)for(d=0;d<1024;++d)if(-1==o.indexOf(o[u]+"_"+d)){o[u]+="_"+d;break}}var m=lo(e["!ref"]),p=[],g=[],v=[];for(u=0;u<=m.e.c-m.s.c;++u){var b="",y="",x=0,w=[];for(d=0;d<l.length;++d)null!=l[d][u]&&w.push(l[d][u]);if(0!=w.length&&null!=o[u]){for(d=0;d<w.length;++d){switch(typeof w[d]){case"number":y="B";break;case"string":default:y="C";break;case"boolean":y="L";break;case"object":y=w[d]instanceof Date?"D":"C"}x=Math.max(x,String(w[d]).length),b=b&&b!=y?"C":y}x>250&&(x=250),"C"==(y=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>x&&(x=c[u].DBF.len),"B"==b&&"N"==y&&(b="N",v[u]=c[u].DBF.dec,x=c[u].DBF.len),g[u]="C"==b||"N"==y?x:n[b]||0,f+=g[u],p[u]=b}else p[u]="?"}var S=s.next(32);for(S.write_shift(4,318902576),S.write_shift(4,l.length),S.write_shift(2,296+32*h),S.write_shift(2,f),u=0;u<4;++u)S.write_shift(4,0);for(S.write_shift(4,(+t[In]||3)<<8),u=0,d=0;u<o.length;++u)if(null!=o[u]){var _=s.next(32),E=(o[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);_.write_shift(1,E,"sbcs"),_.write_shift(1,"?"==p[u]?"C":p[u],"sbcs"),_.write_shift(4,d),_.write_shift(1,g[u]||n[p[u]]||0),_.write_shift(1,v[u]||0),_.write_shift(1,2),_.write_shift(4,0),_.write_shift(1,0),_.write_shift(4,0),_.write_shift(4,0),d+=g[u]||n[p[u]]||0}var k=s.next(264);for(k.write_shift(4,13),u=0;u<65;++u)k.write_shift(4,0);for(u=0;u<l.length;++u){var T=s.next(f);for(T.write_shift(1,0),d=0;d<o.length;++d)if(null!=o[d])switch(p[d]){case"L":T.write_shift(1,null==l[u][d]?63:l[u][d]?84:70);break;case"B":T.write_shift(8,l[u][d]||0,"f");break;case"N":var N="0";for("number"==typeof l[u][d]&&(N=l[u][d].toFixed(v[d]||0)),h=0;h<g[d]-N.length;++h)T.write_shift(1,32);T.write_shift(1,N,"sbcs");break;case"D":l[u][d]?(T.write_shift(4,("0000"+l[u][d].getFullYear()).slice(-4),"sbcs"),T.write_shift(2,("00"+(l[u][d].getMonth()+1)).slice(-2),"sbcs"),T.write_shift(2,("00"+l[u][d].getDate()).slice(-2),"sbcs")):T.write_shift(8,"00000000","sbcs");break;case"C":var j=String(null!=l[u][d]?l[u][d]:"").slice(0,g[d]);for(T.write_shift(1,j,"sbcs"),h=0;h<g[d]-j.length;++h)T.write_shift(1,32)}}return s.next(1).write_shift(1,26),s.end()}}}(),Hl=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+es(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var n=e[r];return"number"==typeof n?Wn(n):n},n=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==n?e:Wn(n)};function a(e,a){var s,i=e.split(/[\n\r]+/),o=-1,l=-1,c=0,u=0,d=[],h=[],f=null,m={},p=[],g=[],v=[],b=0;for(+a.codepage>=0&&Fn(+a.codepage);c!==i.length;++c){b=0;var y,x=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),w=x.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),S=w[0];if(x.length>0)switch(S){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&h.push(x.slice(3).replace(/;;/g,";"));break;case"C":var _=!1,E=!1,k=!1,T=!1,N=-1,j=-1;for(u=1;u<w.length;++u)switch(w[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(w[u].slice(1))-1,E=!0;break;case"Y":for(o=parseInt(w[u].slice(1))-1,E||(l=0),s=d.length;s<=o;++s)d[s]=[];break;case"K":'"'===(y=w[u].slice(1)).charAt(0)?y=y.slice(1,y.length-1):"TRUE"===y?y=!0:"FALSE"===y?y=!1:isNaN(vs(y))?isNaN(ys(y).getDate())||(y=fs(y)):(y=vs(y),null!==f&&za(f)&&(y=cs(y))),"undefined"!==typeof Bn&&"string"==typeof y&&"string"!=(a||{}).type&&(a||{}).codepage&&(y=Bn.utils.decode(a.codepage,y)),_=!0;break;case"E":T=!0;var A=Rc(w[u].slice(1),{r:o,c:l});d[o][l]=[d[o][l],A];break;case"S":k=!0,d[o][l]=[d[o][l],"S5S"];break;case"R":N=parseInt(w[u].slice(1))-1;break;case"C":j=parseInt(w[u].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+x)}if(_&&(d[o][l]&&2==d[o][l].length?d[o][l][0]=y:d[o][l]=y,f=null),k){if(T)throw new Error("SYLK shared formula cannot have own formula");var C=N>-1&&d[N][j];if(!C||!C[1])throw new Error("SYLK shared formula cannot find base");d[o][l][1]=Lc(C[1],{r:o-N,c:l-j})}break;case"F":var O=0;for(u=1;u<w.length;++u)switch(w[u].charAt(0)){case"X":l=parseInt(w[u].slice(1))-1,++O;break;case"Y":for(o=parseInt(w[u].slice(1))-1,s=d.length;s<=o;++s)d[s]=[];break;case"M":b=parseInt(w[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(w[u].slice(1))];break;case"W":for(v=w[u].slice(1).split(" "),s=parseInt(v[0],10);s<=parseInt(v[1],10);++s)b=parseInt(v[2],10),g[s-1]=0===b?{hidden:!0}:{wch:b},sc(g[s-1]);break;case"C":g[l=parseInt(w[u].slice(1))-1]||(g[l]={});break;case"R":p[o=parseInt(w[u].slice(1))-1]||(p[o]={}),b>0?(p[o].hpt=b,p[o].hpx=lc(b)):0===b&&(p[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+x)}O<1&&(f=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+x)}}return p.length>0&&(m["!rows"]=p),g.length>0&&(m["!cols"]=g),a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),[d,m]}function s(e,t){var r=function(e,t){switch(t.type){case"base64":return a(qn(e),t);case"binary":return a(e,t);case"buffer":return a(Kn&&Buffer.isBuffer(e)?e.toString("binary"):Zn(e),t);case"array":return a(ms(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=r[0],s=r[1],i=mo(n,t);return es(s).forEach(function(e){i[e]=s[e]}),i}function i(e,t,r,n){var a="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+Dc(e.f,{r:r,c:n}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return ho(s(e,t),t)},to_sheet:s,from_sheet:function(e,t){var r,n,a=["ID;PWXL;N;E"],s=[],o=lo(e["!ref"]),l=Array.isArray(e),c="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(n=a,e["!cols"].forEach(function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=rc(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=nc(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&n.push(r)})),e["!rows"]&&function(e,t){t.forEach(function(t,r){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*oc(t.hpx)+";"),n.length>2&&e.push(n+"R"+(r+1))})}(a,e["!rows"]),a.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var u=o.s.r;u<=o.e.r;++u)for(var d=o.s.c;d<=o.e.c;++d){var h=so({r:u,c:d});(r=l?(e[u]||[])[d]:e[h])&&(null!=r.v||r.f&&!r.F)&&s.push(i(r,0,u,d))}return a.join(c)+c+s.join(c)+c+"E"+c}}}(),Wl=function(){function e(e,t){for(var r=e.split("\n"),n=-1,a=-1,s=0,i=[];s!==r.length;++s)if("BOT"!==r[s].trim()){if(!(n<0)){for(var o=r[s].trim().split(","),l=o[0],c=o[1],u=r[++s]||"";1&(u.match(/["]/g)||[]).length&&s<r.length-1;)u+="\n"+r[++s];switch(u=u.trim(),+l){case-1:if("BOT"===u){i[++n]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?i[n][a]=!0:"FALSE"===u?i[n][a]=!1:isNaN(vs(c))?isNaN(ys(c).getDate())?i[n][a]=c:i[n][a]=fs(c):i[n][a]=vs(c),++a;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),i[n][a++]=""!==u?u:null}if("EOD"===u)break}}else i[++n]=[],a=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function t(t,r){return mo(function(t,r){switch(r.type){case"base64":return e(qn(t),r);case"binary":return e(t,r);case"buffer":return e(Kn&&Buffer.isBuffer(t)?t.toString("binary"):Zn(t),r);case"array":return e(ms(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}return{to_workbook:function(e,r){return ho(t(e,r),r)},to_sheet:t,from_sheet:function(){var e=function(e,t,r,n,a){e.push(t),e.push(r+","+n),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,r,n){e.push(t+","+r),e.push(1==t?'"'+n.replace(/"/g,'""')+'"':n)};return function(r){var n,a=[],s=lo(r["!ref"]),i=Array.isArray(r);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,s.e.r-s.s.r+1,""),e(a,"TUPLES",0,s.e.c-s.s.c+1,""),e(a,"DATA",0,0,"");for(var o=s.s.r;o<=s.e.r;++o){t(a,-1,0,"BOT");for(var l=s.s.c;l<=s.e.c;++l){var c=so({r:o,c:l});if(n=i?(r[o]||[])[l]:r[c])switch(n.t){case"n":var u=n.w;u||null==n.v||(u=n.v),null==u?n.f&&!n.F?t(a,1,0,"="+n.f):t(a,1,0,""):t(a,0,u,"V");break;case"b":t(a,0,n.v?1:0,n.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(n.v)?n.v:'="'+n.v+'"');break;case"d":n.w||(n.w=Va(n.z||ha[14],ss(fs(n.v)))),t(a,0,n.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}()}}(),Vl=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(t,r){return mo(function(t,r){for(var n=t.split("\n"),a=-1,s=-1,i=0,o=[];i!==n.length;++i){var l=n[i].trim().split(":");if("cell"===l[0]){var c=ao(l[1]);if(o.length<=c.r)for(a=o.length;a<=c.r;++a)o[a]||(o[a]=[]);switch(a=c.r,s=c.c,l[2]){case"t":o[a][s]=e(l[3]);break;case"v":o[a][s]=+l[3];break;case"vtf":var u=l[l.length-1];case"vtc":"nl"===l[3]?o[a][s]=!!+l[4]:o[a][s]=+l[4],"vtf"==l[2]&&(o[a][s]=[o[a][s],u])}}}return r&&r.sheetRows&&(o=o.slice(0,r.sheetRows)),o}(t,r),r)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var r,n=[],a=[],s="",i=io(e["!ref"]),o=Array.isArray(e),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c)if(s=so({r:l,c:c}),(r=o?(e[l]||[])[c]:e[s])&&null!=r.v&&"z"!==r.t){switch(a=["cell",s,"t"],r.t){case"s":case"str":a.push(t(r.v));break;case"n":r.f?(a[2]="vtf",a[3]="n",a[4]=r.v,a[5]=t(r.f)):(a[2]="v",a[3]=r.v);break;case"b":a[2]="vt"+(r.f?"f":"c"),a[3]="nl",a[4]=r.v?"1":"0",a[5]=t(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var u=ss(fs(r.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=r.w||Va(r.z||ha[14],u);break;case"e":continue}n.push(a.join(":"))}return n.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(e,t){return ho(r(e,t),t)},to_sheet:r,from_sheet:function(e){return[n,a,s,a,o(e),i].join("\n")}}}(),Gl=function(){function e(e,t,r,n,a){a.raw?t[r][n]=e:""===e||("TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:isNaN(vs(e))?isNaN(ys(e).getDate())?t[r][n]=e:t[r][n]=fs(e):t[r][n]=vs(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function n(e){for(var n={},a=!1,s=0,i=0;s<e.length;++s)34==(i=e.charCodeAt(s))?a=!a:!a&&i in t&&(n[i]=(n[i]||0)+1);for(s in i=[],n)Object.prototype.hasOwnProperty.call(n,s)&&i.push([n[s],s]);if(!i.length)for(s in n=r)Object.prototype.hasOwnProperty.call(n,s)&&i.push([n[s],s]);return i.sort(function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]}),t[i.pop()[1]]||44}function a(e,t){var r=t||{},a="";var s=r.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=n(e.slice(0,1024)):a=r&&r.FS?r.FS:n(e.slice(0,1024));var o=0,l=0,c=0,u=0,d=0,h=a.charCodeAt(0),f=!1,m=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=r.dateNF?function(e){var t="number"==typeof e?ha[e]:e;return t=t.replace($a,"(\\d+)"),new RegExp("^"+t+"$")}(r.dateNF):null;function v(){var t=e.slice(u,d),n={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)n.t="z";else if(r.raw)n.t="s",n.v=t;else if(0===t.trim().length)n.t="s",n.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(n.t="n",n.f=t.slice(1)):(n.t="s",n.v=t);else if("TRUE"==t)n.t="b",n.v=!0;else if("FALSE"==t)n.t="b",n.v=!1;else if(isNaN(c=vs(t)))if(!isNaN(ys(t).getDate())||g&&t.match(g)){n.z=r.dateNF||ha[14];var a=0;g&&t.match(g)&&(t=function(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match($a)||[]).forEach(function(e,t){var c=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=c;break;case"d":s=c;break;case"h":i=c;break;case"s":l=c;break;case"m":i>=0?o=c:a=c}}),l>=0&&-1==o&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==i&&-1==o&&-1==l?c:-1==n&&-1==a&&-1==s?u:c+"T"+u}(0,r.dateNF,t.match(g)||[]),a=1),r.cellDates?(n.t="d",n.v=fs(t,a)):(n.t="n",n.v=ss(fs(t,a))),!1!==r.cellText&&(n.w=Va(n.z,n.v instanceof Date?ss(n.v):n.v)),r.cellNF||delete n.z}else n.t="s",n.v=t;else n.t="n",!1!==r.cellText&&(n.w=t),n.v=c;if("z"==n.t||(r.dense?(s[o]||(s[o]=[]),s[o][l]=n):s[so({c:l,r:o})]=n),u=d+1,p=e.charCodeAt(u),i.e.c<l&&(i.e.c=l),i.e.r<o&&(i.e.r=o),m==h)++l;else if(l=0,++o,r.sheetRows&&r.sheetRows<=o)return!0}e:for(;d<e.length;++d)switch(m=e.charCodeAt(d)){case 34:34===p&&(f=!f);break;case h:case 10:case 13:if(!f&&v())break e}return d-u>0&&v(),s["!ref"]=oo(i),s}function s(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,r):mo(function(t,r){var n=r||{},a=[];if(!t||0===t.length)return a;for(var s=t.split(/[\r\n]/),i=s.length-1;i>=0&&0===s[i].length;)--i;for(var o=10,l=0,c=0;c<=i;++c)-1==(l=s[c].indexOf(" "))?l=s[c].length:l++,o=Math.max(o,l);for(c=0;c<=i;++c){a[c]=[];var u=0;for(e(s[c].slice(0,o).trim(),a,c,u,n),u=1;u<=(s[c].length-o)/10+1;++u)e(s[c].slice(o+10*(u-1),o+10*u).trim(),a,c,u,n)}return n.sheetRows&&(a=a.slice(0,n.sheetRows)),a}(t,r),r):a(t,r)}function i(e,t){var r="",n="string"==t.type?[0,0,0,0]:eh(e,t);switch(t.type){case"base64":r=qn(e);break;case"binary":case"string":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof Bn?Bn.utils.decode(t.codepage,e):Kn&&Buffer.isBuffer(e)?e.toString("binary"):Zn(e);break;case"array":r=ms(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]?r=Ls(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=Ls(r):"binary"==t.type&&"undefined"!==typeof Bn&&t.codepage&&(r=Bn.utils.decode(t.codepage,Bn.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?Vl.to_sheet("string"==t.type?r:Ls(r),t):s(r,t)}return{to_workbook:function(e,t){return ho(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,r=[],n=lo(e["!ref"]),a=Array.isArray(e),s=n.s.r;s<=n.e.r;++s){for(var i=[],o=n.s.c;o<=n.e.c;++o){var l=so({r:s,c:o});if((t=a?(e[s]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(uo(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===o?" ":""))}else i.push("          ")}r.push(i.join(""))}return r.join("\n")}}}();var ql=function(){function e(e,t,r){if(e){Gi(e,e.l||0);for(var n=r.Enum||v;e.l<e.length;){var a=e.read_shift(2),s=n[a]||n[65535],i=e.read_shift(2),o=e.l+i,l=s.f&&s.f(e,i,r);if(e.l=o,t(l,s,a))return}}}function t(t,r){if(!t)return t;var n=r||{};var a=n.dense?[]:{},s="Sheet1",i="",o=0,l={},c=[],u=[],d={s:{r:0,c:0},e:{r:0,c:0}},h=n.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])n.Enum=v,e(t,function(e,t,r){switch(r){case 0:n.vers=e,e>=4096&&(n.qpro=!0);break;case 6:d=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:n.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=n.dateNF||ha[14],n.cellDates&&(e[1].t="d",e[1].v=cs(e[1].v))),n.qpro&&e[3]>o&&(a["!ref"]=oo(d),l[s]=a,c.push(s),a=n.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s=i||"Sheet"+(o+1),i="");var u=n.dense?(a[e[0].r]||[])[e[0].c]:a[so(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}n.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[so(e[0])]=e[1]}},n);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);n.Enum=b,14==t[2]&&(n.qpro=!0,t.l=0),e(t,function(e,t,r){switch(r){case 204:s=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=oo(d),l[s]=a,c.push(s),a=n.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s="Sheet"+(o+1)),h>0&&e[0].r>=h)break;n.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[so(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==o&&(s=e[1])}},n)}if(a["!ref"]=oo(d),l[i||s]=a,c.push(i||s),!u.length)return{SheetNames:c,Sheets:l};for(var f={},m=[],p=0;p<u.length;++p)l[c[p]]?(m.push(u[p]||c[p]),f[u[p]]=l[u[p]]||l[c[p]]):(m.push(u[p]),f[u[p]]={"!ref":"A1"});return{SheetNames:m,Sheets:f}}function r(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(n[0].c=e.read_shift(1),n[3]=e.read_shift(1),n[0].r=e.read_shift(2),e.l+=2):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function n(e,t,n){var a=e.l+t,s=r(e,0,n);if(s[1].t="s",20768==n.vers){e.l++;var i=e.read_shift(1);return s[1].v=e.read_shift(i,"utf8"),s}return n.qpro&&e.l++,s[1].v=e.read_shift(a-e.l,"cstr"),s}function a(e,t,r){var n=Ki(7+r.length);n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,39);for(var a=0;a<n.length;++a){var s=r.charCodeAt(a);n.write_shift(1,s>=128?95:s)}return n.write_shift(1,0),n}function s(e,t,r){var n=Ki(7);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r,"i"),n}function i(e,t,r){var n=Ki(13);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(8,r,"f"),n}function o(e,t,r){var n=32768&t;return t=(n?e:0)+((t&=-32769)>=8192?t-16384:t),(n?"":"$")+(r?no(t):to(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,r,n){var a=Ki(6+n.length);a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),a.write_shift(1,39);for(var s=0;s<n.length;++s){var i=n.charCodeAt(s);a.write_shift(1,i>=128?95:i)}return a.write_shift(1,0),a}function h(e,t){var r=u(e),n=e.read_shift(4),a=e.read_shift(4),s=e.read_shift(2);if(65535==s)return 0===n&&3221225472===a?(r[1].t="e",r[1].v=15):0===n&&3489660928===a?(r[1].t="e",r[1].v=42):r[1].v=0,r;var i=32768&s;return s=(32767&s)-16446,r[1].v=(1-2*i)*(a*Math.pow(2,s+32)+n*Math.pow(2,s)),r}function f(e,t,r,n){var a=Ki(14);if(a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),0==n)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var s,i=0,o=0,l=0;return n<0&&(i=1,n=-n),o=0|Math.log2(n),0==(2147483648&(l=(n/=Math.pow(2,o-31))>>>0))&&(++o,l=(n/=2)>>>0),n-=l,l|=2147483648,l>>>=0,s=(n*=Math.pow(2,32))>>>0,a.write_shift(4,s),a.write_shift(4,l),o+=16383+(i?32768:0),a.write_shift(2,o),a}function m(e,t){var r=u(e),n=e.read_shift(8,"f");return r[1].v=n,r}function p(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var r=Ki(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var n=0;n<e.length;++n){var a=e.charCodeAt(n);r[r.l++]=a>127?95:a}return r[r.l++]=0,r}var v={0:{n:"BOF",f:bl},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(n.s.c=e.read_shift(1),e.l++,n.s.r=e.read_shift(2),n.e.c=e.read_shift(1),e.l++,n.e.r=e.read_shift(2),n):(n.s.c=e.read_shift(2),n.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),n.e.c=e.read_shift(2),n.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,n){var a=r(e,0,n);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,n){var a=r(e,0,n);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:n},16:{n:"FORMULA",f:function(e,t,n){var a=e.l+t,s=r(e,0,n);if(s[1].v=e.read_shift(8,"f"),n.qpro)e.l=a;else{var i=e.read_shift(2);!function(e,t){Gi(e,0);var r=[],n=0,a="",s="",i="",u="";for(;e.l<e.length;){var d=e[e.l++];switch(d){case 0:r.push(e.read_shift(8,"f"));break;case 1:s=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),r.push(s+a);break;case 2:var h=o(t[0].c,e.read_shift(2),!0),f=o(t[0].r,e.read_shift(2),!1);s=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),r.push(h+f+":"+s+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var m="";d=e[e.l++];)m+=String.fromCharCode(d);r.push('"'+m.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:u=r.pop(),i=r.pop(),r.push(["AND","OR"][d-20]+"("+i+","+u+")");break;default:if(d<32&&c[d])u=r.pop(),i=r.pop(),r.push(i+c[d]+u);else{if(!l[d])return d<=7?console.error("WK1 invalid opcode "+d.toString(16)):d<=24?console.error("WK1 unsupported op "+d.toString(16)):d<=30?console.error("WK1 invalid opcode "+d.toString(16)):d<=115?console.error("WK1 unsupported function opcode "+d.toString(16)):console.error("WK1 unrecognized opcode "+d.toString(16));if(69==(n=l[d][1])&&(n=e[e.l++]),n>r.length)return void console.error("WK1 bad formula parse 0x"+d.toString(16)+":|"+r.join("|")+"|");var p=r.slice(-n);r.length-=n,r.push(l[d][0]+"("+p.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+i),s),e.l+=i}return s}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:n},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var n="";n.length<r;)n+=String.fromCharCode(e[e.l++]);return n}},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=u(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var r=u(e);r[1].v=e.read_shift(2);var n=r[1].v>>1;if(1&r[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return r[1].v=n,r}},25:{n:"FORMULA19",f:function(e,t){var r=h(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},n=e.l+t;e.l<n;){var a=e.read_shift(2);if(14e3==a){for(r[a]=[0,""],r[a][0]=e.read_shift(2);e[e.l];)r[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=u(e),n=e.read_shift(4);return r[1].v=n>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:m},40:{n:"FORMULA28",f:function(e,t){var r=m(e);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var n=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[n,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&Fn(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var n=$i(),o=lo(e["!ref"]),l=Array.isArray(e),c=[];hd(n,0,function(e){var t=Ki(2);return t.write_shift(2,e),t}(1030)),hd(n,6,function(e){var t=Ki(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var u=Math.min(o.e.r,8191),d=o.s.r;d<=u;++d)for(var h=to(d),f=o.s.c;f<=o.e.c;++f){d===o.s.r&&(c[f]=no(f));var m=c[f]+h,p=l?(e[d]||[])[f]:e[m];if(p&&"z"!=p.t)if("n"==p.t)(0|p.v)==p.v&&p.v>=-32768&&p.v<=32767?hd(n,13,s(d,f,p.v)):hd(n,14,i(d,f,p.v));else hd(n,15,a(d,f,uo(p).slice(0,239)))}return hd(n,1),n.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&Fn(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var n=$i();hd(n,0,function(e){var t=Ki(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,n=0,a=0,s=0;s<e.SheetNames.length;++s){var i=e.SheetNames[s],o=e.Sheets[i];if(o&&o["!ref"]){++a;var l=io(o["!ref"]);r<l.e.r&&(r=l.e.r),n<l.e.c&&(n=l.e.c)}}r>8191&&(r=8191);return t.write_shift(2,r),t.write_shift(1,a),t.write_shift(1,n),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,s=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&hd(n,27,g(e.SheetNames[a],s++));var i=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var l=lo(o["!ref"]),c=Array.isArray(o),u=[],h=Math.min(l.e.r,8191),m=l.s.r;m<=h;++m)for(var p=to(m),v=l.s.c;v<=l.e.c;++v){m===l.s.r&&(u[v]=no(v));var b=u[v]+p,y=c?(o[m]||[])[v]:o[b];if(y&&"z"!=y.t)if("n"==y.t)hd(n,23,f(m,v,i,y.v));else hd(n,22,d(m,v,i,uo(y).slice(0,239)))}++i}}return hd(n,1),n.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(Xn(qn(e)),r);case"binary":return t(Xn(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}();var Kl=/^\s|\s$|[\t\n\r]/;function $l(e,t){if(!t.bookSST)return"";var r=[Ss];r[r.length]=Hs("sst",null,{xmlns:ni[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(null!=e[n]){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(Kl)&&(s+=' xml:space="preserve"'),s+=">"+Ns(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}var Yl=function(e,t){var r=!1;return null==t&&(r=!0,t=Ki(15+4*e.t.length)),t.write_shift(1,0),vo(e.t,t),r?t.slice(0,t.l):t};function Jl(e){var t=$i();Yi(t,159,function(e,t){return t||(t=Ki(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var r=0;r<e.length;++r)Yi(t,19,Yl(e[r]));return Yi(t,160),t.end()}function Xl(e){if("undefined"!==typeof Bn)return Bn.utils.encode(In,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ql(e){var t,r,n=0,a=Xl(e),s=a.length+1;for((t=Yn(s))[0]=a.length,r=1;r!=s;++r)t[r]=a[r-1];for(r=s-1;r>=0;--r)n=((0===(16384&n)?0:1)|n<<1&32767)^t[r];return 52811^n}var Zl=function(){function e(e,r){switch(r.type){case"base64":return t(qn(e),r);case"binary":return t(e,r);case"buffer":return t(Kn&&Buffer.isBuffer(e)?e.toString("binary"):Zn(e),r);case"array":return t(ms(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},n=e.match(/\\trowd.*?\\row\b/g);if(!n.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:n.length-1}};return n.forEach(function(e,t){Array.isArray(r)&&(r[t]=[]);for(var n,s=/\\\w+\b/g,i=0,o=-1;n=s.exec(e);){if("\\cell"===n[0]){var l=e.slice(i,s.lastIndex-n[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(r)?r[t][o]=c:r[so({r:t,c:o})]=c}}i=s.lastIndex}o>a.e.c&&(a.e.c=o)}),r["!ref"]=oo(a),r}return{to_workbook:function(t,r){return ho(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],n=lo(e["!ref"]),a=Array.isArray(e),s=n.s.r;s<=n.e.r;++s){r.push("\\trowd\\trautofit1");for(var i=n.s.c;i<=n.e.c;++i)r.push("\\cellx"+(i+1));for(r.push("\\pard\\intbl"),i=n.s.c;i<=n.e.c;++i){var o=so({r:s,c:i});(t=a?(e[s]||[])[i]:e[o])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(uo(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function ec(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var tc=6;function rc(e){return Math.floor((e+Math.round(128/tc)/256)*tc)}function nc(e){return Math.floor((e-5)/tc*100+.5)/100}function ac(e){return Math.round((e*tc+5)/tc*256)/256}function sc(e){e.width?(e.wpx=rc(e.width),e.wch=nc(e.wpx),e.MDW=tc):e.wpx?(e.wch=nc(e.wpx),e.width=ac(e.wch),e.MDW=tc):"number"==typeof e.wch&&(e.width=ac(e.wch),e.wpx=rc(e.width),e.MDW=tc),e.customWidth&&delete e.customWidth}var ic=96;function oc(e){return 96*e/ic}function lc(e){return e*ic/96}function cc(e,t){var r,n=[Ss,Hs("styleSheet",null,{xmlns:ni[0],"xmlns:vt":ei})];return e.SSF&&null!=(r=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)null!=e[n]&&(t[t.length]=Hs("numFmt",null,{numFmtId:n,formatCode:Ns(e[n])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=Hs("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=function(e){var t=[];return t[t.length]=Hs("cellXfs",null),e.forEach(function(e){t[t.length]=Hs("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=Hs("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function uc(e,t,r){r||(r=Ki(6+4*t.length)),r.write_shift(2,e),vo(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return null==r.l&&(r.l=r.length),n}function dc(e,t){t||(t=Ki(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=Ki(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,r),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var r=0;"superscript"==e.vertAlign?r=1:"subscript"==e.vertAlign&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),zo(e.color,t);var n=0;return"major"==e.scheme&&(n=1),"minor"==e.scheme&&(n=2),t.write_shift(1,n),vo(e.name,t),t.length>t.l?t.slice(0,t.l):t}var hc,fc=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],mc=qi;function pc(e,t){t||(t=Ki(84)),hc||(hc=rs(fc));var r=hc[e.patternType];null==r&&(r=40),t.write_shift(4,r);var n=0;if(40!=r)for(zo({auto:1},t),zo({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function gc(e,t,r){r||(r=Ki(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);return r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function vc(e,t){return t||(t=Ki(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var bc=qi;function yc(e){var t;Yi(e,613,po(1)),Yi(e,46,(t||(t=Ki(51)),t.write_shift(1,0),vc(0,t),vc(0,t),vc(0,t),vc(0,t),vc(0,t),t.length>t.l?t.slice(0,t.l):t)),Yi(e,614)}function xc(e){var t,r;Yi(e,619,po(1)),Yi(e,48,(t={xfId:0,builtinId:0,name:"Normal"},r||(r=Ki(52)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,+t.builtinId),r.write_shift(1,0),Ao(t.name||"",r),r.length>r.l?r.slice(0,r.l):r)),Yi(e,620)}function wc(e){Yi(e,508,function(e,t,r){var n=Ki(2052);return n.write_shift(4,e),Ao(t,n),Ao(r,n),n.length>n.l?n.slice(0,n.l):n}(0,"TableStyleMedium9","PivotStyleMedium4")),Yi(e,509)}function Sc(e,t){var r=$i();return Yi(r,278),function(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var n=e[0];n<=e[1];++n)null!=t[n]&&++r}),0!=r&&(Yi(e,615,po(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)null!=t[n]&&Yi(e,44,uc(n,t[n]))}),Yi(e,616))}}(r,e.SSF),function(e){Yi(e,611,po(1)),Yi(e,43,dc({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Yi(e,612)}(r),function(e){Yi(e,603,po(2)),Yi(e,45,pc({patternType:"none"})),Yi(e,45,pc({patternType:"gray125"})),Yi(e,604)}(r),yc(r),function(e){Yi(e,626,po(1)),Yi(e,47,gc({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Yi(e,627)}(r),function(e,t){Yi(e,617,po(t.length)),t.forEach(function(t){Yi(e,47,gc(t,0))}),Yi(e,618)}(r,t.cellXfs),xc(r),function(e){Yi(e,505,po(0)),Yi(e,506)}(r),wc(r),Yi(r,279),r.end()}function _c(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[Ss];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Ec(){var e=$i();return Yi(e,332),Yi(e,334,po(1)),Yi(e,335,function(e){var t=Ki(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),vo(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Yi(e,336),Yi(e,339,function(e,t){var r=Ki(8+2*t.length);return r.write_shift(4,e),vo(t,r),r.slice(0,r.l)}(1,"XLDAPR")),Yi(e,52),Yi(e,35,po(514)),Yi(e,4096,po(0)),Yi(e,4097,yl(1)),Yi(e,36),Yi(e,53),Yi(e,340),Yi(e,337,function(e,t){var r=Ki(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}(1,!0)),Yi(e,51,function(e){var t=Ki(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}([[1,0]])),Yi(e,338),Yi(e,333),e.end()}function kc(){var e=[Ss];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var Tc=1024;function Nc(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Hs("xml",null,{"xmlns:v":ci,"xmlns:o":ai,"xmlns:x":si,"xmlns:mv":li}).replace(/\/>/,">"),Hs("o:shapelayout",Hs("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Hs("v:shapetype",[Hs("v:stroke",null,{joinstyle:"miter"}),Hs("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Tc<1e3*e;)Tc+=1e3;return t.forEach(function(e){var t=ao(e[0]),r={color2:"#BEFF82",type:"gradient"};"gradient"==r.type&&(r.angle="-180");var n="gradient"==r.type?Hs("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=Hs("v:fill",n,r);++Tc,a=a.concat(["<v:shape"+Bs({id:"_x0000_s"+Tc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,Hs("v:shadow",null,{on:"t",obscured:"t"}),Hs("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",zs("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),zs("x:AutoFill","False"),zs("x:Row",String(t.r)),zs("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function jc(e){var t=[Ss,Hs("comments",null,{xmlns:ni[0]})],r=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var n=Ns(e.a);-1==r.indexOf(n)&&(r.push(n),t.push("<author>"+n+"</author>")),e.T&&e.ID&&-1==r.indexOf("tc="+e.ID)&&(r.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==r.length&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var n=0,a=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?n=r.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(n=r.indexOf(Ns(e.a))),a.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+n+'"><text>'),a.length<=1)t.push(zs("t",Ns(a[0]||"")));else{for(var s="Comment:\n    "+a[0]+"\n",i=1;i<a.length;++i)s+="Reply:\n    "+a[i]+"\n";t.push(zs("t",Ns(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Ac(e,t,r){var n=[Ss,Hs("ThreadedComments",null,{xmlns:Ys}).replace(/[\/]>/,">")];return e.forEach(function(e){var a="";(e[1]||[]).forEach(function(s,i){if(s.T){s.a&&-1==t.indexOf(s.a)&&t.push(s.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};0==i?a=o.id:o.parentId=a,s.ID=o.id,s.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Hs("threadedComment",zs("text",s.t||""),o))}else delete s.ID})}),n.push("</ThreadedComments>"),n.join("")}var Cc=go;function Oc(e){var t=$i(),r=[];return Yi(t,628),Yi(t,630),e.forEach(function(e){e[1].forEach(function(e){r.indexOf(e.a)>-1||(r.push(e.a.slice(0,54)),Yi(t,632,function(e){return vo(e.slice(0,54))}(e.a)))})}),Yi(t,631),Yi(t,633),e.forEach(function(e){e[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var a={s:ao(e[0]),e:ao(e[0])};Yi(t,635,function(e,t){return null==t&&(t=Ki(36)),t.write_shift(4,e[1].iauthor),Mo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([a,n])),n.t&&n.t.length>0&&Yi(t,637,wo(n)),Yi(t,636),delete n.iauthor})}),Yi(t,634),Yi(t,629),t.end()}var Pc=["xlsb","xlsm","xlam","biff8","xla"];var Rc=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,n,a){var s=!1,i=!1;0==n.length?i=!0:"["==n.charAt(0)&&(i=!0,n=n.slice(1,-1)),0==a.length?s=!0:"["==a.charAt(0)&&(s=!0,a=a.slice(1,-1));var o=n.length>0?0|parseInt(n,10):0,l=a.length>0?0|parseInt(a,10):0;return s?l+=t.c:--l,i?o+=t.r:--o,r+(s?"":"$")+no(l)+(i?"":"$")+to(o)}return function(n,a){return t=a,n.replace(e,r)}}(),Ic=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Dc=function(){return function(e,t){return e.replace(Ic,function(e,r,n,a,s,i){var o=ro(a)-(n?0:t.c),l=eo(i)-(s?0:t.r);return r+"R"+(0==l?"":s?l+1:"["+l+"]")+"C"+(0==o?"":n?o+1:"["+o+"]")})}}();function Lc(e,t){return e.replace(Ic,function(e,r,n,a,s,i){return r+("$"==n?n+a:no(ro(a)+t.c))+("$"==s?s+i:to(eo(i)+t.r))})}function Mc(e){e.l+=1}function Fc(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function Uc(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return zc(e);12==r.biff&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=Fc(e,2),o=Fc(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function zc(e){var t=Fc(e,2),r=Fc(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Bc(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=Fc(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var n=e.read_shift(r&&12==r.biff?4:2),a=Fc(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Hc(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function Wc(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function Vc(e){return[e.read_shift(1),e.read_shift(1)]}function Gc(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=gl(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=qo[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Fo(e);break;case 2:r[1]=kl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function qc(e,t,r){for(var n=e.read_shift(12==r.biff?4:2),a=[],s=0;s!=n;++s)a.push((12==r.biff?Lo:Ol)(e,8));return a}function Kc(e,t,r){var n=0,a=0;12==r.biff?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,0==--a&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=Gc(e,r.biff);return i}function $c(e,t,r){return e.l+=2,[Hc(e)]}function Yc(e){return e.l+=6,[]}function Jc(e){return e.l+=2,[bl(e),1&e.read_shift(2)]}var Xc=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Qc={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:qi},3:{n:"PtgAdd",f:Mc},4:{n:"PtgSub",f:Mc},5:{n:"PtgMul",f:Mc},6:{n:"PtgDiv",f:Mc},7:{n:"PtgPower",f:Mc},8:{n:"PtgConcat",f:Mc},9:{n:"PtgLt",f:Mc},10:{n:"PtgLe",f:Mc},11:{n:"PtgEq",f:Mc},12:{n:"PtgGe",f:Mc},13:{n:"PtgGt",f:Mc},14:{n:"PtgNe",f:Mc},15:{n:"PtgIsect",f:Mc},16:{n:"PtgUnion",f:Mc},17:{n:"PtgRange",f:Mc},18:{n:"PtgUplus",f:Mc},19:{n:"PtgUminus",f:Mc},20:{n:"PtgPercent",f:Mc},21:{n:"PtgParen",f:Mc},22:{n:"PtgMissArg",f:Mc},23:{n:"PtgStr",f:function(e,t,r){return e.l++,wl(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,qo[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Fo(e)}},32:{n:"PtgArray",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[vu[a],gu[a],n]}},34:{n:"PtgFuncVar",f:function(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===s[0]?gu:pu)[s[1]]]}},35:{n:"PtgName",f:function(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,s]}},36:{n:"PtgRef",f:function(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,Bc(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,Uc(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[n,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:qi},40:{n:"PtgMemNoMem",f:qi},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),n=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==a&&r>=128&&(r-=256),{r:t,c:r,cRel:a,rRel:n}}(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(16384&s)>>14,o=(32768&s)>>15;if(s&=16383,1==o)for(;a>524287;)a-=1048576;if(1==i)for(;s>8191;)s-=16384;return{r:a,c:s,cRel:i,rRel:o}}(e,0,r);return[n,a]}},45:{n:"PtgAreaN",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=function(e,t,r){if(r.biff<8)return zc(e);var n=e.read_shift(12==r.biff?4:2),a=e.read_shift(12==r.biff?4:2),s=Fc(e,2),i=Fc(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,r);return[n,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[n,a,Bc(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(r)switch(r.biff){case 5:e.l+=12;break;case 12:0}return[n,a,Uc(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[n,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[n,a]}},255:{}},Zc={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},eu={1:{n:"PtgElfLel",f:Jc},2:{n:"PtgElfRw",f:$c},3:{n:"PtgElfCol",f:$c},6:{n:"PtgElfRwV",f:$c},7:{n:"PtgElfColV",f:$c},10:{n:"PtgElfRadical",f:$c},11:{n:"PtgElfRadicalS",f:Yc},13:{n:"PtgElfColS",f:Yc},15:{n:"PtgElfColSV",f:Yc},16:{n:"PtgElfRadicalLel",f:Jc},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2);return{ixti:t,coltype:3&r,rt:Xc[r>>2&31],idx:n,c:a,C:s}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},tu={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var n=e.read_shift(r&&2==r.biff?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&2==r.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Wc},33:{n:"PtgAttrBaxcel",f:Wc},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Vc(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Vc(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function ru(e,t,r,n){if(n.biff<8)return qi(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Kc(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=qc(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&12==n.biff&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return 0!==(t=a-e.l)&&s.push(qi(e,t)),s}function nu(e,t,r){for(var n,a,s=e.l+t,i=[];s!=e.l;)t=s-e.l,a=e[e.l],n=Qc[a]||Qc[Zc[a]],24!==a&&25!==a||(n=(24===a?eu:tu)[e[e.l+1]]),n&&n.f?i.push([n.n,n.f(e,t,r)]):qi(e,t);return i}function au(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)if(2===i[0])a.push('"'+i[1].replace(/"/g,'""')+'"');else a.push(i[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var su={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function iu(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[n[0]][0][3]?(a=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ou(e,t,r){var n=iu(e,t,r);return"#REF"==n?n:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(n,r)}function lu(e,t,r,n,a){var s,i,o,l,c=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},d=[],h=0,f=0,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",v=0,b=e[0].length;v<b;++v){var y=e[0][v];switch(y[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=d.pop(),i=d.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=gs(" ",e[0][p][1][1]);break;case 1:g=gs("\r",e[0][p][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}i+=g,p=-1}d.push(i+su[y[0]]+s);break;case"PtgIsect":s=d.pop(),i=d.pop(),d.push(i+" "+s);break;case"PtgUnion":s=d.pop(),i=d.pop(),d.push(i+","+s);break;case"PtgRange":s=d.pop(),i=d.pop(),d.push(i+":"+s);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=Ji(y[1][1],u,a),d.push(Qi(o,c));break;case"PtgRefN":o=r?Ji(y[1][1],r,a):y[1][1],d.push(Qi(o,c));break;case"PtgRef3d":h=y[1][1],o=Ji(y[1][2],u,a);m=ou(n,h,a);d.push(m+"!"+Qi(o,c));break;case"PtgFunc":case"PtgFuncVar":var x=y[1][0],w=y[1][1];x||(x=0);var S=0==(x&=127)?[]:d.slice(-x);d.length-=x,"User"===w&&(w=S.shift()),d.push(w+"("+S.join(",")+")");break;case"PtgBool":d.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(y[1]);break;case"PtgNum":d.push(String(y[1]));break;case"PtgStr":d.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Xi(y[1][1],r?{s:r}:u,a),d.push(Zi(l,a));break;case"PtgArea":l=Xi(y[1][1],u,a),d.push(Zi(l,a));break;case"PtgArea3d":h=y[1][1],l=y[1][2],m=ou(n,h,a),d.push(m+"!"+Zi(l,a));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":f=y[1][2];var _=(n.names||[])[f-1]||(n[0]||[])[f],E=_?_.Name:"SH33TJSNAME"+String(f);E&&"_xlfn."==E.slice(0,6)&&!a.xlfn&&(E=E.slice(6)),d.push(E);break;case"PtgNameX":var k,T=y[1][1];if(f=y[1][2],!(a.biff<=5)){var N="";if(14849==((n[T]||[])[0]||[])[0]||(1025==((n[T]||[])[0]||[])[0]?n[T][f]&&n[T][f].itab>0&&(N=n.SheetNames[n[T][f].itab-1]+"!"):N=n.SheetNames[f-1]+"!"),n[T]&&n[T][f])N+=n[T][f].Name;else if(n[0]&&n[0][f])N+=n[0][f].Name;else{var j=(iu(n,T,a)||"").split(";;");j[f-1]?N=j[f-1]:N+="SH33TJSERRX"}d.push(N);break}T<0&&(T=-T),n[T]&&(k=n[T][f]),k||(k={Name:"SH33TJSERRY"}),d.push(k.Name);break;case"PtgParen":var A="(",C=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:A=gs(" ",e[0][p][1][1])+A;break;case 3:A=gs("\r",e[0][p][1][1])+A;break;case 4:C=gs(" ",e[0][p][1][1])+C;break;case 5:C=gs("\r",e[0][p][1][1])+C;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}d.push(A+d.pop()+C);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":o={c:y[1][1],r:y[1][0]};var O={c:r.c,r:r.r};if(n.sharedf[so(o)]){var P=n.sharedf[so(o)];d.push(lu(P,u,O,n,a))}else{var R=!1;for(s=0;s!=n.arrayf.length;++s)if(i=n.arrayf[s],!(o.c<i[0].s.c||o.c>i[0].e.c)&&!(o.r<i[0].s.r||o.r>i[0].e.r)){d.push(lu(i[1],u,O,n,a)),R=!0;break}R||d.push(y[1])}break;case"PtgArray":d.push("{"+au(y[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(y))}if(3!=a.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var I=!0;switch((y=e[0][p])[1][0]){case 4:I=!1;case 0:g=gs(" ",y[1][1]);break;case 5:I=!1;case 1:g=gs("\r",y[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}d.push((I?g:"")+d.pop()+(I?"":g)),p=-1}}if(d.length>1&&a.WTF)throw new Error("bad formula stack");return d[0]}function cu(e,t,r,n,a){var s=Al(t,r,a),i=function(e){if(null==e){var t=Ki(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return Uo("number"==typeof e?e:0)}(e.v),o=Ki(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=Ki(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return ea([s,i,o,l])}function uu(e,t,r){var n=e.read_shift(4),a=nu(e,n,r),s=e.read_shift(4);return[a,s>0?ru(e,s,a,r):null]}var du=uu,hu=uu,fu=uu,mu=uu,pu={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},gu={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},vu={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function bu(e){return("of:="+e.replace(Ic,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function yu(e){return e.replace(/\./,"!")}var xu="undefined"!==typeof Map;function wu(e,t,r){var n=0,a=e.length;if(r){if(xu?r.has(t):Object.prototype.hasOwnProperty.call(r,t))for(var s=xu?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t:t},e.Count++,e.Unique++,r&&(xu?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Su(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(tc=t.MDW),null!=t.width?r.customWidth=1:null!=t.wpx?n=nc(t.wpx):null!=t.wch&&(n=t.wch),n>-1?(r.width=ac(n),r.customWidth=1):null!=t.width&&(r.width=t.width),t.hidden&&(r.hidden=!0),null!=t.level&&(r.outlineLevel=r.level=t.level),r}function _u(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function Eu(e,t,r){var n=r.revssf[null!=t.z?t.z:"General"],a=60,s=e.length;if(null==n&&r.ssf)for(;a<392;++a)if(null==r.ssf[a]){Ga(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function ku(e,t,r){if(e&&e["!ref"]){var n=lo(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}var Tu=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Nu=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ju(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var a="",s=e.t,i=e.v;if("z"!==e.t)switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=qo[e.v];break;case"d":n&&n.cellDates?a=fs(e.v,-1).toISOString():((e=ps(e)).t="n",a=""+(e.v=ss(fs(e.v)))),"undefined"===typeof e.z&&(e.z=ha[14]);break;default:a=e.v}var o=zs("v",Ns(a)),l={r:t},c=Eu(n.cellXfs,e,n);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=zs("v",""+wu(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str"}if(e.t!=s&&(e.t=s,e.v=i),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Hs("f",Ns(e.f),u)+(null!=e.v?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Hs("c",o,l)}function Au(e,t,r,n){var a,s=[Ss,Hs("worksheet",null,{xmlns:ni[0],"xmlns:r":Zs})],i=r.SheetNames[e],o="",l=r.Sheets[i];null==l&&(l={});var c=l["!ref"]||"A1",u=lo(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=oo(u)}n||(n={}),l["!comments"]=[];var d=[];!function(e,t,r,n,a){var s=!1,i={},o=null;if("xlsx"!==n.bookType&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch(u){}s=!0,i.codeName=Ms(Ns(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Hs("outlinePr",null,c)}(s||o)&&(a[a.length]=Hs("sheetPr",o,i))}(l,r,e,t,s),s[s.length]=Hs("dimension",null,{ref:c}),s[s.length]=function(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Hs("sheetViews",Hs("sheetView",null,a),{})}(0,0,0,r),t.sheetFormat&&(s[s.length]=Hs("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(s[s.length]=function(e,t){for(var r,n=["<cols>"],a=0;a!=t.length;++a)(r=t[a])&&(n[n.length]=Hs("col",null,Su(a,r)));return n[n.length]="</cols>",n.join("")}(0,l["!cols"])),s[a=s.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(e,t){var r,n,a=[],s=[],i=lo(e["!ref"]),o="",l="",c=[],u=0,d=0,h=e["!rows"],f=Array.isArray(e),m={r:l},p=-1;for(d=i.s.c;d<=i.e.c;++d)c[d]=no(d);for(u=i.s.r;u<=i.e.r;++u){for(s=[],l=to(u),d=i.s.c;d<=i.e.c;++d){r=c[d]+l;var g=f?(e[u]||[])[d]:e[r];void 0!==g&&null!=(o=ju(g,r,e,t))&&s.push(o)}(s.length>0||h&&h[u])&&(m={r:l},h&&h[u]&&((n=h[u]).hidden&&(m.hidden=1),p=-1,n.hpx?p=oc(n.hpx):n.hpt&&(p=n.hpt),p>-1&&(m.ht=p,m.customHeight=1),n.level&&(m.outlineLevel=n.level)),a[a.length]=Hs("row",s.join(""),m))}if(h)for(;u<h.length;++u)h&&h[u]&&(m={r:u+1},(n=h[u]).hidden&&(m.hidden=1),p=-1,n.hpx?p=oc(n.hpx):n.hpt&&(p=n.hpt),p>-1&&(m.ht=p,m.customHeight=1),n.level&&(m.outlineLevel=n.level),a[a.length]=Hs("row","",m));return a.join("")}(l,t,0,0),o.length>0&&(s[s.length]=o)),s.length>a+1&&(s[s.length]="</sheetData>",s[a]=s[a].replace("/>",">")),l["!protect"]&&(s[s.length]=function(e){var t={sheet:1};return Tu.forEach(function(r){null!=e[r]&&e[r]&&(t[r]="1")}),Nu.forEach(function(r){null==e[r]||e[r]||(t[r]="0")}),e.password&&(t.password=Ql(e.password).toString(16).toUpperCase()),Hs("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(s[s.length]=function(e,t,r,n){var a="string"==typeof e.ref?e.ref:oo(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=io(a);i.s.r==i.e.r&&(i.e.r=io(t["!ref"]).e.r,a=oo(i));for(var o=0;o<s.length;++o){var l=s[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Hs("autoFilter",null,{ref:a})}(l["!autofilter"],l,r,e)),null!=l["!merges"]&&l["!merges"].length>0&&(s[s.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+oo(e[r])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var h,f,m=-1,p=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(h={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(p=Zo(n,-1,Ns(e[1].Target).replace(/#.*$/,""),Jo.HLINK),h["r:id"]="rId"+p),(m=e[1].Target.indexOf("#"))>-1&&(h.location=Ns(e[1].Target.slice(m+1))),e[1].Tooltip&&(h.tooltip=Ns(e[1].Tooltip)),s[s.length]=Hs("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(s[s.length]=(_u(f=l["!margins"]),Hs("pageMargins",null,f))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(s[s.length]=zs("ignoredErrors",Hs("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(p=Zo(n,-1,"../drawings/drawing"+(e+1)+".xml",Jo.DRAW),s[s.length]=Hs("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=d),l["!comments"].length>0&&(p=Zo(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Jo.VML),s[s.length]=Hs("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Cu(e,t,r,n){var a=function(e,t,r){var n=Ki(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=20*oc(a.hpx):a.hpt&&(s=20*a.hpt),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var d=-1,h=-1,f=u<<10;f<u+1<<10;++f)c.c=f,(Array.isArray(r)?(r[c.r]||[])[c.c]:r[so(c)])&&(d<0&&(d=f),h=f);d<0||(++o,n.write_shift(4,d),n.write_shift(4,h))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Yi(e,0,a)}var Ou=Lo,Pu=Mo;function Ru(e){return[Eo(e),Fo(e),"n"]}var Iu=Lo,Du=Mo;var Lu=["left","right","top","bottom","header","footer"];function Mu(e,t,r,n,a,s,i){if(void 0===t.v)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":(t=ps(t)).z=t.z||ha[14],t.v=ss(fs(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v}var l={r:r,c:n};switch(l.s=Eu(a.cellXfs,t,a),t.l&&s["!links"].push([so(l),t.l]),t.c&&s["!comments"].push([so(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=wu(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,i?Yi(e,18,function(e,t,r){return null==r&&(r=Ki(8)),ko(t,r),r.write_shift(4,t.v),r}(0,l)):Yi(e,7,function(e,t,r){return null==r&&(r=Ki(12)),_o(t,r),r.write_shift(4,t.v),r}(0,l))):(l.t="str",i?Yi(e,17,function(e,t,r){return null==r&&(r=Ki(8+4*e.v.length)),ko(t,r),vo(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,l)):Yi(e,6,function(e,t,r){return null==r&&(r=Ki(12+4*e.v.length)),_o(t,r),vo(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?i?Yi(e,13,function(e,t,r){return null==r&&(r=Ki(8)),ko(t,r),Io(e.v,r),r}(t,l)):Yi(e,2,function(e,t,r){return null==r&&(r=Ki(12)),_o(t,r),Io(e.v,r),r}(t,l)):i?Yi(e,16,function(e,t,r){return null==r&&(r=Ki(12)),ko(t,r),Uo(e.v,r),r}(t,l)):Yi(e,5,function(e,t,r){return null==r&&(r=Ki(16)),_o(t,r),Uo(e.v,r),r}(t,l)),!0;case"b":return l.t="b",i?Yi(e,15,function(e,t,r){return null==r&&(r=Ki(5)),ko(t,r),r.write_shift(1,e.v?1:0),r}(t,l)):Yi(e,4,function(e,t,r){return null==r&&(r=Ki(9)),_o(t,r),r.write_shift(1,e.v?1:0),r}(t,l)),!0;case"e":return l.t="e",i?Yi(e,14,function(e,t,r){return null==r&&(r=Ki(8)),ko(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}(t,l)):Yi(e,3,function(e,t,r){return null==r&&(r=Ki(9)),_o(t,r),r.write_shift(1,e.v),r}(t,l)),!0}return i?Yi(e,12,function(e,t,r){return null==r&&(r=Ki(4)),ko(t,r)}(0,l)):Yi(e,1,function(e,t,r){return null==r&&(r=Ki(8)),_o(t,r)}(0,l)),!0}function Fu(e,t){var r,n;t&&t["!merges"]&&(Yi(e,177,(r=t["!merges"].length,null==n&&(n=Ki(4)),n.write_shift(4,r),n)),t["!merges"].forEach(function(t){Yi(e,176,Du(t))}),Yi(e,178))}function Uu(e,t){t&&t["!cols"]&&(Yi(e,390),t["!cols"].forEach(function(t,r){t&&Yi(e,60,function(e,t,r){null==r&&(r=Ki(18));var n=Su(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,256*(n.width||10)),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),"number"==typeof n.width&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}(r,t))}),Yi(e,391))}function zu(e,t){t&&t["!ref"]&&(Yi(e,648),Yi(e,649,function(e){var t=Ki(24);return t.write_shift(4,4),t.write_shift(4,1),Mo(e,t),t}(lo(t["!ref"]))),Yi(e,650))}function Bu(e,t,r){t["!links"].forEach(function(t){if(t[1].Target){var n=Zo(r,-1,t[1].Target.replace(/#.*$/,""),Jo.HLINK);Yi(e,494,function(e,t){var r=Ki(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Mo({s:ao(e[0]),e:ao(e[0])},r),Po("rId"+t,r);var n=e[1].Target.indexOf("#");return vo((-1==n?"":e[1].Target.slice(n+1))||"",r),vo(e[1].Tooltip||"",r),vo("",r),r.slice(0,r.l)}(t,n))}}),delete t["!links"]}function Hu(e,t,r){Yi(e,133),Yi(e,137,function(e,t,r){null==r&&(r=Ki(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}(0,r)),Yi(e,138),Yi(e,134)}function Wu(e,t){var r,n;t["!protect"]&&Yi(e,535,(r=t["!protect"],null==n&&(n=Ki(66)),n.write_shift(2,r.password?Ql(r.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?n.write_shift(4,null==r[e[0]]||r[e[0]]?0:1):n.write_shift(4,null!=r[e[0]]&&r[e[0]]?0:1)}),n))}function Vu(e,t,r,n){var a=$i(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch(d){}var l,c,u=lo(i["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Yi(a,129),(r.vbaraw||i["!outline"])&&Yi(a,147,function(e,t,r){null==r&&(r=Ki(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return zo({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),No(e,r),r.slice(0,r.l)}(o,i["!outline"])),Yi(a,148,Pu(u)),Hu(a,0,r.Workbook),Uu(a,i),function(e,t,r,n){var a,s=lo(t["!ref"]||"A1"),i="",o=[];Yi(e,145);var l=Array.isArray(t),c=s.e.r;t["!rows"]&&(c=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=c;++u){i=to(u),Cu(e,t,s,u);var d=!1;if(u<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(o[h]=no(h)),a=o[h]+i;var f=l?(t[u]||[])[h]:t[a];d=!!f&&Mu(e,f,u,h,n,t,d)}}Yi(e,146)}(a,i,0,t),Wu(a,i),function(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s="string"===typeof a.ref?a.ref:oo(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=io(s);o.s.r==o.e.r&&(o.e.r=io(t["!ref"]).e.r,s=oo(o));for(var l=0;l<i.length;++l){var c=i[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Yi(e,161,Mo(lo(s))),Yi(e,162)}}(a,i,r,e),Fu(a,i),Bu(a,i,n),i["!margins"]&&Yi(a,476,(l=i["!margins"],null==c&&(c=Ki(48)),_u(l),Lu.forEach(function(e){Uo(l[e],c)}),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||zu(a,i),function(e,t,r,n){if(t["!comments"].length>0){var a=Zo(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Jo.VML);Yi(e,551,Po("rId"+a)),t["!legacy"]=a}}(a,i,e,n),Yi(a,130),a.end()}var Gu=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];var qu="][*?/\\".split("");function Ku(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return qu.forEach(function(n){if(-1!=e.indexOf(n)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function $u(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,r,n,a=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,r=a,n=!!e.vbaraw,t.forEach(function(e,a){Ku(e);for(var s=0;s<a;++s)if(e==t[s])throw new Error("Duplicate Sheet Name: "+e);if(n){var i=r&&r[a]&&r[a].CodeName||e;if(95==i.charCodeAt(0)&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}});for(var s=0;s<e.SheetNames.length;++s)ku(e.Sheets[e.SheetNames[s]],e.SheetNames[s],s)}function Yu(e){var t=[Ss];t[t.length]=Hs("workbook",null,{xmlns:ni[0],"xmlns:r":Zs});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Gu.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(n[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Hs("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&a[s]&&a[s].Hidden;++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:Ns(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden"}t[t.length]=Hs("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var r={name:e.Name};e.Comment&&(r.comment=e.Comment),null!=e.Sheet&&(r.localSheetId=""+e.Sheet),e.Hidden&&(r.hidden="1"),e.Ref&&(t[t.length]=Hs("definedName",Ns(e.Ref),r))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Ju(e,t){return t||(t=Ki(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Po(e.strRelID,t),vo(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Xu(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var r,n,a=t.Workbook.Sheets,s=0,i=-1,o=-1;s<a.length;++s)!a[s]||!a[s].Hidden&&-1==i?i=s:1==a[s].Hidden&&-1==o&&(o=s);if(!(o>i))Yi(e,135),Yi(e,158,(r=i,n||(n=Ki(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,r),n.write_shift(4,r),n.write_shift(1,120),n.length>n.l?n.slice(0,n.l):n)),Yi(e,136)}}function Qu(e,t){var r=$i();return Yi(r,131),Yi(r,128,function(e,t){t||(t=Ki(127));for(var r=0;4!=r;++r)t.write_shift(4,0);return vo("SheetJS",t),vo(Pn.version,t),vo(Pn.version,t),vo("7262",t),t.length>t.l?t.slice(0,t.l):t}()),Yi(r,153,function(e,t){t||(t=Ki(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),No(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),Xu(r,e),function(e,t){Yi(e,143);for(var r=0;r!=t.SheetNames.length;++r)Yi(e,156,Ju({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]}));Yi(e,144)}(r,e),Yi(r,132),r.end()}function Zu(e,t,r,n,a){return(".bin"===t.slice(-4)?Vu:Au)(e,r,n,a)}function ed(e,t,r){return(".bin"===t.slice(-4)?Oc:jc)(e,r)}function td(e,t){var r=[];return e.Props&&r.push(function(e,t){var r=[];return es(ul).map(function(e){for(var t=0;t<nl.length;++t)if(nl[t][1]==e)return nl[t];for(t=0;t<il.length;++t)if(il[t][1]==e)return il[t];throw e}).forEach(function(n){if(null!=e[n[1]]){var a=t&&t.Props&&null!=t.Props[n[1]]?t.Props[n[1]]:e[n[1]];"date"===n[2]&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof a?a=String(a):!0===a||!1===a?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(zs(ul[n[1]]||n[1],a))}}),Hs("DocumentProperties",r.join(""),{xmlns:ai})}(e.Props,t)),e.Custprops&&r.push(function(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&es(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var n=0;n<nl.length;++n)if(t==nl[n][1])return;for(n=0;n<il.length;++n)if(t==il[n][1])return;for(n=0;n<r.length;++n)if(t==r[n])return;var s=e[t],i="string";"number"==typeof s?(i="float",s=String(s)):!0===s||!1===s?(i="boolean",s=s?"1":"0"):s=String(s),a.push(Hs(js(t),s,{"dt:dt":i}))}}),t&&es(t).forEach(function(r){if(Object.prototype.hasOwnProperty.call(t,r)&&(!e||!Object.prototype.hasOwnProperty.call(e,r))){var n=t[r],s="string";"number"==typeof n?(s="float",n=String(n)):!0===n||!1===n?(s="boolean",n=n?"1":"0"):n instanceof Date?(s="dateTime.tz",n=n.toISOString()):n=String(n),a.push(Hs(js(r),n,{"dt:dt":s}))}}),"<"+n+' xmlns="'+ai+'">'+a.join("")+"</"+n+">"}(e.Props,e.Custprops)),r.join("")}function rd(e){return Hs("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Dc(e.Ref,{r:0,c:0})})}function nd(e,t,r,n,a,s,i){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ns(Dc(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=ao(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ns(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ns(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c==i.c&&c[u].s.r==i.r&&(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=qo[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||ha[14]);break;case"s":d="String",h=((e.v||"")+"").replace(ks,function(e){return Es[e]}).replace(As,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var f=Eu(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=i.c+1;var m=null!=e.v?h:"",p="z"==e.t?"":'<Data ss:Type="'+d+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=e.c.map(function(e){var t=Hs("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Hs("Comment",t,{"ss:Author":e.a})}).join("")),Hs("Cell",p,o)}function ad(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=lc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function sd(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?function(e,t,r,n){if(!e)return"";if(!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(rd(o)))}return s.join("")}(s,0,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?function(e,t){if(!e["!ref"])return"";var r=lo(e["!ref"]),n=e["!merges"]||[],a=0,s=[];e["!cols"]&&e["!cols"].forEach(function(e,t){sc(e);var r=!!e.width,n=Su(t,e),a={"ss:Index":t+1};r&&(a["ss:Width"]=rc(n.width)),e.hidden&&(a["ss:Hidden"]="1"),s.push(Hs("Column",null,a))});for(var i=Array.isArray(e),o=r.s.r;o<=r.e.r;++o){for(var l=[ad(o,(e["!rows"]||[])[o])],c=r.s.c;c<=r.e.c;++c){var u=!1;for(a=0;a!=n.length;++a)if(!(n[a].s.c>c)&&!(n[a].s.r>o)&&!(n[a].e.c<c)&&!(n[a].e.r<o)){n[a].s.c==c&&n[a].s.r==o||(u=!0);break}if(!u){var d={r:o,c:c},h=so(d),f=i?(e[o]||[])[c]:e[h];l.push(nd(f,h,e,t,0,0,d))}}l.push("</Row>"),l.length>2&&s.push(l.join(""))}return s.join("")}(s,t):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(function(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Hs("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Hs("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Hs("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Hs("Visible",1==n.Workbook.Sheets[r].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&(!n.Workbook.Sheets[s]||n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(zs("ProtectContents","True")),e["!protect"].objects&&a.push(zs("ProtectObjects","True")),e["!protect"].scenarios&&a.push(zs("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||a.push(zs("EnableSelection","UnlockedCells")):a.push(zs("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&a.push("<"+t[1]+"/>")})),0==a.length?"":Hs("WorksheetOptions",a.join(""),{xmlns:si})}(s,0,e,r)),n.join("")}function id(e,t){t||(t={}),e.SSF||(e.SSF=ps(ha)),e.SSF&&(Ka(),qa(e.SSF),t.revssf=ns(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Eu(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(td(e,t)),r.push(""),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Hs("Worksheet",sd(n,t,e),{"ss:Name":Ns(e.SheetNames[n])}));return r[2]=function(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var n=[];n.push(Hs("NumberFormat",null,{"ss:Format":Ns(ha[e.numFmtId])}));var a={"ss:ID":"s"+(21+t)};r.push(Hs("Style",n.join(""),a))}),Hs("Styles",r.join(""))}(0,t),r[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];null==a.Sheet&&(a.Name.match(/^_xlfn\./)||r.push(rd(a)))}return Hs("Names",r.join(""))}(e),Ss+Hs("Workbook",r.join(""),{xmlns:ii,"xmlns:o":ai,"xmlns:x":si,"xmlns:ss":ii,"xmlns:dt":oi,"xmlns:html":ui})}var od="e0859ff2f94f6810ab9108002b27b3d9",ld="02d5cdd59c2e1b10939708002b2cf9ae",cd="05d5cdd59c2e1b10939708002b2cf9ae";function ud(e,t){var r=t||{},n=Ja.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ja.utils.cfb_add(n,a,wd(e,r)),8==r.biff&&(e.Props||e.Custprops)&&function(e,t){var r,n=[],a=[],s=[],i=0,o=ts(Ho,"n"),l=ts(Wo,"n");if(e.Props)for(r=es(e.Props),i=0;i<r.length;++i)(Object.prototype.hasOwnProperty.call(o,r[i])?n:Object.prototype.hasOwnProperty.call(l,r[i])?a:s).push([r[i],e.Props[r[i]]]);if(e.Custprops)for(r=es(e.Custprops),i=0;i<r.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},r[i])||(Object.prototype.hasOwnProperty.call(o,r[i])?n:Object.prototype.hasOwnProperty.call(l,r[i])?a:s).push([r[i],e.Custprops[r[i]]]);var c=[];for(i=0;i<s.length;++i)hl.indexOf(s[i][0])>-1||ol.indexOf(s[i][0])>-1||null!=s[i][1]&&c.push(s[i]);a.length&&Ja.utils.cfb_add(t,"/\x05SummaryInformation",pl(a,od,l,Wo)),(n.length||c.length)&&Ja.utils.cfb_add(t,"/\x05DocumentSummaryInformation",pl(n,ld,o,Ho,c.length?c:null,cd))}(e,n),8==r.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(r,n){if(0!=n){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==a.slice(-1)&&Ja.utils.cfb_add(e,a,t.FileIndex[n].content)}})}(n,Ja.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),n}var dd={0:{f:function(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,7&s&&(r.level=7&s),16&s&&(r.hidden=!0),32&s&&(r.hpt=a/20),r}},1:{f:function(e){return[So(e)]}},2:{f:function(e){return[So(e),Ro(e),"n"]}},3:{f:function(e){return[So(e),e.read_shift(1),"e"]}},4:{f:function(e){return[So(e),e.read_shift(1),"b"]}},5:{f:function(e){return[So(e),Fo(e),"n"]}},6:{f:function(e){return[So(e),go(e),"str"]}},7:{f:function(e){return[So(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var n=e.l+t,a=So(e);a.r=r["!row"];var s=[a,go(e),"str"];if(r.cellFormula){e.l+=2;var i=hu(e,n-e.l,r);s[3]=lu(i,0,a,r.supbooks,r)}else e.l=n;return s}},9:{f:function(e,t,r){var n=e.l+t,a=So(e);a.r=r["!row"];var s=[a,Fo(e),"n"];if(r.cellFormula){e.l+=2;var i=hu(e,n-e.l,r);s[3]=lu(i,0,a,r.supbooks,r)}else e.l=n;return s}},10:{f:function(e,t,r){var n=e.l+t,a=So(e);a.r=r["!row"];var s=[a,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var i=hu(e,n-e.l,r);s[3]=lu(i,0,a,r.supbooks,r)}else e.l=n;return s}},11:{f:function(e,t,r){var n=e.l+t,a=So(e);a.r=r["!row"];var s=[a,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var i=hu(e,n-e.l,r);s[3]=lu(i,0,a,r.supbooks,r)}else e.l=n;return s}},12:{f:function(e){return[Eo(e)]}},13:{f:function(e){return[Eo(e),Ro(e),"n"]}},14:{f:function(e){return[Eo(e),e.read_shift(1),"e"]}},15:{f:function(e){return[Eo(e),e.read_shift(1),"b"]}},16:{f:Ru},17:{f:function(e){return[Eo(e),go(e),"str"]}},18:{f:function(e){return[Eo(e),e.read_shift(4),"s"]}},19:{f:yo},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=Co(e),i=fu(e,0,r),o=jo(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var s=e.read_shift(1);0!=s&&(n.underline=s);var i=e.read_shift(1);i>0&&(n.family=i);var o=e.read_shift(1);switch(o>0&&(n.charset=o),e.l++,n.color=function(e){var t={},r=e.read_shift(1)>>>1,n=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=n;var l=Go[n];l&&(t.rgb=ec(l));break;case 2:t.rgb=ec([s,i,o]);break;case 3:t.theme=n}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=go(e),n}},44:{f:function(e,t){return[e.read_shift(2),go(e)]}},45:{f:mc},46:{f:bc},47:{f:function(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zl},62:{f:function(e){return[So(e),yo(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=so(r);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},n=e[e.l];return++e.l,r.above=!(64&n),r.left=!(128&n),e.l+=18,r.name=To(e,t-19),r}},148:{f:Ou,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?go(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Oo(e,t-8),r.name=go(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Lo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Iu},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:go(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Oo},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ml},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var n=e.l+t,a=Do(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=du(e,n-e.l,r);i[1]=o}else e.l=n;return i}},427:{f:function(e,t,r){var n=e.l+t,a=[Lo(e,16)];if(r.cellFormula){var s=mu(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Lu.forEach(function(r){t[r]=Fo(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,n=Lo(e,16),a=jo(e),s=go(e),i=go(e),o=go(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Oo},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Cc},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=Lo(e,16);return t.rfx=r.s,t.ref=so(r.s),e.l+=16,t}},636:{T:-1},637:{f:xo},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:go(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function hd(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&Oi(r)&&e.push(r)}}function fd(e,t,r){return e||(e=Ki(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function md(e,t,r,n){if(null!=t.v)switch(t.t){case"d":case"n":var a="d"==t.t?ss(fs(t.v)):t.v;return void(a==(0|a)&&a>=0&&a<65536?hd(e,2,function(e,t,r){var n=Ki(9);return fd(n,e,t),n.write_shift(2,r),n}(r,n,a)):hd(e,3,function(e,t,r){var n=Ki(15);return fd(n,e,t),n.write_shift(8,r,"f"),n}(r,n,a)));case"b":case"e":return void hd(e,5,function(e,t,r,n){var a=Ki(9);return fd(a,e,t),xl(r,n||"b",a),a}(r,n,t.v,t.t));case"s":case"str":return void hd(e,4,function(e,t,r){var n=Ki(8+2*r.length);return fd(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}(r,n,(t.v||"").slice(0,255)))}hd(e,1,fd(null,r,n))}function pd(e,t){var r=t||{};for(var n=$i(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(0==a&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return hd(n,4==r.biff?1033:3==r.biff?521:9,Rl(0,16,r)),function(e,t,r,n){var a,s=Array.isArray(t),i=lo(t["!ref"]||"A1"),o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=oo(i)}for(var c=i.s.r;c<=i.e.r;++c){o=to(c);for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(l[u]=no(u)),a=l[u]+o;var d=s?(t[c]||[])[u]:t[a];d&&md(e,d,c,u)}}}(n,e.Sheets[e.SheetNames[a]],0,r),hd(n,10),n.end()}function gd(e,t,r){hd(e,49,function(e,t){var r=e.name||"Arial",n=t&&5==t.biff,a=Ki(n?15+r.length:16+2*r.length);return a.write_shift(2,20*(e.sz||12)),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function vd(e,t){if(t){var r=0;t.forEach(function(t,n){++r<=256&&t&&hd(e,125,function(e,t){var r=Ki(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,256*e.width),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}(Su(n,t),n))})}}function bd(e,t,r,n,a){var s=16+Eu(a.cellXfs,t,a);if(null!=t.v||t.bf)if(t.bf)hd(e,6,cu(t,r,n,0,s));else switch(t.t){case"d":case"n":hd(e,515,function(e,t,r,n){var a=Ki(14);return Al(e,t,n,a),Uo(r,a),a}(r,n,"d"==t.t?ss(fs(t.v)):t.v,s));break;case"b":case"e":hd(e,517,function(e,t,r,n,a,s){var i=Ki(8);return Al(e,t,n,i),xl(r,s,i),i}(r,n,t.v,s,0,t.t));break;case"s":case"str":if(a.bookSST)hd(e,253,function(e,t,r,n){var a=Ki(10);return Al(e,t,n,a),a.write_shift(4,r),a}(r,n,wu(a.Strings,t.v,a.revStrings),s));else hd(e,516,function(e,t,r,n,a){var s=!a||8==a.biff,i=Ki(+s+8+(1+s)*r.length);return Al(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}(r,n,(t.v||"").slice(0,255),s,a));break;default:hd(e,513,Al(r,n,s))}else hd(e,513,Al(r,n,s))}function yd(e,t,r){var n,a=$i(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),u=8==t.biff,d="",h=[],f=lo(i["!ref"]||"A1"),m=u?65536:16384;if(f.e.c>255||f.e.r>=m){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,m-1)}hd(a,2057,Rl(0,16,t)),hd(a,13,yl(1)),hd(a,12,yl(100)),hd(a,15,vl(!0)),hd(a,17,vl(!1)),hd(a,16,Uo(.001)),hd(a,95,vl(!0)),hd(a,42,vl(!1)),hd(a,43,vl(!1)),hd(a,130,yl(1)),hd(a,128,function(e){var t=Ki(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),hd(a,131,vl(!1)),hd(a,132,vl(!1)),u&&vd(a,i["!cols"]),hd(a,512,function(e,t){var r=8!=t.biff&&t.biff?2:4,n=Ki(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}(f,t)),u&&(i["!links"]=[]);for(var p=f.s.r;p<=f.e.r;++p){d=to(p);for(var g=f.s.c;g<=f.e.c;++g){p===f.s.r&&(h[g]=no(g)),n=h[g]+d;var v=c?(i[p]||[])[g]:i[n];v&&(bd(a,v,p,g,t),u&&v.l&&i["!links"].push([n,v.l]))}}var b=l.CodeName||l.name||s;return u&&hd(a,574,function(e){var t=Ki(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((o.Views||[])[0])),u&&(i["!merges"]||[]).length&&hd(a,229,function(e){var t=Ki(2+8*e.length);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Pl(e[r],t);return t}(i["!merges"])),u&&function(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];hd(e,440,Fl(n)),n[1].Tooltip&&hd(e,2048,Ul(n))}delete t["!links"]}(a,i),hd(a,442,Tl(b)),u&&function(e,t){var r=Ki(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),hd(e,2151,r),(r=Ki(39)).write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Pl(lo(t["!ref"]||"A1"),r),r.write_shift(4,4),hd(e,2152,r)}(a,i),hd(a,10),a.end()}function xd(e,t,r){var n=$i(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=8==r.biff,l=5==r.biff;(hd(n,2057,Rl(0,5,r)),"xla"==r.bookType&&hd(n,135),hd(n,225,o?yl(1200):null),hd(n,193,function(e,t){t||(t=Ki(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}(2)),l&&hd(n,191),l&&hd(n,192),hd(n,226),hd(n,92,function(e,t){var r=!t||8==t.biff,n=Ki(r?112:54);for(n.write_shift(8==t.biff?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}(0,r)),hd(n,66,yl(o?1200:1252)),o&&hd(n,353,yl(0)),o&&hd(n,448),hd(n,317,function(e){for(var t=Ki(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&hd(n,211),o&&e.vbaraw)&&hd(n,442,Tl(i.CodeName||"ThisWorkbook"));hd(n,156,yl(17)),hd(n,25,vl(!1)),hd(n,18,vl(!1)),hd(n,19,yl(0)),o&&hd(n,431,vl(!1)),o&&hd(n,444,yl(0)),hd(n,61,function(){var e=Ki(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),hd(n,64,vl(!1)),hd(n,141,yl(0)),hd(n,34,vl("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&Os(e.Workbook.WBProps.date1904)?"true":"false"}(e))),hd(n,14,vl(!0)),o&&hd(n,439,vl(!1)),hd(n,218,yl(0)),gd(n,0,r),function(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)null!=t[a]&&hd(e,1054,Dl(a,t[a],r))})}(n,e.SSF,r),function(e,t){for(var r=0;r<16;++r)hd(e,224,Ll({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){hd(e,224,Ll(r,0,t))})}(n,r),o&&hd(n,352,vl(!1));var c,u=n.end(),d=$i();o&&hd(d,140,(c||(c=Ki(4)),c.write_shift(2,1),c.write_shift(2,1),c)),o&&r.Strings&&function(e,t,r,n){var a=n||(r||[]).length||0;if(a<=8224)return hd(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],o=0,l=0,c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<a;){for((u=e.next(4)).write_shift(2,60),c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}(d,252,function(e){var t=Ki(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var r=[],n=0;n<e.length;++n)r[n]=Sl(e[n]);var a=ea([t].concat(r));return a.parts=[t.length].concat(r.map(function(e){return e.length})),a}(r.Strings)),hd(d,10);var h=d.end(),f=$i(),m=0,p=0;for(p=0;p<e.SheetNames.length;++p)m+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=u.length+m+h.length;for(p=0;p<e.SheetNames.length;++p){hd(f,133,Il({pos:g,hs:(s[p]||{}).Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var v=f.end();if(m!=v.length)throw new Error("BS8 "+m+" != "+v.length);var b=[];return u.length&&b.push(u),v.length&&b.push(v),h.length&&b.push(h),ea(b)}function wd(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(n&&n["!ref"])io(n["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}var a=t||{};switch(a.biff||2){case 8:case 5:return function(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ps(ha)),e&&e.SSF&&(Ka(),qa(e.SSF),r.revssf=ns(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Xd(r),r.cellXfs=[],Eu(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=yd(a,r,e);return n.unshift(xd(e,n,r)),ea(n)}(e,t);case 4:case 3:case 2:return pd(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Sd(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=so({r:r,c:i}),d=n.dense?(e[r]||[])[i]:e[u],h=d&&null!=d.v&&(d.h||Cs(d.w||(uo(d),d.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(f["data-t"]=d&&d.t||"z",null!=d.v&&(f["data-v"]=d.v),null!=d.z&&(f["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),f.id=(n.id||"sjs")+"-"+u,s.push(Hs("td",h,f))}}return"<tr>"+s.join("")+"</tr>"}var _d='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Ed="</body></html>";function kd(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Td(e,t){var r=t||{},n=null!=r.header?r.header:_d,a=null!=r.footer?r.footer:Ed,s=[n],i=io(e["!ref"]);r.dense=Array.isArray(e),s.push(kd(0,0,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(Sd(e,i,o,r));return s.push("</table>"+a),s.join("")}function Nd(e,t,r){var n=r||{};var a=0,s=0;if(null!=n.origin)if("number"==typeof n.origin)a=n.origin;else{var i="string"==typeof n.origin?ao(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var u=io(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==a&&(c.e.r=a=u.e.r+1)}var d=[],h=0,f=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,v=0,b=0,y=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<l;++m){var x=o[m];if(Ad(x)){if(n.display)continue;f[p]={hidden:!0}}var w=x.children;for(g=v=0;g<w.length;++g){var S=w[g];if(!n.display||!Ad(S)){var _=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):Fs(S.innerHTML),E=S.getAttribute("data-z")||S.getAttribute("z");for(h=0;h<d.length;++h){var k=d[h];k.s.c==v+s&&k.s.r<p+a&&p+a<=k.e.r&&(v=k.e.c+1-s,h=-1)}y=+S.getAttribute("colspan")||1,((b=+S.getAttribute("rowspan")||1)>1||y>1)&&d.push({s:{r:p+a,c:v+s},e:{r:p+a+(b||1)-1,c:v+s+(y||1)-1}});var T={t:"s",v:_},N=S.getAttribute("data-t")||S.getAttribute("t")||"";null!=_&&(0==_.length?T.t=N||"z":n.raw||0==_.trim().length||"s"==N||("TRUE"===_?T={t:"b",v:!0}:"FALSE"===_?T={t:"b",v:!1}:isNaN(vs(_))?isNaN(ys(_).getDate())||(T={t:"d",v:fs(_)},n.cellDates||(T={t:"n",v:ss(T.v)}),T.z=n.dateNF||ha[14]):T={t:"n",v:vs(_)})),void 0===T.z&&null!=E&&(T.z=E);var j="",A=S.getElementsByTagName("A");if(A&&A.length)for(var C=0;C<A.length&&(!A[C].hasAttribute("href")||"#"==(j=A[C].getAttribute("href")).charAt(0));++C);j&&"#"!=j.charAt(0)&&(T.l={Target:j}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][v+s]=T):e[so({c:v+s,r:p+a})]=T,c.e.c<v+s&&(c.e.c=v+s),v+=y}}++p}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,p-1+a),e["!ref"]=oo(c),p>=l&&(e["!fullref"]=oo((c.e.r=o.length-m+p-1+a,c))),e}function jd(e,t){return Nd((t||{}).dense?[]:{},e,t)}function Ad(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}var Cd=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Bs({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ss+t}}(),Od=function(){var e=function(e){return Ns(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",r=function(r,n,a){var s=[];s.push('      <table:table table:name="'+Ns(n.SheetNames[a])+'" table:style-name="ta1">\n');var i=0,o=0,l=io(r["!ref"]||"A1"),c=r["!merges"]||[],u=0,d=Array.isArray(r);if(r["!cols"])for(o=0;o<=l.e.c;++o)s.push("        <table:table-column"+(r["!cols"][o]?' table:style-name="co'+r["!cols"][o].ods+'"':"")+"></table:table-column>\n");var h="",f=r["!rows"]||[];for(i=0;i<l.s.r;++i)h=f[i]?' table:style-name="ro'+f[i].ods+'"':"",s.push("        <table:table-row"+h+"></table:table-row>\n");for(;i<=l.e.r;++i){for(h=f[i]?' table:style-name="ro'+f[i].ods+'"':"",s.push("        <table:table-row"+h+">\n"),o=0;o<l.s.c;++o)s.push(t);for(;o<=l.e.c;++o){var m=!1,p={},g="";for(u=0;u!=c.length;++u)if(!(c[u].s.c>o)&&!(c[u].s.r>i)&&!(c[u].e.c<o)&&!(c[u].e.r<i)){c[u].s.c==o&&c[u].s.r==i||(m=!0),p["table:number-columns-spanned"]=c[u].e.c-c[u].s.c+1,p["table:number-rows-spanned"]=c[u].e.r-c[u].s.r+1;break}if(m)s.push("          <table:covered-table-cell/>\n");else{var v=so({r:i,c:o}),b=d?(r[i]||[])[o]:r[v];if(b&&b.f&&(p["table:formula"]=Ns(bu(b.f)),b.F&&b.F.slice(0,v.length)==v)){var y=io(b.F);p["table:number-matrix-columns-spanned"]=y.e.c-y.s.c+1,p["table:number-matrix-rows-spanned"]=y.e.r-y.s.r+1}if(b){switch(b.t){case"b":g=b.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=b.v?"true":"false";break;case"n":g=b.w||String(b.v||0),p["office:value-type"]="float",p["office:value"]=b.v||0;break;case"s":case"str":g=null==b.v?"":b.v,p["office:value-type"]="string";break;case"d":g=b.w||fs(b.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=fs(b.v).toISOString(),p["table:style-name"]="ce1";break;default:s.push(t);continue}var x=e(g);if(b.l&&b.l.Target){var w=b.l.Target;"#"==(w="#"==w.charAt(0)?"#"+yu(w.slice(1)):w).charAt(0)||w.match(/^\w+:/)||(w="../"+w),x=Hs("text:a",x,{"xlink:href":w.replace(/&/g,"&amp;")})}s.push("          "+Hs("table:table-cell",Hs("text:p",x,{}),p)+"\n")}else s.push(t)}}s.push("        </table:table-row>\n")}return s.push("      </table:table>\n"),s.join("")};return function(e,t){var n=[Ss],a=Bs({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),s=Bs({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(n.push("<office:document"+a+s+">\n"),n.push(rl().replace(/office:document-meta/g,"office:meta"))):n.push("<office:document-content"+a+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var n=0;n<t["!cols"].length;++n)if(t["!cols"][n]){var a=t["!cols"][n];if(null==a.width&&null==a.wpx&&null==a.wch)continue;sc(a),a.ods=r;var s=t["!cols"][n].wpx+"px";e.push('  <style:style style:name="co'+r+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+s+'"/>\n'),e.push("  </style:style>\n"),++r}});var n=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var r=0;r<t["!rows"].length;++r)if(t["!rows"][r]){t["!rows"][r].ods=n;var a=t["!rows"][r].hpx+"px";e.push('  <style:style style:name="ro'+n+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+a+'"/>\n'),e.push("  </style:style>\n"),++n}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(n,e),n.push("  <office:body>\n"),n.push("    <office:spreadsheet>\n");for(var i=0;i!=e.SheetNames.length;++i)n.push(r(e.Sheets[e.SheetNames[i]],e,i));return n.push("    </office:spreadsheet>\n"),n.push("  </office:body>\n"),"fods"==t.bookType?n.push("</office:document>"):n.push("</office:document-content>"),n.join("")}}();function Pd(e,t){if("fods"==t.bookType)return Od(e,t);var r=ws(),n="",a=[],s=[];return xs(r,n="mimetype","application/vnd.oasis.opendocument.spreadsheet"),xs(r,n="content.xml",Od(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),xs(r,n="styles.xml",Cd(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),xs(r,n="meta.xml",Ss+rl()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),xs(r,n="manifest.rdf",function(e){var t=[Ss];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(el(e[r][0],e[r][1])),t.push(tl("",e[r][0]));return t.push(el("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(s)),a.push([n,"application/rdf+xml"]),xs(r,n="META-INF/manifest.xml",function(e){var t=[Ss];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(a)),r}function Rd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Id(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):Xn(Ms(e))}function Dd(e){var t=e.reduce(function(e,t){return e+t.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(e){r.set(e,n),n+=e.length}),r}function Ld(e,t){var r=t?t[0]:0,n=127&e[r];e:if(e[r++]>=128){if(n|=(127&e[r])<<7,e[r++]<128)break e;if(n|=(127&e[r])<<14,e[r++]<128)break e;if(n|=(127&e[r])<<21,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t&&(t[0]=r),n}function Md(e){var t=new Uint8Array(7);t[0]=127&e;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383)break e;if(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)break e;if(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)break e;if(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)break e;if(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103)break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Fd(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;r|=(127&e[t])<<28}return r}function Ud(e){for(var t=[],r=[0];r[0]<e.length;){var n,a=r[0],s=Ld(e,r),i=7&s,o=0;if(0==(s=Math.floor(s/8)))break;switch(i){case 0:for(var l=r[0];e[r[0]++]>=128;);n=e.slice(l,r[0]);break;case 5:o=4,n=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,n=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Ld(e,r),n=e.slice(r[0],r[0]+o),r[0]+=o;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var c={data:n,type:i};null==t[s]?t[s]=[c]:t[s].push(c)}return t}function zd(e){var t=[];return e.forEach(function(e,r){e.forEach(function(e){e.data&&(t.push(Md(8*r+e.type)),2==e.type&&t.push(Md(e.data.length)),t.push(e.data))})}),Dd(t)}function Bd(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Ld(e,n),s=Ud(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Fd(s[1][0].data),messages:[]};s[2].forEach(function(t){var r=Ud(t.data),a=Fd(r[3][0].data);i.messages.push({meta:r,data:e.slice(n[0],n[0]+a)}),n[0]+=a}),(null==(t=s[3])?void 0:t[0])&&(i.merge=Fd(s[3][0].data)>>>0>0),r.push(i)}return r}function Hd(e){var t=[];return e.forEach(function(e){var r=[];r[1]=[{data:Md(e.id),type:0}],r[2]=[],null!=e.merge&&(r[3]=[{data:Md(+!!e.merge),type:0}]);var n=[];e.messages.forEach(function(e){n.push(e.data),e.meta[3]=[{type:0,data:Md(e.data.length)}],r[2].push({data:zd(e.meta),type:2})});var a=zd(r);t.push(Md(a.length)),t.push(a),n.forEach(function(e){return t.push(e)})}),Dd(t)}function Wd(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Ld(t,r),a=[];r[0]<t.length;){var s=3&t[r[0]];if(0!=s){var i=0,o=0;if(1==s?(o=4+(t[r[0]]>>2&7),i=(224&t[r[0]++])<<3,i|=t[r[0]++]):(o=1+(t[r[0]++]>>2),2==s?(i=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(i=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Dd(a)],0==i)throw new Error("Invalid offset 0");if(i>a[0].length)throw new Error("Invalid offset beyond length");if(o>=i)for(a.push(a[0].slice(-i)),o-=i;o>=a[a.length-1].length;)a.push(a[a.length-1]),o-=a[a.length-1].length;a.push(a[0].slice(-i,-i+o))}else{var l=t[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[r[0]],c>1&&(l|=t[r[0]+1]<<8),c>2&&(l|=t[r[0]+2]<<16),c>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}a.push(t.slice(r[0],r[0]+l)),r[0]+=l}}var u=Dd(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Vd(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Wd(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Dd(t)}function Gd(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=Md(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=255&i,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return Dd(t)}function qd(e,t){var r=new Uint8Array(32),n=Rd(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,function(e,t,r){var n=Math.floor(0==r?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(127&n)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=255&a;e[t+15]|=r>=0?0:128}(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Kd(e,t){var r=new Uint8Array(32),n=Rd(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function $d(e){return Ld(Ud(e)[1][0].data)}function Yd(e,t,r){var n,a,s,i;if(!(null==(n=e[6])?void 0:n[0])||!(null==(a=e[7])?void 0:a[0]))throw"Mutation only works on post-BNC storages!";if((null==(i=null==(s=e[8])?void 0:s[0])?void 0:i.data)&&Fd(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var o=0,l=Rd(e[7][0].data),c=0,u=[],d=Rd(e[4][0].data),h=0,f=[],m=0;m<t.length;++m)if(null!=t[m]){var p,g;switch(l.setUint16(2*m,c,!0),d.setUint16(2*m,h,!0),typeof t[m]){case"string":p=qd({t:"s",v:t[m]},r),g=Kd({t:"s",v:t[m]},r);break;case"number":p=qd({t:"n",v:t[m]},r),g=Kd({t:"n",v:t[m]},r);break;case"boolean":p=qd({t:"b",v:t[m]},r),g=Kd({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}u.push(p),c+=p.length,f.push(g),h+=g.length,++o}else l.setUint16(2*m,65535,!0),d.setUint16(2*m,65535);for(e[2][0].data=Md(o);m<e[7][0].data.length/2;++m)l.setUint16(2*m,65535,!0),d.setUint16(2*m,65535,!0);return e[6][0].data=Dd(u),e[3][0].data=Dd(f),o}function Jd(e){return function(t){for(var r=0;r!=e.length;++r){var n=e[r];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}function Xd(e){Jd([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Qd(e,t){return"ods"==t.bookType?Pd(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=io(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(oo(n)));var s=lh(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&i.push(e)})});var o={},l=[],c=Ja.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],r=e[1];2==t.type&&t.name.match(/\.iwa/)&&Bd(Vd(t.content)).forEach(function(e){l.push(e.id),o[e.id]={deps:[],location:r,type:Fd(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var u=l.filter(function(e){return e>1}).map(function(e){return[e,Md(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&Bd(Vd(t.content)).forEach(function(e){e.messages.forEach(function(t){u.forEach(function(t){e.messages.some(function(e){return 11006!=Fd(e.meta[1][0].data)&&function(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}(e.data,t[1])})&&o[t[0]].deps.push(e.id)})})})});for(var d,h=Ja.find(c,o[1].location),f=Bd(Vd(h.content)),m=0;m<f.length;++m){var p=f[m];1==p.id&&(d=p)}var g=$d(Ud(d.messages[0].data)[1][0].data);for(f=Bd(Vd((h=Ja.find(c,o[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(d=p);for(g=$d(Ud(d.messages[0].data)[2][0].data),f=Bd(Vd((h=Ja.find(c,o[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(d=p);for(g=$d(Ud(d.messages[0].data)[2][0].data),f=Bd(Vd((h=Ja.find(c,o[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(d=p);var v=Ud(d.messages[0].data);v[6][0].data=Md(n.e.r+1),v[7][0].data=Md(n.e.c+1);for(var b=$d(v[46][0].data),y=Ja.find(c,o[b].location),x=Bd(Vd(y.content)),w=0;w<x.length&&x[w].id!=b;++w);if(x[w].id!=b)throw"Bad ColumnRowUIDMapArchive";var S=Ud(x[w].messages[0].data);S[1]=[],S[2]=[],S[3]=[];for(var _=0;_<=n.e.c;++_){var E=[];E[1]=E[2]=[{type:0,data:Md(_+420690)}],S[1].push({type:2,data:zd(E)}),S[2].push({type:0,data:Md(_)}),S[3].push({type:0,data:Md(_)})}S[4]=[],S[5]=[],S[6]=[];for(var k=0;k<=n.e.r;++k)(E=[])[1]=E[2]=[{type:0,data:Md(k+726270)}],S[4].push({type:2,data:zd(E)}),S[5].push({type:0,data:Md(k)}),S[6].push({type:0,data:Md(k)});x[w].messages[0].data=zd(S),y.content=Gd(Hd(x)),y.size=y.content.length,delete v[46];var T=Ud(v[4][0].data);T[7][0].data=Md(n.e.r+1);var N=$d(Ud(T[1][0].data)[2][0].data);if((x=Bd(Vd((y=Ja.find(c,o[N].location)).content)))[0].id!=N)throw"Bad HeaderStorageBucket";var j=Ud(x[0].messages[0].data);for(k=0;k<s.length;++k){var A=Ud(j[2][0].data);A[1][0].data=Md(k),A[4][0].data=Md(s[k].length),j[2][k]={type:j[2][0].type,data:zd(A)}}x[0].messages[0].data=zd(j),y.content=Gd(Hd(x)),y.size=y.content.length;var C=$d(T[2][0].data);if((x=Bd(Vd((y=Ja.find(c,o[C].location)).content)))[0].id!=C)throw"Bad HeaderStorageBucket";for(j=Ud(x[0].messages[0].data),_=0;_<=n.e.c;++_)(A=Ud(j[2][0].data))[1][0].data=Md(_),A[4][0].data=Md(n.e.r+1),j[2][_]={type:j[2][0].type,data:zd(A)};x[0].messages[0].data=zd(j),y.content=Gd(Hd(x)),y.size=y.content.length;var O=$d(T[4][0].data);!function(){for(var e,t=Ja.find(c,o[O].location),r=Bd(Vd(t.content)),n=0;n<r.length;++n){var a=r[n];a.id==O&&(e=a)}var s=Ud(e.messages[0].data);s[3]=[];var l=[];i.forEach(function(e,t){l[1]=[{type:0,data:Md(t)}],l[2]=[{type:0,data:Md(1)}],l[3]=[{type:2,data:Id(e)}],s[3].push({type:2,data:zd(l)})}),e.messages[0].data=zd(s);var u=Gd(Hd(r));t.content=u,t.size=t.content.length}();var P=Ud(T[3][0].data),R=P[1][0];delete P[2];var I=Ud(R.data),D=$d(I[2][0].data);!function(){for(var e,t=Ja.find(c,o[D].location),r=Bd(Vd(t.content)),a=0;a<r.length;++a){var l=r[a];l.id==D&&(e=l)}var u=Ud(e.messages[0].data);delete u[6],delete P[7];var d=new Uint8Array(u[5][0].data);u[5]=[];for(var h=0,f=0;f<=n.e.r;++f){var m=Ud(d);h+=Yd(m,s[f],i),m[1][0].data=Md(f),u[5].push({data:zd(m),type:2})}u[1]=[{type:0,data:Md(n.e.c+1)}],u[2]=[{type:0,data:Md(n.e.r+1)}],u[3]=[{type:0,data:Md(h)}],u[4]=[{type:0,data:Md(n.e.r+1)}],e.messages[0].data=zd(u);var p=Gd(Hd(r));t.content=p,t.size=t.content.length}(),R.data=zd(I),T[3][0].data=zd(P),v[4][0].data=zd(T),d.messages[0].data=zd(v);var L=Gd(Hd(f));return h.content=L,h.size=h.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){Tc=1024,e&&!e.SSF&&(e.SSF=ps(ha));e&&e.SSF&&(Ka(),qa(e.SSF),t.revssf=ns(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,xu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xlsb"==t.bookType?"bin":"xml",n=Pc.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Xd(t=t||{});var s=ws(),i="",o=0;t.cellXfs=[],Eu(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(xs(s,i="docProps/core.xml",sl(e.Props,t)),a.coreprops.push(i),Zo(t.rels,2,i,Jo.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,xs(s,i,ll(e.Props)),a.extprops.push(i),Zo(t.rels,3,i,Jo.EXT_PROPS),e.Custprops!==e.Props&&es(e.Custprops||{}).length>0&&(xs(s,i="docProps/custom.xml",cl(e.Custprops)),a.custprops.push(i),Zo(t.rels,4,i,Jo.CUST_PROPS));for(o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},d=e.Sheets[e.SheetNames[o-1]];(d||{})["!type"];if(xs(s,i="xl/worksheets/sheet"+o+"."+r,Zu(o-1,i,t,e,u)),a.sheets.push(i),Zo(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Jo.WS[0]),d){var h=d["!comments"],f=!1,m="";h&&h.length>0&&(xs(s,m="xl/comments"+o+"."+r,ed(h,m,t)),a.comments.push(m),Zo(u,-1,"../comments"+o+"."+r,Jo.CMNT),f=!0),d["!legacy"]&&f&&xs(s,"xl/drawings/vmlDrawing"+o+".vml",Nc(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&xs(s,Xo(i),Qo(u))}null!=t.Strings&&t.Strings.length>0&&(xs(s,i="xl/sharedStrings."+r,function(e,t,r){return(".bin"===t.slice(-4)?Jl:$l)(e,r)}(t.Strings,i,t)),a.strs.push(i),Zo(t.wbrels,-1,"sharedStrings."+r,Jo.SST));xs(s,i="xl/workbook."+r,function(e,t,r){return(".bin"===t.slice(-4)?Qu:Yu)(e,r)}(e,i,t)),a.workbooks.push(i),Zo(t.rels,1,i,Jo.WB),xs(s,i="xl/theme/theme1.xml",_c(e.Themes,t)),a.themes.push(i),Zo(t.wbrels,-1,"theme/theme1.xml",Jo.THEME),xs(s,i="xl/styles."+r,function(e,t,r){return(".bin"===t.slice(-4)?Sc:cc)(e,r)}(e,i,t)),a.styles.push(i),Zo(t.wbrels,-1,"styles."+r,Jo.STY),e.vbaraw&&n&&(xs(s,i="xl/vbaProject.bin",e.vbaraw),a.vba.push(i),Zo(t.wbrels,-1,"vbaProject.bin",Jo.VBA));return xs(s,i="xl/metadata."+r,function(e){return(".bin"===e.slice(-4)?Ec:kc)()}(i)),a.metadata.push(i),Zo(t.wbrels,-1,"metadata."+r,Jo.XLMETA),xs(s,"[Content_Types].xml",Yo(a,t)),xs(s,"_rels/.rels",Qo(t.rels)),xs(s,"xl/_rels/workbook."+r+".rels",Qo(t.wbrels)),delete t.revssf,delete t.ssf,s}(e,t):Zd(e,t)}function Zd(e,t){Tc=1024,e&&!e.SSF&&(e.SSF=ps(ha)),e&&e.SSF&&(Ka(),qa(e.SSF),t.revssf=ns(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,xu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Pc.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Xd(t=t||{});var s=ws(),i="",o=0;if(t.cellXfs=[],Eu(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),xs(s,i="docProps/core.xml",sl(e.Props,t)),a.coreprops.push(i),Zo(t.rels,2,i,Jo.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,xs(s,i,ll(e.Props)),a.extprops.push(i),Zo(t.rels,3,i,Jo.EXT_PROPS),e.Custprops!==e.Props&&es(e.Custprops||{}).length>0&&(xs(s,i="docProps/custom.xml",cl(e.Custprops)),a.custprops.push(i),Zo(t.rels,4,i,Jo.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]];(h||{})["!type"];if(xs(s,i="xl/worksheets/sheet"+o+"."+r,Au(o-1,t,e,d)),a.sheets.push(i),Zo(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Jo.WS[0]),h){var f=h["!comments"],m=!1,p="";if(f&&f.length>0){var g=!1;f.forEach(function(e){e[1].forEach(function(e){1==e.T&&(g=!0)})}),g&&(xs(s,p="xl/threadedComments/threadedComment"+o+"."+r,Ac(f,u,t)),a.threadedcomments.push(p),Zo(d,-1,"../threadedComments/threadedComment"+o+"."+r,Jo.TCMNT)),xs(s,p="xl/comments"+o+"."+r,jc(f)),a.comments.push(p),Zo(d,-1,"../comments"+o+"."+r,Jo.CMNT),m=!0}h["!legacy"]&&m&&xs(s,"xl/drawings/vmlDrawing"+o+".vml",Nc(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&xs(s,Xo(i),Qo(d))}return null!=t.Strings&&t.Strings.length>0&&(xs(s,i="xl/sharedStrings."+r,$l(t.Strings,t)),a.strs.push(i),Zo(t.wbrels,-1,"sharedStrings."+r,Jo.SST)),xs(s,i="xl/workbook."+r,Yu(e)),a.workbooks.push(i),Zo(t.rels,1,i,Jo.WB),xs(s,i="xl/theme/theme1.xml",_c(e.Themes,t)),a.themes.push(i),Zo(t.wbrels,-1,"theme/theme1.xml",Jo.THEME),xs(s,i="xl/styles."+r,cc(e,t)),a.styles.push(i),Zo(t.wbrels,-1,"styles."+r,Jo.STY),e.vbaraw&&n&&(xs(s,i="xl/vbaProject.bin",e.vbaraw),a.vba.push(i),Zo(t.wbrels,-1,"vbaProject.bin",Jo.VBA)),xs(s,i="xl/metadata."+r,kc()),a.metadata.push(i),Zo(t.wbrels,-1,"metadata."+r,Jo.XLMETA),u.length>1&&(xs(s,i="xl/persons/person.xml",function(e){var t=[Ss,Hs("personList",null,{xmlns:Ys,"xmlns:x":ni[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,r){t.push(Hs("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(u)),a.people.push(i),Zo(t.wbrels,-1,"persons/person.xml",Jo.PEOPLE)),xs(s,"[Content_Types].xml",Yo(a,t)),xs(s,"_rels/.rels",Qo(t.rels)),xs(s,"xl/_rels/workbook.xml.rels",Qo(t.wbrels)),delete t.revssf,delete t.ssf,s}function eh(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=qn(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function th(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Za(t.file,Ja.write(e,{type:Kn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ja.write(e,t)}function rh(e,t){var r={},n=Kn?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ja.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if("undefined"!==typeof Deno&&"string"==typeof a){if("binary"==t.type||"base64"==t.type)return a;a=new Uint8Array(Qn(a))}return t.password&&"undefined"!==typeof encrypt_agile?th(encrypt_agile(a,t.password),t):"file"===t.type?Za(t.file,a):"string"==t.type?Ls(a):a}function nh(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Gn(Ms(n));case"binary":return Ms(n);case"string":return e;case"file":return Za(t.file,n,"utf8");case"buffer":return Kn?$n(n,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(n):nh(n,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ah(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return"base64"==t.type?Gn(r):"string"==t.type?Ls(r):r;case"file":return Za(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function sh(e,t){Un(),$u(e);var r=ps(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type){r.type="binary";var n=sh(e,r);return r.type="array",Qn(n)}var a=0;if(r.sheet&&(a="number"==typeof r.sheet?r.sheet:e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return nh(id(e,r),r);case"slk":case"sylk":return nh(Hl.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return nh(Td(e.Sheets[e.SheetNames[a]],r),r);case"txt":return function(e,t){switch(t.type){case"base64":return Gn(e);case"binary":case"string":return e;case"file":return Za(t.file,e,"binary");case"buffer":return Kn?$n(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(hh(e.Sheets[e.SheetNames[a]],r),r);case"csv":return nh(dh(e.Sheets[e.SheetNames[a]],r),r,"\ufeff");case"dif":return nh(Wl.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return ah(Bl.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return nh(Gl.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return nh(Zl.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return nh(Vl.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return nh(Pd(e,r),r);case"wk1":return ah(ql.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return ah(ql.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ah(wd(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),function(e,t){var r=t||{};return th(ud(e,r),r)}(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var r=ps(t||{});return rh(Qd(e,r),r)}(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function ih(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function oh(e,t,r,n,a,s,i,o){var l=to(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch(g){h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var f=t.s.c;f<=t.e.c;++f){var m=i?e[r][f]:e[n[f]+l];if(void 0!==m&&void 0!==m.t){var p=m.v;switch(m.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(null!=s[f]){if(null==p)if("e"==m.t&&null===p)h[s[f]]=null;else if(void 0!==c)h[s[f]]=c;else{if(!u||null!==p)continue;h[s[f]]=null}else h[s[f]]=u&&("n"!==m.t||"n"===m.t&&!1!==o.rawNumbers)?p:uo(m,p,o);null!=p&&(d=!1)}}else{if(void 0===c)continue;null!=s[f]&&(h[s[f]]=c)}}return{row:h,isempty:d}}function lh(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?n=1:"A"===c.header?n=2:Array.isArray(c.header)?n=3:null==c.header&&(n=0),typeof u){case"string":l=lo(u);break;case"number":(l=lo(e["!ref"])).s.r=u;break;default:l=u}n>0&&(a=0);var d=to(l.s.r),h=[],f=[],m=0,p=0,g=Array.isArray(e),v=l.s.r,b=0,y={};g&&!e[v]&&(e[v]=[]);var x=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(x[b]||{}).hidden)switch(h[b]=no(b),r=g?e[v][b]:e[h[b]+d],n){case 1:s[b]=b-l.s.c;break;case 2:s[b]=h[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),o=i=uo(r,null,c),p=y[i]||0){do{o=i+"_"+p++}while(y[o]);y[i]=p,y[o]=1}else y[i]=1;s[b]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(w[v]||{}).hidden){var S=oh(e,l,v,h,n,s,g,c);(!1===S.isempty||(1===n?!1!==c.blankrows:c.blankrows))&&(f[m++]=S.row)}return f.length=m,f}var ch=/"/g;function uh(e,t,r,n,a,s,i,o){for(var l=!0,c=[],u="",d=to(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var f=o.dense?(e[r]||[])[h]:e[n[h]+d];if(null==f)u="";else if(null!=f.v){l=!1,u=""+(o.rawNumbers&&"n"==f.t?f.v:uo(f,null,o));for(var m=0,p=0;m!==u.length;++m)if((p=u.charCodeAt(m))===a||p===s||34===p||o.forceQuotes){u='"'+u.replace(ch,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(l=!1,(u="="+f.f).indexOf(",")>=0&&(u='"'+u.replace(ch,'""')+'"'));c.push(u)}return!1===o.blankrows&&l?null:c.join(i)}function dh(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=lo(e["!ref"]),s=void 0!==n.FS?n.FS:",",i=s.charCodeAt(0),o=void 0!==n.RS?n.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==s?"\\|":s)+"+$"),u="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(h[m]||{}).hidden||(d[m]=no(m));for(var p=0,g=a.s.r;g<=a.e.r;++g)(f[g]||{}).hidden||null!=(u=uh(e,a,g,d,i,l,s,n))&&(n.strip&&(u=u.replace(c,"")),(u||!1!==n.blankrows)&&r.push((p++?o:"")+u));return delete n.dense,r.join("")}function hh(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=dh(e,t);if("undefined"==typeof Bn||"string"==t.type)return r;var n=Bn.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function fh(e,t,r){var n,a=r||{},s=+!a.skipHeader,i=e||{},o=0,l=0;if(i&&null!=a.origin)if("number"==typeof a.origin)o=a.origin;else{var c="string"==typeof a.origin?ao(a.origin):a.origin;o=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var d=lo(i["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==o&&(o=d.e.r+1,u.e.r=o+t.length-1+s)}else-1==o&&(o=0,u.e.r=t.length-1+s);var h=a.header||[],f=0;t.forEach(function(e,t){es(e).forEach(function(r){-1==(f=h.indexOf(r))&&(h[f=h.length]=r);var c=e[r],u="z",d="",m=so({c:l+f,r:o+t+s});n=mh(i,m),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",a.cellDates||(u="n",c=ss(c)),d=a.dateNF||ha[14]):null===c&&a.nullError&&(u="e",c=0),n?(n.t=u,n.v=c,delete n.w,delete n.R,d&&(n.z=d)):i[m]=n={t:u,v:c},d&&(n.z=d)):i[m]=c})}),u.e.c=Math.max(u.e.c,l+h.length-1);var m=to(o);if(s)for(f=0;f<h.length;++f)i[no(f+l)+m]={t:"s",v:h[f]};return i["!ref"]=oo(u),i}function mh(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var n=ao(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return mh(e,so("number"!=typeof t?t:{r:t,c:r||0}))}function ph(){return{SheetNames:[],Sheets:{}}}function gh(e,t,r,n){var a=1;if(!r)for(;a<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+a);++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(r=i+a);++a);}if(Ku(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function vh(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var bh={encode_col:no,encode_row:to,encode_cell:so,encode_range:oo,decode_col:ro,decode_row:eo,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:ao,decode_range:io,format_cell:uo,sheet_add_aoa:fo,sheet_add_json:fh,sheet_add_dom:Nd,aoa_to_sheet:mo,json_to_sheet:function(e,t){return fh(null,e,t)},table_to_sheet:jd,table_to_book:function(e,t){return ho(jd(e,t),t)},sheet_to_csv:dh,sheet_to_txt:hh,sheet_to_json:lh,sheet_to_html:Td,sheet_to_formulae:function(e){var t,r="",n="";if(null==e||null==e["!ref"])return[];var a,s=lo(e["!ref"]),i="",o=[],l=[],c=Array.isArray(e);for(a=s.s.c;a<=s.e.c;++a)o[a]=no(a);for(var u=s.s.r;u<=s.e.r;++u)for(i=to(u),a=s.s.c;a<=s.e.c;++a)if(r=o[a]+i,n="",void 0!==(t=c?(e[u]||[])[a]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;n=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=r+"="+n}return l},sheet_to_row_object_array:lh,sheet_get_cell:mh,book_new:ph,book_append_sheet:gh,book_set_sheet_visibility:function(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:vh,cell_set_internal_link:function(e,t,r){return vh(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,n){for(var a="string"!=typeof t?t:lo(t),s="string"==typeof t?t:oo(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=mh(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};Pn.version;function yh(e){let{onAdd:t,onCancel:r}=e;const[a,s]=(0,n.useState)(""),[i,o]=(0,n.useState)("radio"),[l,c]=(0,n.useState)(["","","",""]),[u,d]=(0,n.useState)(""),[h,f]=(0,n.useState)([]);return(0,E.jsxs)("div",{className:"bg-white p-4 rounded-lg border-2 border-indigo-200 mb-3",children:[(0,E.jsx)("textarea",{placeholder:"Enter question",value:a,onChange:e=>s(e.target.value),className:"w-full px-3 py-2 border rounded-lg mb-3 focus:ring-2 focus:ring-indigo-500",rows:"2"}),(0,E.jsxs)("select",{value:i,onChange:e=>{o(e.target.value),d(""),f([])},className:"w-full px-3 py-2 border rounded-lg mb-3 focus:ring-2 focus:ring-indigo-500",children:[(0,E.jsx)("option",{value:"radio",children:"Single Choice MCQ (1 mark)"}),(0,E.jsx)("option",{value:"checkbox",children:"Multiple Choice MCQ (1 mark)"})]}),(0,E.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,E.jsx)("p",{className:"text-xs text-gray-600 mb-2 font-medium",children:"radio"===i?"Select the correct answer:":"Select all correct answers:"}),l.map((e,t)=>{const r=e,n=!r.trim();return(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:["radio"===i&&(0,E.jsx)("input",{type:"radio",name:"correctAnswer",checked:u===r,onChange:()=>d(r),disabled:n,className:"w-4 h-4"}),"checkbox"===i&&(0,E.jsx)("input",{type:"checkbox",checked:h.includes(r),onChange:()=>(e=>{h.includes(e)?f(h.filter(t=>t!==e)):f([...h,e])})(r),disabled:n,className:"w-4 h-4"}),(0,E.jsx)("input",{type:"text",placeholder:"Option ".concat(t+1),value:r,onChange:e=>((e,t)=>{const r=[...l],n=r[e];r[e]=t,c(r),"radio"===i&&u===n&&d(t),"checkbox"===i&&h.includes(n)&&f(h.map(e=>e===n?t:e))})(t,e.target.value),className:"flex-1 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500"})]},t)})]}),(0,E.jsxs)("div",{className:"flex space-x-2",children:[(0,E.jsx)("button",{onClick:()=>{if(!a.trim())return void alert("Please enter a question");if("radio"===i&&!u)return void alert("Please select the correct answer");if("checkbox"===i&&0===h.length)return void alert("Please select at least one correct answer");const e=l.map(e=>e.trim()).filter(Boolean);if(e.length<2)return void alert("Please provide at least 2 options");let r=null,n=null;"radio"===i&&(r=u),"checkbox"===i&&(n=h);const m={question:a.trim(),type:i,options:e,correctAnswer:r,correctAnswers:n,points:1};t(m),s(""),o("radio"),c(["","","",""]),d(""),f([])},className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium",children:"Add Question"}),(0,E.jsx)("button",{onClick:r,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 text-sm",children:"Cancel"})]})]})}function xh(e){let{exam:t,onSave:r,onCancel:a}=e;const[s,i]=(0,n.useState)((null===t||void 0===t?void 0:t.title)||""),[o,l]=(0,n.useState)((null===t||void 0===t?void 0:t.description)||""),[c,u]=(0,n.useState)((null===t||void 0===t?void 0:t.exam_date)||""),[d,h]=(0,n.useState)((null===t||void 0===t?void 0:t.start_time)||""),[f,m]=(0,n.useState)((null===t||void 0===t?void 0:t.end_time)||""),[p,g]=(0,n.useState)((null===t||void 0===t?void 0:t.duration)||30),[v,b]=(0,n.useState)((null===t||void 0===t?void 0:t.questions)||[]),[y,x]=(0,n.useState)(!1),[w,S]=(0,n.useState)(!1);(0,n.useEffect)(()=>{},[t]);const _=v.reduce((e,t)=>e+(t.points||1),0);return(0,E.jsxs)("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 p-6 rounded-lg mb-6 border-2 border-indigo-200",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,E.jsx)("h3",{className:"font-semibold text-lg",children:t?"Edit Exam":"Create New Exam"}),(0,E.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700",children:(0,E.jsx)(yn,{className:"w-5 h-5"})})]}),(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exam Title *"}),(0,E.jsx)("input",{type:"text",placeholder:"e.g., Final Exam - Mathematics",value:s,onChange:e=>i(e.target.value),disabled:w,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exam Date *"}),(0,E.jsx)("input",{type:"date",value:c,onChange:e=>u(e.target.value),disabled:w,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time *"}),(0,E.jsx)("input",{type:"datetime-local",value:d,onChange:e=>h(e.target.value),disabled:w,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time *"}),(0,E.jsx)("input",{type:"datetime-local",value:f,onChange:e=>m(e.target.value),disabled:w,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration (minutes) *"}),(0,E.jsx)("input",{type:"number",placeholder:"e.g., 60",value:p,onChange:e=>g(e.target.value),disabled:w,min:"1",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"})]})]}),(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,E.jsx)("textarea",{placeholder:"Brief description of the exam",value:o,onChange:e=>l(e.target.value),disabled:w,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100",rows:"2"})]}),(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,E.jsxs)("h4",{className:"font-semibold text-gray-800",children:["Questions (",v.length,") - Total Points: ",_]}),(0,E.jsx)("button",{onClick:()=>x(!y),disabled:w,className:"px-3 py-1 bg-indigo-100 text-indigo-600 rounded-lg hover:bg-indigo-200 text-sm font-medium disabled:opacity-50",children:"+ Add Question"})]}),y&&(0,E.jsx)(yh,{onAdd:e=>{b(t=>[...t,e]),x(!1)},onCancel:()=>x(!1)}),(0,E.jsxs)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[v.map((e,t)=>(0,E.jsx)("div",{className:"p-3 bg-white rounded-lg border hover:border-indigo-300 transition",children:(0,E.jsxs)("div",{className:"flex justify-between items-start",children:[(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,E.jsxs)("p",{className:"font-medium text-sm",children:[t+1,". ",e.question]}),(0,E.jsxs)("span",{className:"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded font-bold",children:[e.points," ",1===e.points?"mark":"marks"]})]}),(0,E.jsx)("span",{className:"inline-block px-2 py-1 text-xs bg-indigo-100 text-indigo-700 rounded uppercase font-medium",children:"radio"===e.type?"Single Choice MCQ":"Multiple Choice MCQ"}),e.options&&e.options.length>0&&(0,E.jsxs)("div",{className:"mt-2 text-xs text-gray-600",children:[(0,E.jsx)("p",{className:"font-medium",children:"Options:"}),(0,E.jsx)("ul",{className:"list-disc list-inside pl-2",children:e.options.map((t,r)=>{var n,a;return(0,E.jsxs)("li",{className:e.correctAnswer===t||null!==(n=e.correctAnswers)&&void 0!==n&&n.includes(t)?"text-green-600 font-medium":"",children:[t," ",(e.correctAnswer===t||(null===(a=e.correctAnswers)||void 0===a?void 0:a.includes(t)))&&"\u2713"]},r)})})]})]}),(0,E.jsx)("div",{className:"flex flex-col space-y-2 ml-3",children:(0,E.jsx)("button",{onClick:()=>(e=>{b(t=>t.filter((t,r)=>r!==e))})(t),disabled:w,className:"text-red-500 hover:text-red-700 p-1 disabled:opacity-50",title:"Delete Question",children:(0,E.jsx)(_n,{className:"w-4 h-4"})})})]})},t)),0===v.length&&(0,E.jsx)("div",{className:"text-center py-8 text-gray-500 bg-white rounded-lg border border-dashed",children:'No questions added yet. Click "Add Question" to start.'})]})]}),(0,E.jsxs)("div",{className:"flex space-x-2",children:[(0,E.jsxs)("button",{onClick:async()=>{if(!s.trim())return void alert("Please enter exam title");if(!c)return void alert("Please select exam date");if(!d)return void alert("Please select start time");if(!f)return void alert("Please select end time");if(!p||p<=0)return void alert("Please enter valid duration");if(0===v.length)return void alert("Please add at least one question");const e=new Date(d),t=new Date(f);if(t<=e)return void alert("End time must be after start time");const n=Math.floor((t-e)/6e4);if(n<p)return void alert("Time window (".concat(n," min) is shorter than exam duration (").concat(p," min). Please adjust."));if(v.filter(e=>"radio"===e.type&&!e.correctAnswer||!("checkbox"!==e.type||e.correctAnswers&&0!==e.correctAnswers.length)).length>0)return void alert("All MCQ questions must have correct answers selected!");S(!0);const a=v.reduce((e,t)=>e+(t.points||1),0);try{await r({title:s.trim(),description:o.trim(),exam_date:c,start_time:new Date(d).toISOString(),end_time:new Date(f).toISOString(),duration:parseInt(p,10),questions:v,total_questions:v.length,total_points:a})}catch(i){throw console.error("Save error:",i),S(!1),i}},disabled:w,className:"px-6 py-2 rounded-lg font-medium flex items-center space-x-2 ".concat(w?"bg-gray-400 cursor-not-allowed text-white":"bg-indigo-600 hover:bg-indigo-700 text-white"),children:[w&&(0,E.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,E.jsx)("span",{children:w?"Saving Exam...":"Save Exam"})]}),(0,E.jsx)("button",{onClick:a,disabled:w,className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium disabled:opacity-50",children:"Cancel"})]})]})}function wh(){const[e,t]=(0,n.useState)([]),[r,a]=(0,n.useState)([]),[s,i]=(0,n.useState)(!1),[o,l]=(0,n.useState)(null),[c,u]=(0,n.useState)(!0);(0,n.useEffect)(()=>{d(),h()},[]);const d=async()=>{u(!0);try{const{data:e,error:r}=await tn.from("exams").select("*").order("created_at",{ascending:!1});r?console.error("Error fetching exams:",r):t(e||[])}catch(e){console.error("Unexpected error:",e)}u(!1)},h=async()=>{try{const{data:e,error:t}=await tn.from("results").select("*").order("submitted_at",{ascending:!1});t?console.error("Error fetching results:",t):a(e||[])}catch(e){console.error("Unexpected error:",e)}};return c?(0,E.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,E.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,E.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[(0,E.jsx)(w,{className:"w-7 h-7 mr-2 text-indigo-600"}),"Exam Management"]}),(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsxs)("button",{onClick:()=>{i(!0),l(null)},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium flex items-center space-x-2",children:[(0,E.jsx)(An,{className:"w-5 h-5"}),(0,E.jsx)("span",{children:"Create New Exam"})]}),(0,E.jsx)("button",{onClick:d,title:"Refresh exams",className:"px-3 py-2 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Refresh"})]})]}),s&&(0,E.jsx)(xh,{exam:o,onSave:async e=>{try{if(o){const{error:t}=await tn.from("exams").update(e).eq("id",o.id);if(t)return void alert("Error updating exam: "+t.message);alert("\u2705 Exam updated successfully!")}else{const{error:t}=await tn.from("exams").insert([e]);if(t)return void alert("Error creating exam: "+t.message);alert("\u2705 Exam created successfully!")}i(!1),l(null),d()}catch(t){console.error("Save error:",t),alert("Unexpected error: "+(t.message||t))}},onCancel:()=>{i(!1),l(null)}}),(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.map(e=>{var t,r,n,a,s,o;const c=new Date,u=e.start_time?new Date(e.start_time):null,h=e.end_time?new Date(e.end_time):null,f=u&&h?c<u?"upcoming":c>h?"closed":"active":"unknown";return(0,E.jsxs)("div",{className:"p-6 rounded-lg border-2 transition shadow-sm ".concat("active"===f?"bg-gradient-to-br from-green-50 to-emerald-50 border-green-300":"upcoming"===f?"bg-gradient-to-br from-indigo-50 to-purple-50 border-indigo-200":"bg-gray-50 border-gray-200"),children:[(0,E.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,E.jsx)("h3",{className:"font-bold text-lg text-gray-800",children:e.title}),(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:["active"===f&&(0,E.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs font-bold rounded-full animate-pulse",children:"LIVE"}),"upcoming"===f&&(0,E.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-bold rounded-full",children:"SOON"}),"closed"===f&&(0,E.jsx)("span",{className:"px-2 py-1 bg-gray-200 text-gray-600 text-xs font-bold rounded-full",children:"CLOSED"})]})]}),(0,E.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:e.description||"No description"}),(0,E.jsxs)("div",{className:"space-y-2 text-sm mb-4",children:[(0,E.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,E.jsx)(_,{className:"w-4 h-4 mr-2 text-indigo-500"}),(0,E.jsx)("span",{children:e.exam_date?new Date(e.exam_date).toLocaleDateString():"N/A"})]}),(0,E.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,E.jsx)(Cn,{className:"w-4 h-4 mr-2 text-indigo-500"}),(0,E.jsxs)("span",{children:[null!==(t=e.duration)&&void 0!==t?t:"N/A"," minutes"]})]}),(0,E.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,E.jsx)(w,{className:"w-4 h-4 mr-2 text-indigo-500"}),(0,E.jsxs)("span",{children:[null!==(r=null===(n=e.questions)||void 0===n?void 0:n.length)&&void 0!==r?r:0," questions (",null!==(a=null!==(s=e.total_points)&&void 0!==s?s:null===(o=e.questions)||void 0===o?void 0:o.length)&&void 0!==a?a:0," points)"]})]})]}),(0,E.jsxs)("div",{className:"mb-4 p-3 bg-white rounded-lg border",children:[(0,E.jsx)("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"\ud83d\udcc5 Exam Window:"}),(0,E.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[(0,E.jsx)("span",{children:"Start:"}),(0,E.jsx)("span",{className:"font-medium text-green-600",children:e.start_time?new Date(e.start_time).toLocaleString():"N/A"})]}),(0,E.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[(0,E.jsx)("span",{children:"End:"}),(0,E.jsx)("span",{className:"font-medium text-red-600",children:e.end_time?new Date(e.end_time).toLocaleString():"N/A"})]})]}),(0,E.jsxs)("div",{className:"flex space-x-2",children:[(0,E.jsxs)("button",{onClick:()=>{l(e),i(!0)},className:"flex-1 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium flex items-center justify-center",children:[(0,E.jsx)(On,{className:"w-4 h-4 mr-1"}),"Edit"]}),(0,E.jsxs)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this exam? This action cannot be undone."))try{const{error:t}=await tn.from("exams").delete().eq("id",e);t?alert("Error deleting exam: "+t.message):(alert("\u2705 Exam deleted successfully!"),d())}catch(t){console.error("Delete error:",t),alert("Unexpected error: "+(t.message||t))}})(e.id),className:"flex-1 px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium flex items-center justify-center",children:[(0,E.jsx)(_n,{className:"w-4 h-4 mr-1"}),"Delete"]})]})]},e.id)}),0===e.length&&(0,E.jsxs)("div",{className:"col-span-3 text-center py-12 text-gray-500",children:[(0,E.jsx)(w,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,E.jsx)("p",{className:"text-lg",children:"No exams created yet"}),(0,E.jsx)("p",{className:"text-sm mt-2",children:'Click "Create New Exam" to start'})]})]})]}),(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,E.jsxs)("h2",{className:"text-xl font-bold text-gray-800 flex items-center",children:[(0,E.jsx)(an,{className:"w-6 h-6 mr-2 text-indigo-600"}),"All Exam Results"]}),(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsxs)("button",{onClick:()=>{if(0===r.length)return void alert("No results to export");const t=r.map(t=>{var r,n,a,s;const i=e.find(e=>e.id===t.exam_id);return{"Student ID":t.student_name||t.student_id||"Unknown","Exam Title":(null===i||void 0===i?void 0:i.title)||"Unknown Exam","Score (%)":null!==t.score&&void 0!==t.score?t.score:"Pending","Marks Obtained":null!==(r=t.auto_score)&&void 0!==r?r:0,"Total Marks":null!==(n=null!==(a=t.total_auto_points)&&void 0!==a?a:null===i||void 0===i?void 0:i.total_points)&&void 0!==n?n:0,Status:t.graded?"PASS":"FAIL","Submitted At":t.submitted_at?new Date(t.submitted_at).toLocaleString():"N/A","Total Questions":null!==(s=null===i||void 0===i?void 0:i.total_questions)&&void 0!==s?s:0}}),n=bh.json_to_sheet(t),a=bh.book_new();bh.book_append_sheet(a,n,"Exam Results");!function(e,t,r){var n=r||{};n.type="file",n.file=t,ih(n),sh(e,n)}(a,"Exam_Results_".concat((new Date).toISOString().split("T")[0],".xlsx"))},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium flex items-center space-x-2",children:[(0,E.jsx)(vn,{className:"w-5 h-5"}),(0,E.jsx)("span",{children:"Export to Excel"})]}),(0,E.jsxs)("button",{onClick:async()=>{if(0!==r.length){if(window.confirm("Are you sure you want to delete ALL ".concat(r.length," results? This action cannot be undone.")))try{const{error:e}=await tn.from("results").delete().neq("id","00000000-0000-0000-0000-000000000000");e?alert("Error deleting results: "+e.message):(alert("\u2705 All results deleted successfully!"),h())}catch(e){console.error("Delete error:",e),alert("Unexpected error: "+(e.message||e))}}else alert("No results to delete")},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium flex items-center space-x-2",children:[(0,E.jsx)(_n,{className:"w-5 h-5"}),(0,E.jsx)("span",{children:"Delete All"})]}),(0,E.jsx)("button",{onClick:h,title:"Refresh results",className:"px-3 py-2 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Refresh"})]})]}),(0,E.jsx)("div",{className:"overflow-x-auto",children:(0,E.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,E.jsx)("thead",{className:"bg-gray-50",children:(0,E.jsxs)("tr",{children:[(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Exam Title"}),(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Marks Obtained"}),(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Marks"}),(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score (%)"}),(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitted At"}),(0,E.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),(0,E.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[r.map(t=>{var r,n,a,s,i;const o=e.find(e=>e.id===t.exam_id),l=null!==(r=t.auto_score)&&void 0!==r?r:0,c=null!==(n=null!==(a=t.total_auto_points)&&void 0!==a?a:null===o||void 0===o?void 0:o.total_points)&&void 0!==n?n:0;return(0,E.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:null!==(s=null!==(i=t.student_name)&&void 0!==i?i:t.student_id)&&void 0!==s?s:"Unknown"}),(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:(null===o||void 0===o?void 0:o.title)||"Unknown Exam"}),(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:l}),(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c}),(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:null!==t.score&&void 0!==t.score?(0,E.jsxs)("span",{className:"font-bold ".concat(t.score>=75?"text-green-600":t.score>=50?"text-yellow-600":"text-red-600"),children:[t.score,"%"]}):(0,E.jsx)("span",{className:"text-gray-500",children:"Pending"})}),(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:t.graded?(0,E.jsx)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"PASS"}):(0,E.jsx)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:"FAIL"})}),(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.submitted_at?new Date(t.submitted_at).toLocaleString():"N/A"}),(0,E.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,E.jsxs)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this result? This action cannot be undone."))try{const{error:t}=await tn.from("results").delete().eq("id",e);t?alert("Error deleting result: "+t.message):(alert("\u2705 Result deleted successfully!"),h())}catch(t){console.error("Delete error:",t),alert("Unexpected error: "+(t.message||t))}})(t.id),className:"text-red-600 hover:text-red-800 font-medium flex items-center space-x-1",title:"Delete Result",children:[(0,E.jsx)(_n,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Delete"})]})})]},t.id)}),0===r.length&&(0,E.jsx)("tr",{children:(0,E.jsxs)("td",{colSpan:"8",className:"px-6 py-12 text-center text-gray-500",children:[(0,E.jsx)(an,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,E.jsx)("p",{className:"text-lg",children:"No exam results yet"}),(0,E.jsx)("p",{className:"text-sm mt-1",children:"Results will appear here after students submit exams"})]})})]})]})})]})]})}const Sh=v("megaphone",[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]]);function _h(){var e;const[t,r]=(0,n.useState)([]),[a,s]=(0,n.useState)(!1),[i,o]=(0,n.useState)(""),[l,c]=(0,n.useState)(""),[u,d]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!0);(0,n.useEffect)(()=>{m()},[]);const m=async()=>{try{const{data:e,error:t}=await tn.from("announcements").select("*").order("created_at",{ascending:!1});if(t)throw t;e&&r(e)}catch(e){console.error("Error loading announcements:",e)}finally{f(!1)}};return h?(0,E.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,E.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsx)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-lg shadow-lg p-6 text-white",children:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsx)("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:(0,E.jsx)(Sh,{className:"w-6 h-6"})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("h1",{className:"text-2xl font-bold",children:"Announcement Management"}),(0,E.jsx)("p",{className:"text-indigo-100 text-sm",children:"Post important updates for all students"})]})]}),(0,E.jsxs)("div",{className:"bg-white bg-opacity-20 px-4 py-2 rounded-lg",children:[(0,E.jsx)("p",{className:"text-xs text-indigo-100",children:"Total Announcements"}),(0,E.jsx)("p",{className:"text-3xl font-bold",children:t.length})]})]})}),(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,E.jsxs)("h2",{className:"text-xl font-bold text-gray-800 flex items-center",children:[(0,E.jsx)(dn,{className:"w-5 h-5 mr-2 text-indigo-600"}),"All Announcements"]}),(0,E.jsxs)("button",{onClick:()=>s(!a),className:"flex items-center space-x-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition shadow-md",children:[(0,E.jsx)(An,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"New Announcement"})]})]}),a&&(0,E.jsxs)("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 p-6 rounded-lg mb-6 border-2 border-indigo-200 relative",children:[(0,E.jsx)("button",{onClick:()=>s(!1),className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:(0,E.jsx)(yn,{className:"w-5 h-5"})}),(0,E.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,E.jsx)(dn,{className:"w-5 h-5 mr-2 text-indigo-600"}),"Create New Announcement"]}),(0,E.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),i.trim()&&l.trim()){d(!0);try{const{error:e}=await tn.from("announcements").insert([{title:i.trim(),message:l.trim()}]);if(e)throw e;alert("\u2705 Announcement posted successfully!"),o(""),c(""),s(!1),m()}catch(t){console.error("Error posting announcement:",t),alert("\u274c Error posting announcement: "+t.message)}finally{d(!1)}}else alert("Please fill all fields")},className:"space-y-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Announcement Title *"}),(0,E.jsx)("input",{type:"text",placeholder:"e.g., Exam Schedule Update",value:i,onChange:e=>o(e.target.value),disabled:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed transition",maxLength:"100"}),(0,E.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[i.length,"/100 characters"]})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message *"}),(0,E.jsx)("textarea",{placeholder:"Write your announcement message here...",value:l,onChange:e=>c(e.target.value),disabled:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed transition",rows:"5",maxLength:"500"}),(0,E.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[l.length,"/500 characters"]})]}),(0,E.jsxs)("div",{className:"flex space-x-3",children:[(0,E.jsxs)("button",{type:"submit",disabled:u||!i.trim()||!l.trim(),className:"flex items-center space-x-2 px-6 py-3 rounded-lg font-medium transition ".concat(!u&&i.trim()&&l.trim()?"bg-indigo-600 hover:bg-indigo-700 text-white shadow-md":"bg-gray-400 cursor-not-allowed text-white"),children:[u&&(0,E.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,E.jsx)(dn,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:u?"Posting...":"Post Announcement"})]}),(0,E.jsx)("button",{type:"button",onClick:()=>{s(!1),o(""),c("")},disabled:u,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium disabled:opacity-50 disabled:cursor-not-allowed transition",children:"Cancel"})]})]})]}),(0,E.jsx)("div",{className:"space-y-4",children:0===t.length?(0,E.jsxs)("div",{className:"text-center py-16",children:[(0,E.jsx)("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,E.jsx)(dn,{className:"w-10 h-10 text-gray-400"})}),(0,E.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No Announcements Yet"}),(0,E.jsx)("p",{className:"text-gray-500 mb-4",children:"Create your first announcement to notify students"}),(0,E.jsxs)("button",{onClick:()=>s(!0),className:"inline-flex items-center space-x-2 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition",children:[(0,E.jsx)(An,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Create Announcement"})]})]}):(0,E.jsx)("div",{className:"grid grid-cols-1 gap-4",children:t.map((e,t)=>(0,E.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-lg border-l-4 border-indigo-500 hover:shadow-lg transition group",children:(0,E.jsxs)("div",{className:"flex justify-between items-start",children:[(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,E.jsx)("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-indigo-600 text-white text-xs font-bold rounded-full",children:t+1}),(0,E.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:e.title})]}),(0,E.jsx)("p",{className:"text-gray-700 mb-3 leading-relaxed",children:e.message}),(0,E.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,E.jsx)(dn,{className:"w-3 h-3"}),(0,E.jsxs)("span",{children:["Posted on ",Tn(e.created_at)]})]}),(0,E.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,E.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,E.jsx)("span",{children:"Active"})]})]})]}),(0,E.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\u26a0\ufe0f Are you sure you want to delete this announcement?"))try{const{error:t}=await tn.from("announcements").delete().eq("id",e);if(t)throw t;alert("\ud83d\uddd1\ufe0f Announcement deleted successfully!"),m()}catch(t){console.error("Error deleting announcement:",t),alert("\u274c Error deleting announcement: "+t.message)}})(e.id),className:"ml-4 p-2 text-red-500 hover:bg-red-100 rounded-lg transition opacity-0 group-hover:opacity-100",title:"Delete Announcement",children:(0,E.jsx)(_n,{className:"w-5 h-5"})})]})},e.id))})}),t.length>0&&(0,E.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,E.jsx)("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center",children:(0,E.jsx)(dn,{className:"w-5 h-5 text-white"})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-xs text-green-600 font-medium",children:"Total Posted"}),(0,E.jsx)("p",{className:"text-2xl font-bold text-green-700",children:t.length})]})]})}),(0,E.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center",children:(0,E.jsx)(Sh,{className:"w-5 h-5 text-white"})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-xs text-blue-600 font-medium",children:"Latest"}),(0,E.jsx)("p",{className:"text-sm font-bold text-blue-700 truncate max-w-[150px]",children:(null===(e=t[0])||void 0===e?void 0:e.title)||"N/A"})]})]})}),(0,E.jsx)("div",{className:"bg-purple-50 p-4 rounded-lg",children:(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center",children:(0,E.jsx)(dn,{className:"w-5 h-5 text-white"})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-xs text-purple-600 font-medium",children:"Status"}),(0,E.jsx)("p",{className:"text-sm font-bold text-purple-700",children:"All Active"})]})]})})]})})]})]})}const Eh=v("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);function kh(){const[e,t]=(0,n.useState)([]),[r,a]=(0,n.useState)(""),[s,i]=(0,n.useState)(!0),[o,l]=(0,n.useState)(null),c=(0,n.useCallback)(async()=>{i(!0);try{const{data:e,error:r}=await tn.from("course_enrollments").select("*").order("enrolled_at",{ascending:!1});if(r)throw r;t(e||[])}catch(e){console.error("Error fetching enrollments:",e)}finally{i(!1)}},[]);(0,n.useEffect)(()=>{c()},[c]);const u=e.filter(e=>{var t,n,a,s,i;if(!r)return!0;const o=r.toLowerCase();return(null===(t=e.student_name)||void 0===t?void 0:t.toLowerCase().includes(o))||(null===(n=e.student_email)||void 0===n?void 0:n.toLowerCase().includes(o))||(null===(a=e.roll_number)||void 0===a?void 0:a.toLowerCase().includes(o))||(null===(s=e.course_name)||void 0===s?void 0:s.toLowerCase().includes(o))||(null===(i=e.department)||void 0===i?void 0:i.toLowerCase().includes(o))});return(0,E.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-6",children:(0,E.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,E.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-6",children:"Enrollment Management"}),(0,E.jsxs)("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[(0,E.jsxs)("div",{className:"text-lg font-semibold text-gray-700",children:["Total Enrollments: ",(0,E.jsx)("span",{className:"text-blue-600",children:e.length})]}),(0,E.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,E.jsxs)("button",{onClick:()=>{if(0===u.length)return void alert("No data to export.");const e=u.map(e=>[e.id,e.student_name,e.student_email,e.student_phone,e.roll_number,e.department,e.course_name,new Date(e.enrolled_at).toLocaleString()]),t=[["ID","Student Name","Email","Phone","Roll Number","Department","Course Name","Enrolled Date"].join(","),...e.map(e=>e.map(e=>{const t=String(e).replace(/"/g,'""');return'"'.concat(t,'"')}).join(","))].join("\n"),r=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(r),a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("download","enrollments_".concat((new Date).toISOString().slice(0,10),".csv")),document.body.appendChild(a),a.click(),document.body.removeChild(a)},className:"flex items-center gap-2 px-5 py-2.5 bg-gray-800 text-white rounded-lg font-semibold hover:bg-gray-900 transition shadow-lg",children:[(0,E.jsx)(w,{size:20}),"Export CSV"]}),(0,E.jsxs)("button",{onClick:async()=>{if(window.confirm("\u26a0\ufe0f Are you sure you want to delete ALL enrollments?"))try{const{error:e}=await tn.from("course_enrollments").delete().neq("id","");if(e)throw e;alert("All enrollments deleted successfully!"),t([])}catch(e){console.error("Error deleting all enrollments:",e),alert("Failed to delete all enrollments.")}},className:"flex items-center gap-2 px-5 py-2.5 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition shadow-lg",children:[(0,E.jsx)(_n,{size:20}),"Delete All"]})]})]}),(0,E.jsx)("div",{className:"mb-6",children:(0,E.jsxs)("div",{className:"relative",children:[(0,E.jsx)(gn,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,E.jsx)("input",{type:"text",placeholder:"Search by name, email, roll number, course, or department...",value:r,onChange:e=>a(e.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm"})]})}),s?(0,E.jsx)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:(0,E.jsx)("p",{className:"text-gray-600",children:"Loading enrollments..."})}):0===u.length?(0,E.jsx)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:(0,E.jsx)("p",{className:"text-gray-600",children:"No enrollments found"})}):(0,E.jsx)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:(0,E.jsx)("div",{className:"overflow-x-auto",children:(0,E.jsxs)("table",{className:"w-full",children:[(0,E.jsx)("thead",{className:"bg-gradient-to-r from-gray-700 to-gray-800 text-white",children:(0,E.jsxs)("tr",{children:[(0,E.jsx)("th",{className:"px-6 py-4 text-left text-xs font-bold uppercase tracking-wider",children:"Student Details"}),(0,E.jsx)("th",{className:"px-6 py-4 text-left text-xs font-bold uppercase tracking-wider",children:"Course"}),(0,E.jsx)("th",{className:"px-6 py-4 text-left text-xs font-bold uppercase tracking-wider",children:"Academic Info"}),(0,E.jsx)("th",{className:"px-6 py-4 text-left text-xs font-bold uppercase tracking-wider",children:"Enrolled Date"}),(0,E.jsx)("th",{className:"px-6 py-4 text-left text-xs font-bold uppercase tracking-wider",children:"Actions"})]})}),(0,E.jsx)("tbody",{className:"divide-y divide-gray-200",children:u.map(r=>(0,E.jsxs)("tr",{className:"hover:bg-blue-50 transition",children:[(0,E.jsx)("td",{className:"px-6 py-4",children:(0,E.jsxs)("div",{children:[(0,E.jsx)("div",{className:"text-sm font-semibold text-gray-900",children:r.student_name}),(0,E.jsx)("div",{className:"text-sm text-gray-600",children:r.student_email}),(0,E.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["\ud83d\udcde ",r.student_phone]})]})}),(0,E.jsx)("td",{className:"px-6 py-4",children:(0,E.jsx)("div",{className:"text-sm font-semibold text-blue-900",children:r.course_name})}),(0,E.jsx)("td",{className:"px-6 py-4",children:(0,E.jsxs)("div",{className:"text-sm",children:[(0,E.jsxs)("div",{className:"font-medium text-gray-900",children:["Roll: ",r.roll_number]}),(0,E.jsx)("div",{className:"text-gray-600",children:r.department})]})}),(0,E.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-600",children:[new Date(r.enrolled_at).toLocaleDateString(),(0,E.jsx)("div",{className:"text-xs text-gray-500",children:new Date(r.enrolled_at).toLocaleTimeString()})]}),(0,E.jsxs)("td",{className:"px-6 py-4 flex items-center gap-2",children:[(0,E.jsxs)("button",{onClick:()=>l(r),className:"flex items-center gap-1 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium shadow",title:"View Details",children:[(0,E.jsx)(Eh,{size:16}),"View"]}),(0,E.jsxs)("button",{onClick:()=>(async r=>{if(window.confirm("Are you sure you want to delete this enrollment?"))try{const{error:n}=await tn.from("course_enrollments").delete().eq("id",r);if(n)throw n;alert("Enrollment deleted successfully!"),t(e.filter(e=>e.id!==r))}catch(n){console.error("Error deleting enrollment:",n),alert("Failed to delete enrollment.")}})(r.id),className:"flex items-center gap-1 px-3 py-1.5 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium shadow",title:"Delete Enrollment",children:[(0,E.jsx)(_n,{size:16}),"Delete"]})]})]},r.id))})]})})}),o&&(0,E.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,E.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,E.jsxs)("div",{className:"sticky top-0 bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6 flex justify-between items-center rounded-t-xl",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("h2",{className:"text-2xl font-bold",children:"Enrollment Details"}),(0,E.jsx)("p",{className:"text-blue-100 text-sm mt-1",children:"Complete enrollment information"})]}),(0,E.jsx)("button",{onClick:()=>l(null),className:"text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-lg transition",children:(0,E.jsx)(yn,{size:24})})]}),(0,E.jsxs)("div",{className:"p-6 space-y-6",children:[(0,E.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 border-l-4 border-blue-600 rounded-lg p-5",children:[(0,E.jsx)("h3",{className:"font-bold text-xl text-blue-900 mb-4 flex items-center gap-2",children:"\ud83d\udc64 Student Information"}),(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Full Name"}),(0,E.jsx)("p",{className:"font-semibold text-gray-900 text-lg",children:o.student_name})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Email Address"}),(0,E.jsx)("p",{className:"font-semibold text-gray-900",children:o.student_email})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Phone Number"}),(0,E.jsx)("p",{className:"font-semibold text-gray-900",children:o.student_phone})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Roll Number"}),(0,E.jsx)("p",{className:"font-semibold text-gray-900",children:o.roll_number})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Department"}),(0,E.jsx)("p",{className:"font-semibold text-gray-900",children:o.department})]})]})]}),(0,E.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-green-100 border-l-4 border-green-600 rounded-lg p-5",children:[(0,E.jsx)("h3",{className:"font-bold text-xl text-green-900 mb-4 flex items-center gap-2",children:"\ud83d\udcda Course Information"}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Course Title"}),(0,E.jsx)("p",{className:"font-semibold text-gray-900 text-lg",children:o.course_name})]})]}),(0,E.jsxs)("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-l-4 border-gray-600 rounded-lg p-5",children:[(0,E.jsx)("h3",{className:"font-bold text-xl text-gray-900 mb-4 flex items-center gap-2",children:"\u23f1\ufe0f Timeline"}),(0,E.jsxs)("div",{className:"flex justify-between items-center bg-white p-3 rounded-lg shadow-sm",children:[(0,E.jsx)("span",{className:"text-gray-600 font-medium",children:"Enrolled at:"}),(0,E.jsx)("span",{className:"font-semibold text-gray-900",children:new Date(o.enrolled_at).toLocaleString()})]})]})]})]})})]})})}function Th(e){let{icon:t,title:r,value:n,color:a,subtitle:s}=e;return(0,E.jsx)("div",{className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition",children:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:r}),(0,E.jsx)("p",{className:"text-3xl font-bold text-gray-800",children:n}),s&&(0,E.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:s})]}),(0,E.jsx)("div",{className:"w-14 h-14 ".concat(a," rounded-lg flex items-center justify-center text-white"),children:t})]})})}function Nh(e){let{students:t,exams:r,attendance:n,announcements:a,results:s,enrollments:i}=e;const o=n.filter(e=>{const t=(new Date).toISOString().split("T")[0];return e.date===t&&"present"===e.status}),l=t.length>0?Math.round(o.length/t.length*100):0,c=r.filter(e=>new Date(e.exam_date)>new Date),u=s.length,d=s.length>0?Math.round(s.reduce((e,t)=>e+t.score,0)/s.length):0,h=i.length,f=i.filter(e=>"pending"===e.status).length,m=i.filter(e=>"approved"===e.status).length;return(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("h2",{className:"text-3xl font-bold text-gray-800",children:"Admin Dashboard"}),(0,E.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage students, exams, enrollments and attendance"})]}),(0,E.jsxs)("div",{className:"text-right",children:[(0,E.jsx)("p",{className:"text-sm text-gray-500",children:"Last Updated"}),(0,E.jsx)("p",{className:"text-sm font-medium text-gray-700",children:(new Date).toLocaleString()})]})]}),(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,E.jsx)(Th,{icon:(0,E.jsx)(an,{className:"w-6 h-6"}),title:"Total Students",value:t.length,color:"bg-blue-500",subtitle:"Active enrolled"}),(0,E.jsx)(Th,{icon:(0,E.jsx)(w,{className:"w-6 h-6"}),title:"Upcoming Exams",value:c.length,color:"bg-green-500",subtitle:"".concat(r.length," total exams")}),(0,E.jsx)(Th,{icon:(0,E.jsx)(_,{className:"w-6 h-6"}),title:"Today's Attendance",value:"".concat(l,"%"),color:"bg-purple-500",subtitle:"".concat(o.length,"/").concat(t.length," present")}),(0,E.jsx)(Th,{icon:(0,E.jsx)(S,{className:"w-6 h-6"}),title:"Course Enrollments",value:h,color:"bg-teal-500",subtitle:"".concat(f," pending approvals")})]}),(0,E.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,E.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsxs)("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[(0,E.jsx)(an,{className:"w-5 h-5 mr-2 text-indigo-600"}),"Recent Students"]}),(0,E.jsxs)("div",{className:"space-y-3",children:[t.slice(0,5).map(e=>(0,E.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center",children:(0,E.jsx)("span",{className:"text-indigo-600 font-semibold text-sm",children:e.name.charAt(0)})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"font-medium text-gray-800",children:e.name}),(0,E.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]})]}),(0,E.jsx)("div",{className:"text-sm text-gray-400",children:e.mobile})]},e.id)),0===t.length&&(0,E.jsx)("p",{className:"text-center text-gray-500 py-8",children:"No students yet"})]})]}),(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsxs)("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[(0,E.jsx)(w,{className:"w-5 h-5 mr-2 text-green-600"}),"Upcoming Exams"]}),(0,E.jsxs)("div",{className:"space-y-3",children:[c.slice(0,3).map(e=>{var t;return(0,E.jsxs)("div",{className:"p-3 bg-green-50 rounded-lg border border-green-100",children:[(0,E.jsx)("p",{className:"font-medium text-gray-800",children:e.title}),(0,E.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mt-1",children:[(0,E.jsxs)("span",{children:[(null===(t=e.questions)||void 0===t?void 0:t.length)||0," questions"]}),(0,E.jsxs)("span",{children:[e.duration," min"]})]}),(0,E.jsx)("p",{className:"text-xs text-green-600 mt-1",children:new Date(e.exam_date).toLocaleDateString()})]},e.id)}),0===c.length&&(0,E.jsx)("p",{className:"text-center text-gray-500 py-4 text-sm",children:"No upcoming exams"})]})]}),(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsxs)("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[(0,E.jsx)(S,{className:"w-5 h-5 mr-2 text-teal-600"}),"Recent Enrollments"]}),(0,E.jsxs)("div",{className:"space-y-3",children:[i.slice(0,3).map(e=>(0,E.jsxs)("div",{className:"p-3 bg-teal-50 rounded-lg border border-teal-100",children:[(0,E.jsx)("p",{className:"font-medium text-gray-800 text-sm",children:e.student_name}),(0,E.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:e.course_name}),(0,E.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,E.jsx)("span",{className:"px-2 py-0.5 text-xs rounded-full font-medium ".concat("approved"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status}),(0,E.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.enrolled_at).toLocaleDateString()})]})]},e.id)),0===i.length&&(0,E.jsx)("p",{className:"text-center text-gray-500 py-4 text-sm",children:"No enrollments yet"})]})]})]})]}),(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsxs)("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[(0,E.jsx)(dn,{className:"w-5 h-5 mr-2 text-orange-600"}),"Recent Announcements"]}),(0,E.jsxs)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[a.slice(0,5).map(e=>{var t;return(0,E.jsxs)("div",{className:"p-4 rounded-lg border ".concat("exam"===e.type?"bg-blue-50 border-blue-100":"bg-green-50 border-green-100"),children:[(0,E.jsx)("div",{className:"flex items-center gap-2 mb-1",children:(0,E.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium rounded ".concat("exam"===e.type?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"),children:(null===(t=e.type)||void 0===t?void 0:t.toUpperCase())||"GENERAL"})}),(0,E.jsx)("h4",{className:"font-semibold text-gray-800 mb-1 text-sm",children:e.title}),(0,E.jsx)("p",{className:"text-xs text-gray-600 line-clamp-2",children:e.message}),(0,E.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:new Date(e.created_at).toLocaleDateString()})]},e.id)}),0===a.length&&(0,E.jsx)("p",{className:"text-center text-gray-500 py-8 text-sm",children:"No announcements yet"})]})]}),(0,E.jsxs)("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-lg shadow p-6 text-white",children:[(0,E.jsxs)("h3",{className:"text-lg font-bold mb-4 flex items-center",children:[(0,E.jsx)(pn,{className:"w-5 h-5 mr-2"}),"Quick Stats"]}),(0,E.jsxs)("div",{className:"space-y-3",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center bg-white bg-opacity-20 p-3 rounded",children:[(0,E.jsx)("span",{className:"text-sm",children:"Total Exams"}),(0,E.jsx)("span",{className:"font-bold text-lg",children:r.length})]}),(0,E.jsxs)("div",{className:"flex justify-between items-center bg-white bg-opacity-20 p-3 rounded",children:[(0,E.jsx)("span",{className:"text-sm",children:"Completed"}),(0,E.jsx)("span",{className:"font-bold text-lg",children:u})]}),(0,E.jsxs)("div",{className:"flex justify-between items-center bg-white bg-opacity-20 p-3 rounded",children:[(0,E.jsx)("span",{className:"text-sm",children:"Avg Score"}),(0,E.jsxs)("span",{className:"font-bold text-lg",children:[d,"%"]})]}),(0,E.jsxs)("div",{className:"flex justify-between items-center bg-white bg-opacity-20 p-3 rounded",children:[(0,E.jsx)("span",{className:"text-sm",children:"Total Enrollments"}),(0,E.jsx)("span",{className:"font-bold text-lg",children:h})]}),(0,E.jsxs)("div",{className:"flex justify-between items-center bg-white bg-opacity-20 p-3 rounded",children:[(0,E.jsx)("span",{className:"text-sm",children:"Pending"}),(0,E.jsx)("span",{className:"font-bold text-lg",children:f})]}),(0,E.jsxs)("div",{className:"flex justify-between items-center bg-white bg-opacity-20 p-3 rounded",children:[(0,E.jsx)("span",{className:"text-sm",children:"Approved"}),(0,E.jsx)("span",{className:"font-bold text-lg",children:m})]})]})]})]})]})]})}function jh(e){let{user:t,onLogout:r}=e;const[a,s]=(0,n.useState)("dashboard"),[i,o]=(0,n.useState)([]),[l,c]=(0,n.useState)([]),[u,d]=(0,n.useState)([]),[h,f]=(0,n.useState)([]),[m,p]=(0,n.useState)([]),[g,v]=(0,n.useState)([]),[b,y]=(0,n.useState)(!0);(0,n.useEffect)(()=>{x();const e=tn.channel("students_changes").on("postgres_changes",{event:"*",schema:"public",table:"students"},()=>{x()}).subscribe(),t=tn.channel("exams_changes").on("postgres_changes",{event:"*",schema:"public",table:"exams"},()=>{x()}).subscribe(),r=tn.channel("attendance_changes").on("postgres_changes",{event:"*",schema:"public",table:"attendance"},()=>{x()}).subscribe(),n=tn.channel("announcements_changes").on("postgres_changes",{event:"*",schema:"public",table:"announcements"},()=>{x()}).subscribe(),a=tn.channel("enrollments_changes").on("postgres_changes",{event:"*",schema:"public",table:"course_enrollments"},()=>{x()}).subscribe();return()=>{e.unsubscribe(),t.unsubscribe(),r.unsubscribe(),n.unsubscribe(),a.unsubscribe()}},[]);const x=async()=>{try{y(!0);const[e,t,r,n,a,s]=await Promise.all([tn.from("students").select("*").order("created_at",{ascending:!1}),tn.from("exams").select("*").order("created_at",{ascending:!1}),tn.from("attendance").select("*").order("date",{ascending:!1}),tn.from("announcements").select("*").order("created_at",{ascending:!1}),tn.from("results").select("*"),tn.from("course_enrollments").select("*").order("enrolled_at",{ascending:!1})]);e.data&&o(e.data),t.data&&c(t.data),r.data&&d(r.data),n.data&&f(n.data),a.data&&p(a.data),s.data&&v(s.data)}catch(e){console.error("Error loading data:",e)}finally{y(!1)}};return b?(0,E.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-600 mx-auto"}),(0,E.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading Dashboard..."})]})}):(0,E.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[(0,E.jsx)(fn,{user:t,userType:"admin",activeTab:a,setActiveTab:s,onLogout:r}),(0,E.jsxs)("main",{className:"flex-1 max-w-7xl w-full mx-auto px-4 py-6",children:["dashboard"===a&&(0,E.jsx)(Nh,{students:i,exams:l,attendance:u,announcements:h,results:m,enrollments:g}),"students"===a&&(0,E.jsx)(En,{students:i,onRefresh:x}),"attendance"===a&&(0,E.jsx)(jn,{students:i,attendance:u,onRefresh:x}),"exam"===a&&(0,E.jsx)(wh,{exams:l,students:i,onRefresh:x}),"enrollments"===a&&(0,E.jsx)(kh,{}),"announcements"===a&&(0,E.jsx)(_h,{})]}),(0,E.jsx)(mn,{})]})}function Ah(e){let{attendance:t}=e;const r=Nn(t),n=t.filter(e=>"present"===e.status).length,a=t.filter(e=>"absent"===e.status).length;return(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,E.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Attendance Rate"}),(0,E.jsxs)("p",{className:"text-3xl font-bold text-indigo-600",children:[r,"%"]})]}),(0,E.jsx)("div",{className:"w-16 h-16 rounded-full flex items-center justify-center ".concat(r>=75?"bg-green-100":r>=50?"bg-yellow-100":"bg-red-100"),children:(0,E.jsx)(x,{className:"w-8 h-8 ".concat(r>=75?"text-green-600":r>=50?"text-yellow-600":"text-red-600")})})]})}),(0,E.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Present Days"}),(0,E.jsx)("p",{className:"text-3xl font-bold text-green-600",children:n})]}),(0,E.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:(0,E.jsx)(x,{className:"w-8 h-8 text-green-600"})})]})}),(0,E.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Absent Days"}),(0,E.jsx)("p",{className:"text-3xl font-bold text-red-600",children:a})]}),(0,E.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:(0,E.jsx)(kn,{className:"w-8 h-8 text-red-600"})})]})})]}),(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Attendance History (Last 30 Days)"}),(0,E.jsx)("div",{className:"overflow-x-auto",children:(0,E.jsxs)("table",{className:"w-full",children:[(0,E.jsx)("thead",{className:"bg-gray-50",children:(0,E.jsxs)("tr",{children:[(0,E.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"S.No"}),(0,E.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),(0,E.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),(0,E.jsxs)("tbody",{className:"divide-y divide-gray-200",children:[t.slice(-30).reverse().map((e,t)=>(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:t+1}),(0,E.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:Tn(e.date)}),(0,E.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,E.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("present"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"present"===e.status?"\u2713 Present":"\u2717 Absent"})})]},e.id)),0===t.length&&(0,E.jsx)("tr",{children:(0,E.jsx)("td",{colSpan:"3",className:"px-4 py-8 text-center text-gray-500",children:"No attendance records found"})})]})]})})]})]})}const Ch=v("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),Oh=v("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),Ph=v("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),Rh=v("maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]),Ih=v("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);function Dh(e){let{exam:t,user:r,onComplete:a,onCancel:s}=e;const[i,o]=(0,n.useState)(0),[l,u]=(0,n.useState)({}),[d,h]=(0,n.useState)(60*t.duration),[f,m]=(0,n.useState)(!1),[p,g]=(0,n.useState)(!0),[v,b]=(0,n.useState)(!0),[y,x]=(0,n.useState)(""),[w,S]=(0,n.useState)(null),[_,k]=(0,n.useState)(!1),T=(0,n.useRef)(null),N=(0,n.useRef)(null),A=(0,n.useCallback)(()=>{const e=new Date,r=new Date(t.start_time),n=new Date(t.end_time);return e>=r&&e<=n},[t.start_time,t.end_time]),C=(0,n.useCallback)(async()=>{await(async()=>{try{document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.msExitFullscreen&&await document.msExitFullscreen()}catch(e){console.error("Exit fullscreen error:",e)}})(),A()||alert("Exam time has ended. Submitting your answers...");const e=t.questions||[];let n=0,s=0;e.forEach((e,t)=>{const r=l[t];if("radio"===e.type){const t=e.points||1;s+=t,r===e.correctAnswer&&(n+=t)}else if("checkbox"===e.type){const t=e.points||1;s+=t;const a=e.correctAnswers||[],i=r||[];JSON.stringify([...i].sort())===JSON.stringify([...a].sort())&&(n+=t)}});const i=e.some(e=>"text"===e.type),o=s>0?Math.round(n/s*100):0,c={student_id:r.id,exam_id:t.id,student_name:y,exam_title:t.title,score:i?null:o,auto_score:n,total_auto_points:s,answers:l,text_scores:null,graded:!i,submitted_at:(new Date).toISOString()};console.log("Score Calculation:",{autoScore:n,totalAutoPoints:s,scorePercent:o,hasTextQuestions:i}),await a(c)},[t.questions,t.id,t.title,l,y,r.id,a,A]);(0,n.useEffect)(()=>{const e=()=>{const e=!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement);k(e),e||p||v||(alert("\u26a0\ufe0f Fullscreen mode exited. Auto-submitting your exam..."),C())};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e)}},[p,v,C]),(0,n.useEffect)(()=>{if(!p&&!v&&d>0&&A()){const e=setInterval(()=>{h(e=>e<=1||!A()?(C(),0):e-1)},1e3);return()=>clearInterval(e)}},[p,v,d,A,C]),(0,n.useEffect)(()=>{const e=e=>e.preventDefault(),t=e=>e.preventDefault();if(!p&&!v)return document.addEventListener("contextmenu",e),document.addEventListener("copy",t),document.addEventListener("cut",t),()=>{document.removeEventListener("contextmenu",e),document.removeEventListener("copy",t),document.removeEventListener("cut",t)}},[p,v]);const O=()=>{y.trim()?b(!1):alert("Please enter your name to continue")},P=async()=>{if(A())try{await(async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:!0});T.current&&(T.current.srcObject=e),m(!0)}catch(e){throw alert("Camera access is required to start the exam"),e}})(),setTimeout(async()=>{(()=>{if(T.current&&N.current){const e=T.current,t=N.current;t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0);const r=t.toDataURL("image/jpeg");return S(r),r}return null})()?(alert("\u2713 Photo captured successfully! Entering fullscreen..."),await(async()=>{try{const e=document.documentElement;e.requestFullscreen?await e.requestFullscreen():e.webkitRequestFullscreen?await e.webkitRequestFullscreen():e.mozRequestFullScreen?await e.mozRequestFullScreen():e.msRequestFullscreen&&await e.msRequestFullscreen()}catch(e){console.error("Fullscreen error:",e)}})(),g(!1)):alert("Failed to capture photo. Please try again.")},1500)}catch(e){alert("Camera access is required to start the exam")}else alert("Exam is not active at this time. Please wait for the scheduled time.")},R=e=>{u(c(c({},l),{},{[i]:e}))};if(v)return(0,E.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center p-4",children:(0,E.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full",children:[(0,E.jsxs)("div",{className:"text-center mb-6",children:[(0,E.jsx)("div",{className:"w-20 h-20 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,E.jsx)(j,{className:"w-10 h-10 text-indigo-600"})}),(0,E.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Welcome to Exam"}),(0,E.jsx)("p",{className:"text-gray-600",children:t.title})]}),(0,E.jsxs)("div",{className:"space-y-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter Your Name *"}),(0,E.jsx)("input",{type:"text",value:y,onChange:e=>x(e.target.value),placeholder:"Full Name",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-lg",onKeyPress:e=>"Enter"===e.key&&O()})]}),(0,E.jsx)("button",{onClick:O,disabled:!y.trim(),className:"w-full px-6 py-4 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium text-lg disabled:opacity-50 disabled:cursor-not-allowed transition",children:"Continue to Instructions"}),(0,E.jsx)("button",{onClick:s,className:"w-full px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",children:"Cancel"})]})]})});if(p){var I,D,L;const e=(null===(I=t.questions)||void 0===I?void 0:I.filter(e=>"text"===e.type).length)||0,r=(null===(D=t.questions)||void 0===D?void 0:D.filter(e=>"radio"===e.type||"checkbox"===e.type).length)||0,n=A(),a=new Date,i=new Date(t.start_time);return(0,E.jsx)("div",{className:"max-w-3xl mx-auto p-4",children:(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[(0,E.jsxs)("div",{className:"mb-4 p-4 bg-indigo-50 rounded-lg",children:[(0,E.jsx)("p",{className:"text-sm text-gray-600",children:"Student Name"}),(0,E.jsx)("p",{className:"text-xl font-bold text-indigo-600",children:y})]}),(0,E.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:t.title}),(0,E.jsxs)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:[(0,E.jsxs)("h2",{className:"font-bold text-yellow-800 mb-2 flex items-center",children:[(0,E.jsx)(j,{className:"w-5 h-5 mr-2"}),"Important Instructions"]}),(0,E.jsxs)("ul",{className:"list-disc list-inside space-y-2 text-sm text-yellow-700",children:[(0,E.jsx)("li",{children:"Camera access is mandatory - your photo will be captured"}),(0,E.jsx)("li",{className:"font-bold text-red-700",children:"Exam will enter FULLSCREEN mode automatically"}),(0,E.jsx)("li",{className:"font-bold text-red-700",children:"Pressing ESC or exiting fullscreen will AUTO-SUBMIT your exam"}),(0,E.jsx)("li",{children:"Right-click and copy-paste are disabled"}),(0,E.jsx)("li",{children:"Exam will auto-submit when time expires"}),e>0&&(0,E.jsxs)("li",{className:"font-bold text-orange-700",children:[e," text question(s) - manually graded (5 marks each)"]}),r>0&&(0,E.jsxs)("li",{className:"font-bold text-green-700",children:[r," MCQ question(s) - auto-graded (1 mark each)"]})]})]}),(0,E.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,E.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,E.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Duration"}),(0,E.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:[t.duration," min"]})]}),(0,E.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,E.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Questions"}),(0,E.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:(null===(L=t.questions)||void 0===L?void 0:L.length)||0})]}),(0,E.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,E.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Start Time"}),(0,E.jsx)("p",{className:"text-lg font-bold text-green-600",children:new Date(t.start_time).toLocaleTimeString()})]}),(0,E.jsxs)("div",{className:"bg-orange-50 p-4 rounded-lg",children:[(0,E.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"End Time"}),(0,E.jsx)("p",{className:"text-lg font-bold text-orange-600",children:new Date(t.end_time).toLocaleTimeString()})]})]}),!n&&(0,E.jsxs)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 mb-6",children:[(0,E.jsx)("p",{className:"text-red-700 font-bold",children:a<i?"\u23f0 Exam has not started yet":"\ud83d\udd12 Exam time has ended"}),(0,E.jsx)("p",{className:"text-red-600 text-sm mt-1",children:a<i?"Please wait until ".concat(new Date(t.start_time).toLocaleString()):"This exam is no longer available"})]}),(0,E.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg mb-6",children:[(0,E.jsx)("video",{ref:T,autoPlay:!0,muted:!0,className:"w-full h-48 bg-gray-200 rounded-lg object-cover"}),(0,E.jsx)("canvas",{ref:N,className:"hidden"}),!f&&(0,E.jsx)("p",{className:"text-center text-gray-500 mt-2",children:"\ud83d\udcf7 Camera preview will appear here"}),f&&!w&&(0,E.jsx)("p",{className:"text-center text-green-600 mt-2 font-medium",children:"\u2713 Camera is active"})]}),(0,E.jsxs)("div",{className:"flex space-x-3",children:[(0,E.jsxs)("button",{onClick:P,disabled:!n||f,className:"flex-1 flex items-center justify-center space-x-2 px-6 py-3 rounded-lg font-medium ".concat(n&&!f?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:[(0,E.jsx)(Ph,{className:"w-5 h-5"}),(0,E.jsx)(Rh,{className:"w-5 h-5"}),(0,E.jsx)("span",{children:n?f?"Starting...":"Start Exam (Fullscreen)":a<i?"Exam Not Started":"Exam Ended"})]}),(0,E.jsx)("button",{onClick:s,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium",children:"Cancel"})]})]})})}const M=t.questions[i],F=(i+1)/t.questions.length*100,U=A();return(0,E.jsx)("div",{className:"max-w-4xl mx-auto p-4",children:(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow-lg",children:[(0,E.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 p-6 text-white",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("h1",{className:"text-2xl font-bold",children:t.title}),(0,E.jsxs)("p",{className:"text-sm text-indigo-100 mt-1",children:["Student: ",y]})]}),(0,E.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-2 bg-white bg-opacity-20 px-4 py-2 rounded-lg",children:[(0,E.jsx)(Cn,{className:"w-5 h-5"}),(0,E.jsxs)("span",{className:"font-mono font-bold",children:[Math.floor(d/60),":",(d%60).toString().padStart(2,"0")]})]}),(0,E.jsx)("video",{ref:T,autoPlay:!0,muted:!0,className:"w-24 h-16 bg-gray-800 rounded-lg object-cover"})]})]}),(0,E.jsx)("div",{className:"w-full bg-white bg-opacity-20 rounded-full h-2",children:(0,E.jsx)("div",{className:"bg-white h-2 rounded-full transition-all duration-300",style:{width:"".concat(F,"%")}})}),(0,E.jsxs)("p",{className:"text-sm mt-2 text-indigo-100",children:["Question ",i+1," of ",t.questions.length,_&&(0,E.jsx)("span",{className:"ml-4 text-yellow-300",children:"\ud83d\udd12 Fullscreen Active"})]})]}),(0,E.jsxs)("div",{className:"p-8",children:[(0,E.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,E.jsxs)("h2",{className:"text-xl font-bold text-gray-800",children:[i+1,". ",M.question]}),(0,E.jsxs)("span",{className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm font-bold",children:[M.points," ",1===M.points?"mark":"marks"]})]}),"text"===M.type&&(0,E.jsxs)("div",{className:"mb-4 p-3 bg-orange-50 border-l-4 border-orange-400 text-sm text-orange-700",children:[(0,E.jsx)("p",{className:"font-medium",children:"Text answer question (5 marks)"}),(0,E.jsx)("p",{children:"Will be manually graded by admin"})]}),(0,E.jsxs)("div",{className:"space-y-3 mb-8",children:["radio"===M.type&&M.options.map((e,t)=>(0,E.jsxs)("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-indigo-50 hover:border-indigo-300 transition",children:[(0,E.jsx)("input",{type:"radio",name:"answer",value:e,checked:l[i]===e,onChange:e=>R(e.target.value),className:"w-5 h-5 text-indigo-600"}),(0,E.jsx)("span",{className:"ml-3 text-gray-700",children:e})]},t)),"checkbox"===M.type&&M.options.map((e,t)=>(0,E.jsxs)("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-indigo-50 hover:border-indigo-300 transition",children:[(0,E.jsx)("input",{type:"checkbox",value:e,checked:(l[i]||[]).includes(e),onChange:t=>{const r=l[i]||[];t.target.checked?R([...r,e]):R(r.filter(t=>t!==e))},className:"w-5 h-5 text-indigo-600"}),(0,E.jsx)("span",{className:"ml-3 text-gray-700",children:e})]},t)),"text"===M.type&&(0,E.jsx)("textarea",{value:l[i]||"",onChange:e=>R(e.target.value),className:"w-full px-4 py-3 border-2 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",rows:"8",placeholder:"Type your answer here... (Manually graded for 5 marks)"})]}),(0,E.jsxs)("div",{className:"flex justify-between items-center",children:[(0,E.jsx)("button",{onClick:()=>o(Math.max(0,i-1)),disabled:0===i,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:"Previous"}),(0,E.jsxs)("div",{className:"text-sm text-gray-600",children:[Object.keys(l).length," of ",t.questions.length," answered"]}),i<t.questions.length-1?(0,E.jsx)("button",{onClick:()=>o(i+1),className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium",children:"Next"}):(0,E.jsxs)("button",{onClick:C,disabled:!U,className:"flex items-center space-x-2 px-6 py-3 rounded-lg font-medium ".concat(U?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:[(0,E.jsx)(Ih,{className:"w-5 h-5"}),(0,E.jsx)("span",{children:U?"Finish Exam":"Time Expired"})]})]})]})]})})}function Lh(e){let{user:t,exams:r,results:a,onRefresh:s}=e;const[i,o]=(0,n.useState)(null),[l,c]=(0,n.useState)(!1),[u,d]=(0,n.useState)(!0),[h]=(0,n.useState)(null),[f,m]=(0,n.useState)(new Date);(0,n.useEffect)(()=>{const e=setInterval(()=>{m(new Date)},6e4);return()=>clearInterval(e)},[]);const p=(0,n.useCallback)(e=>{if(!e.start_time||!e.end_time)return console.warn("Exam missing time window:",e),!1;const t=f,r=new Date(e.start_time),n=new Date(e.end_time);return console.log("Time check:",{examTitle:e.title,now:t.toISOString(),start:r.toISOString(),end:n.toISOString(),isAvailable:t>=r&&t<=n}),t>=r&&t<=n},[f]),g=(0,n.useCallback)(e=>{if(!e.start_time||!e.end_time)return"unknown";const t=f,r=new Date(e.start_time),n=new Date(e.end_time);return t<r?"upcoming":t>n?"closed":"active"},[f]);(0,n.useEffect)(()=>{console.log("=== ExamPortal Debug ==="),console.log("User:",t),console.log("Exams received:",r),console.log("Results received:",a),console.log("Exams count:",(null===r||void 0===r?void 0:r.length)||0),console.log("Results count:",(null===a||void 0===a?void 0:a.length)||0),console.log("Current time:",f.toISOString()),r&&r.length>0&&r.forEach((e,t)=>{console.log("Exam ".concat(t+1,":"),{id:e.id,title:e.title,start_time:e.start_time,end_time:e.end_time,status:g(e),isAvailable:p(e)})}),d(!1)},[r,a,f,t,g,p]);const v=(r||[]).filter(e=>{const r=(a||[]).some(r=>r.exam_id===e.id&&r.student_id===(null===t||void 0===t?void 0:t.id));return console.log('Exam "'.concat(e.title,'":'),{hasResult:r,examId:e.id,studentId:null===t||void 0===t?void 0:t.id,matchingResults:(a||[]).filter(t=>t.exam_id===e.id)}),!r}),b=(r||[]).filter(e=>(a||[]).some(r=>r.exam_id===e.id&&r.student_id===(null===t||void 0===t?void 0:t.id)));return console.log("Filtered - Upcoming:",v.length,"Completed:",b.length),console.log("All exams:",(null===r||void 0===r?void 0:r.length)||0),console.log("All results:",(null===a||void 0===a?void 0:a.length)||0),l&&i?(0,E.jsx)(Dh,{exam:i,user:t,onComplete:async e=>{try{console.log("Submitting exam result:",e);const{data:t,error:r}=await tn.from("results").insert([e]).select();if(r)return console.error("Supabase error:",r),void alert("Error saving exam result: ".concat(r.message));console.log("Result saved successfully:",t),alert("\u2705 Exam submitted successfully!"),c(!1),o(null),s()}catch(t){console.error("Unexpected error:",t),alert("Unexpected error: ".concat(t.message))}},onCancel:()=>{window.confirm("Are you sure you want to cancel? Your progress will be lost.")&&(c(!1),o(null))}}):u?(0,E.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),(0,E.jsx)("p",{className:"text-gray-600",children:"Loading exams..."})]})}):h?(0,E.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:(0,E.jsxs)("div",{className:"flex items-center space-x-3 text-red-800",children:[(0,E.jsx)(j,{className:"w-6 h-6"}),(0,E.jsxs)("div",{children:[(0,E.jsx)("h3",{className:"font-semibold",children:"Error Loading Exams"}),(0,E.jsx)("p",{className:"text-sm mt-1",children:h})]})]})}):r&&0!==r.length?(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,E.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[(0,E.jsx)(w,{className:"w-7 h-7 mr-2 text-indigo-600"}),"Available Exams"]}),(0,E.jsx)("button",{onClick:s,className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition",children:"Refresh"})]}),0===v.length?(0,E.jsxs)("div",{className:"text-center py-12",children:[(0,E.jsx)(w,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,E.jsx)("p",{className:"text-gray-500 text-lg",children:"No upcoming exams available"}),(0,E.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:b.length>0?"You have completed all available exams":"Check back later for new exams"})]}):(0,E.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map(e=>{var t,r,n,a;const s=(null===(t=e.questions)||void 0===t?void 0:t.filter(e=>"text"===e.type).length)||0,i=(null===(r=e.questions)||void 0===r?void 0:r.filter(e=>"radio"===e.type||"checkbox"===e.type).length)||0,l=g(e),u=p(e),d=(e=>{const t=f,r=new Date(e.start_time),n=new Date(e.end_time),a=g(e);if("upcoming"===a){const e=r-t,n=Math.ceil(e/6e4),a=Math.floor(n/60),s=n%60;return a>0?"Starts in ".concat(a,"h ").concat(s,"m"):"Starts in ".concat(n," minutes")}if("active"===a){const e=n-t,r=Math.floor(e/6e4),a=Math.floor(r/60),s=r%60;return a>0?"".concat(a,"h ").concat(s,"m remaining"):"".concat(r," min remaining")}return"Exam closed"})(e);return(0,E.jsxs)("div",{className:"p-6 rounded-lg border-2 transition shadow-sm hover:shadow-md ".concat("active"===l?"bg-gradient-to-br from-green-50 to-emerald-50 border-green-300":"upcoming"===l?"bg-gradient-to-br from-indigo-50 to-purple-50 border-indigo-100":"bg-gray-50 border-gray-200"),children:[(0,E.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,E.jsx)("h3",{className:"font-bold text-lg text-gray-800",children:e.title}),"active"===l&&(0,E.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs font-bold rounded-full animate-pulse",children:"LIVE"}),"upcoming"===l&&(0,E.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-bold rounded-full",children:"SOON"}),"closed"===l&&(0,E.jsx)("span",{className:"px-2 py-1 bg-gray-200 text-gray-600 text-xs font-bold rounded-full",children:"CLOSED"})]}),(0,E.jsx)("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:e.description||"No description provided"}),(0,E.jsxs)("div",{className:"space-y-2 text-sm mb-4",children:[(0,E.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,E.jsx)(_,{className:"w-4 h-4 mr-2 text-indigo-500"}),(0,E.jsx)("span",{children:new Date(e.exam_date).toLocaleDateString()})]}),(0,E.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,E.jsx)(Cn,{className:"w-4 h-4 mr-2 text-indigo-500"}),(0,E.jsxs)("span",{children:[e.duration," minutes"]})]}),(0,E.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,E.jsx)(w,{className:"w-4 h-4 mr-2 text-indigo-500"}),(0,E.jsxs)("span",{children:[(null===(n=e.questions)||void 0===n?void 0:n.length)||0," questions"]})]}),(0,E.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,E.jsx)(Ch,{className:"w-4 h-4 mr-2 text-indigo-500"}),(0,E.jsxs)("span",{children:["Total: ",e.total_points||(null===(a=e.questions)||void 0===a?void 0:a.length)," points"]})]})]}),(0,E.jsxs)("div",{className:"mb-4 p-3 bg-white rounded-lg border",children:[(0,E.jsx)("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"\ud83d\udcc5 Exam Schedule:"}),(0,E.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[(0,E.jsx)("span",{children:"Start:"}),(0,E.jsx)("span",{className:"font-medium text-green-600",children:new Date(e.start_time).toLocaleString()})]}),(0,E.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[(0,E.jsx)("span",{children:"End:"}),(0,E.jsx)("span",{className:"font-medium text-red-600",children:new Date(e.end_time).toLocaleString()})]})]}),(s>0||i>0)&&(0,E.jsxs)("div",{className:"mb-4 p-3 bg-white rounded-lg border",children:[(0,E.jsx)("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Question Breakdown:"}),i>0&&(0,E.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[(0,E.jsx)("span",{children:"\u2022 MCQ Questions:"}),(0,E.jsxs)("span",{className:"font-medium text-green-600",children:[i," (",i," mark",1!==i?"s":"",")"]})]}),s>0&&(0,E.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[(0,E.jsx)("span",{children:"\u2022 Text Questions:"}),(0,E.jsxs)("span",{className:"font-medium text-orange-600",children:[s," (",5*s," marks)"]})]})]}),"upcoming"===l&&(0,E.jsx)("div",{className:"mb-3 p-2 bg-blue-50 border border-blue-200 rounded text-center",children:(0,E.jsxs)("p",{className:"text-xs text-blue-700 font-medium",children:["\u23f0 ",d]})}),"closed"===l&&(0,E.jsx)("div",{className:"mb-3 p-2 bg-red-50 border border-red-200 rounded text-center",children:(0,E.jsx)("p",{className:"text-xs text-red-700 font-medium",children:"\ud83d\udd12 Exam window has closed"})}),"active"===l&&(0,E.jsx)("div",{className:"mb-3 p-2 bg-green-50 border border-green-200 rounded text-center",children:(0,E.jsxs)("p",{className:"text-xs text-green-700 font-medium",children:["\u2713 Exam is live now! ",d]})}),(0,E.jsxs)("button",{onClick:()=>{u?(o(e),c(!0)):"upcoming"===l?alert("Exam has not started yet. Please wait until ".concat(new Date(e.start_time).toLocaleString())):alert("Exam time window has closed.")},disabled:!u,className:"w-full flex items-center justify-center space-x-2 px-4 py-2 rounded-lg transition font-medium ".concat(u?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:[(0,E.jsx)(Oh,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"upcoming"===l?"Not Started Yet":"closed"===l?"Exam Closed":"Start Exam"})]})]},e.id)})})]}),(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsxs)("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,E.jsx)(x,{className:"w-6 h-6 mr-2 text-green-600"}),"Completed Exams"]}),(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[b.map(e=>{var r;const n=a.find(r=>r.exam_id===e.id&&r.student_id===(null===t||void 0===t?void 0:t.id)),s=null===(r=e.questions)||void 0===r?void 0:r.some(e=>"text"===e.type);return(0,E.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg border-2 border-gray-200 hover:border-gray-300 transition",children:[(0,E.jsx)("h3",{className:"font-bold text-gray-800 mb-3",children:e.title}),(0,E.jsxs)("div",{className:"space-y-2 text-sm mb-4",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center",children:[(0,E.jsx)("span",{className:"text-gray-600",children:"Status:"}),(0,E.jsx)("span",{className:"font-medium flex items-center space-x-1 ".concat(null!==n&&void 0!==n&&n.graded?"text-green-600":"text-orange-600"),children:null!==n&&void 0!==n&&n.graded?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(x,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Graded"})]}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(Cn,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Pending Grading"})]})})]}),(0,E.jsxs)("div",{className:"flex justify-between items-center",children:[(0,E.jsx)("span",{className:"text-gray-600",children:"Score:"}),null!==n&&void 0!==n&&n.graded?(0,E.jsxs)("span",{className:"font-bold text-indigo-600 text-lg",children:[null===n||void 0===n?void 0:n.score,"%"]}):(0,E.jsx)("span",{className:"text-orange-600 font-medium text-sm",children:s?"Awaiting Manual Grading":"Processing..."})]}),(0,E.jsxs)("div",{className:"flex justify-between items-center",children:[(0,E.jsx)("span",{className:"text-gray-600",children:"Submitted:"}),(0,E.jsx)("span",{className:"text-gray-800",children:new Date(null===n||void 0===n?void 0:n.submitted_at).toLocaleDateString()})]}),(0,E.jsxs)("div",{className:"flex justify-between items-center",children:[(0,E.jsx)("span",{className:"text-gray-600",children:"Time:"}),(0,E.jsx)("span",{className:"text-gray-800",children:new Date(null===n||void 0===n?void 0:n.submitted_at).toLocaleTimeString()})]})]}),(null===n||void 0===n?void 0:n.graded)&&(0,E.jsx)("div",{className:"pt-3 border-t border-gray-200",children:(0,E.jsx)("div",{className:"px-3 py-2 rounded-lg text-center text-sm font-medium ".concat((null===n||void 0===n?void 0:n.score)>=75?"bg-green-100 text-green-800":(null===n||void 0===n?void 0:n.score)>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:(null===n||void 0===n?void 0:n.score)>=75?"\ud83c\udf89 Excellent Performance!":(null===n||void 0===n?void 0:n.score)>=50?"\ud83d\udc4d Good Job!":"\ud83d\udcda Keep Practicing!"})}),!(null!==n&&void 0!==n&&n.graded)&&s&&(0,E.jsx)("div",{className:"pt-3 border-t border-gray-200",children:(0,E.jsx)("div",{className:"px-3 py-2 bg-orange-50 border border-orange-200 rounded-lg text-center",children:(0,E.jsx)("p",{className:"text-xs text-orange-700 font-medium",children:"\u23f3 Text answers are being reviewed"})})})]},e.id)}),0===b.length&&(0,E.jsxs)("div",{className:"col-span-3 text-center py-12",children:[(0,E.jsx)(kn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,E.jsx)("p",{className:"text-gray-500 text-lg",children:"No completed exams yet"}),(0,E.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:"Take an exam to see your results here"})]})]})]}),b.length>0&&(0,E.jsxs)("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg shadow p-6 text-white",children:[(0,E.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Your Performance Summary"}),(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,E.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-4",children:[(0,E.jsx)("p",{className:"text-sm opacity-90 mb-1",children:"Total Exams"}),(0,E.jsx)("p",{className:"text-3xl font-bold",children:b.length})]}),(0,E.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-4",children:[(0,E.jsx)("p",{className:"text-sm opacity-90 mb-1",children:"Graded"}),(0,E.jsx)("p",{className:"text-3xl font-bold",children:a.filter(e=>e.graded).length})]}),(0,E.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-4",children:[(0,E.jsx)("p",{className:"text-sm opacity-90 mb-1",children:"Pending"}),(0,E.jsx)("p",{className:"text-3xl font-bold",children:a.filter(e=>!e.graded).length})]}),(0,E.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-4",children:[(0,E.jsx)("p",{className:"text-sm opacity-90 mb-1",children:"Average Score"}),(0,E.jsxs)("p",{className:"text-3xl font-bold",children:[a.filter(e=>e.graded).length>0?Math.round(a.filter(e=>e.graded).reduce((e,t)=>e+(t.score||0),0)/a.filter(e=>e.graded).length):"-",a.filter(e=>e.graded).length>0&&"%"]})]})]})]})]}):(0,E.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,E.jsxs)("div",{className:"text-center py-12",children:[(0,E.jsx)(w,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,E.jsx)("p",{className:"text-gray-500 text-lg font-medium",children:"No Exams Available"}),(0,E.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:"Your instructor hasn't created any exams yet"}),(0,E.jsx)("button",{onClick:s,className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition",children:"Refresh"})]})})}function Mh(e){let{icon:t,title:r,value:n,color:a}=e;return(0,E.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:r}),(0,E.jsx)("p",{className:"text-3xl font-bold text-gray-800",children:n})]}),(0,E.jsx)("div",{className:"w-14 h-14 ".concat(a," rounded-lg flex items-center justify-center text-white"),children:t})]})})}function Fh(e){let{user:t,attendance:r,results:n,announcements:a,messages:s,onRefresh:i}=e;const o=Nn(r);return(0,E.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,E.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,E.jsx)(Mh,{icon:(0,E.jsx)(_,{className:"w-6 h-6"}),title:"Attendance",value:"".concat(o,"%"),color:o>=75?"bg-green-500":o>=50?"bg-yellow-500":"bg-red-500"}),(0,E.jsx)(Mh,{icon:(0,E.jsx)(w,{className:"w-6 h-6"}),title:"Exams Taken",value:n.length,color:"bg-blue-500"})]}),(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Recent Exam Results"}),(0,E.jsx)("div",{className:"overflow-x-auto",children:(0,E.jsxs)("table",{className:"w-full",children:[(0,E.jsx)("thead",{className:"bg-gray-50",children:(0,E.jsxs)("tr",{children:[(0,E.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Exam"}),(0,E.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),(0,E.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Score"}),(0,E.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),(0,E.jsxs)("tbody",{className:"divide-y divide-gray-200",children:[n.slice(-5).reverse().map(e=>{const t=(r=e.score)>=85?{text:"High Pass",color:"bg-green-100 text-green-800"}:r>=50&&r<85?{text:"Low Pass Chance",color:"bg-yellow-100 text-yellow-800"}:{text:"Fail",color:"bg-red-100 text-red-800"};var r;return(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:e.exam_title}),(0,E.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:Tn(e.submitted_at)}),(0,E.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,E.jsxs)("span",{className:"font-semibold text-indigo-600",children:[e.score,"%"]})}),(0,E.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,E.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(t.color),children:t.text})})]},e.id)}),0===n.length&&(0,E.jsx)("tr",{children:(0,E.jsx)("td",{colSpan:"4",className:"px-4 py-8 text-center text-gray-500",children:"No exam results yet"})})]})]})})]})]}),(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,E.jsxs)("h2",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[(0,E.jsx)(dn,{className:"w-5 h-5 mr-2 text-indigo-600"}),"Announcements"]}),(0,E.jsxs)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[a.map(e=>(0,E.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-100",children:[(0,E.jsx)("h3",{className:"font-semibold text-gray-800 mb-1",children:e.title}),(0,E.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.message}),(0,E.jsx)("p",{className:"text-xs text-gray-400",children:Tn(e.created_at)})]},e.id)),0===a.length&&(0,E.jsx)("p",{className:"text-center text-gray-500 py-8",children:"No announcements"})]})]}),(0,E.jsxs)("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-lg shadow p-6 text-white",children:[(0,E.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Quick Stats"}),(0,E.jsxs)("div",{className:"space-y-3",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center",children:[(0,E.jsx)("span",{className:"text-indigo-100",children:"Present Days"}),(0,E.jsx)("span",{className:"font-bold text-2xl",children:r.filter(e=>"present"===e.status).length})]}),(0,E.jsxs)("div",{className:"flex justify-between items-center",children:[(0,E.jsx)("span",{className:"text-indigo-100",children:"Absent Days"}),(0,E.jsx)("span",{className:"font-bold text-2xl",children:r.filter(e=>"absent"===e.status).length})]}),(0,E.jsxs)("div",{className:"flex justify-between items-center",children:[(0,E.jsx)("span",{className:"text-indigo-100",children:"Total Exams"}),(0,E.jsx)("span",{className:"font-bold text-2xl",children:n.length})]})]})]})]})]})}function Uh(e){let{user:t,onLogout:r}=e;const[a,s]=(0,n.useState)("dashboard"),[i,o]=(0,n.useState)([]),[l,c]=(0,n.useState)([]),[u,d]=(0,n.useState)([]),[h,f]=(0,n.useState)([]),[m,p]=(0,n.useState)([]),[g,v]=(0,n.useState)(!0);(0,n.useEffect)(()=>{b()},[t.id]);const b=async()=>{try{v(!0);const[e,r,n,a,s]=await Promise.all([tn.from("attendance").select("*").eq("student_id",t.id).order("date",{ascending:!1}),tn.from("exams").select("*").order("created_at",{ascending:!1}),tn.from("results").select("*, exam_title").eq("student_id",t.id).order("submitted_at",{ascending:!1}),tn.from("announcements").select("*").order("created_at",{ascending:!1}),tn.from("messages").select("*").eq("recipient_id",t.id).order("created_at",{ascending:!1})]);e.data&&o(e.data),r.data&&c(r.data),n.data&&d(n.data),a.data&&f(a.data),s.data&&p(s.data)}catch(e){console.error("Error loading data:",e)}finally{v(!1)}};return g?(0,E.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-600 mx-auto"}),(0,E.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading Dashboard..."})]})}):(0,E.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[(0,E.jsx)(fn,{user:t,userType:"student",activeTab:a,setActiveTab:s,onLogout:r}),(0,E.jsxs)("main",{className:"flex-1 max-w-7xl w-full mx-auto px-4 py-6",children:["dashboard"===a&&(0,E.jsx)(Fh,{user:t,attendance:i,results:u,announcements:h,messages:m,onRefresh:b}),"attendance"===a&&(0,E.jsx)(Ah,{attendance:i}),"exam"===a&&(0,E.jsx)(Lh,{user:t,exams:l,results:u,onRefresh:b})]}),(0,E.jsx)(mn,{})]})}const zh=v("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]),Bh=v("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Hh=v("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Wh=v("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);function Vh(e){let{onNavigate:t,onLogout:r}=e;const[a,s]=(0,n.useState)(null),[i,o]=(0,n.useState)(!1),[l,u]=(0,n.useState)(!1),[d,h]=(0,n.useState)({}),[f,m]=(0,n.useState)({student_name:"",student_email:"",student_phone:"",roll_number:"",department:""});return(0,E.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:(0,E.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,E.jsxs)("div",{className:"mb-8 flex justify-between items-center",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:"Course Enrollment Portal"}),(0,E.jsx)("p",{className:"text-gray-600",children:"Browse and enroll in our available courses"})]}),(0,E.jsxs)("div",{className:"flex gap-3",children:[t&&(0,E.jsxs)("button",{onClick:()=>t("home"),className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition shadow-md",children:[(0,E.jsx)(zh,{size:20})," Home"]}),r&&(0,E.jsx)("button",{onClick:r,className:"flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition shadow-md",children:"Logout"})]})]}),i&&a&&(0,E.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8 mb-8 border-2 border-blue-200",children:[(0,E.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Enrollment Form"}),(0,E.jsxs)("p",{className:"text-gray-600 mb-6",children:["Enrolling in: ",(0,E.jsx)("span",{className:"font-semibold text-blue-600",children:a.title})]}),(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsxs)("div",{className:"bg-blue-50 p-6 rounded-lg",children:[(0,E.jsx)("h3",{className:"text-lg font-semibold text-blue-900 mb-4",children:"Student Information"}),(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),(0,E.jsx)("input",{type:"text",required:!0,value:f.student_name,onChange:e=>m(c(c({},f),{},{student_name:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your full name"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),(0,E.jsx)("input",{type:"email",required:!0,value:f.student_email,onChange:e=>m(c(c({},f),{},{student_email:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"your.email@example.com"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),(0,E.jsx)("input",{type:"tel",required:!0,value:f.student_phone,onChange:e=>m(c(c({},f),{},{student_phone:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+91 9876543210"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Roll Number *"}),(0,E.jsx)("input",{type:"text",required:!0,value:f.roll_number,onChange:e=>m(c(c({},f),{},{roll_number:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your roll number"})]}),(0,E.jsxs)("div",{className:"md:col-span-2",children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department *"}),(0,E.jsxs)("select",{required:!0,value:f.department,onChange:e=>m(c(c({},f),{},{department:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,E.jsx)("option",{value:"",children:"Select Department"}),(0,E.jsx)("option",{value:"Computer Science",children:"Computer Science"}),(0,E.jsx)("option",{value:"Information Technology",children:"Information Technology"}),(0,E.jsx)("option",{value:"AIML",children:"AIML"}),(0,E.jsx)("option",{value:"Cyber Security",children:"Cyber Security"}),(0,E.jsx)("option",{value:"Data Science",children:"Data Science"}),(0,E.jsx)("option",{value:"Electronics",children:"Electronics"}),(0,E.jsx)("option",{value:"Electrical",children:"Electrical"}),(0,E.jsx)("option",{value:"Mechanical",children:"Mechanical"}),(0,E.jsx)("option",{value:"Civil",children:"Civil"}),(0,E.jsx)("option",{value:"Other",children:"Other"})]})]})]})]}),(0,E.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200",children:[(0,E.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Course Summary"}),(0,E.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-gray-600",children:"Course Title"}),(0,E.jsx)("p",{className:"font-semibold",children:a.title})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-gray-600",children:"Instructor"}),(0,E.jsx)("p",{className:"font-semibold",children:a.instructor})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-gray-600",children:"Duration"}),(0,E.jsx)("p",{className:"font-semibold",children:a.duration})]})]})]}),(0,E.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,E.jsx)("button",{onClick:async()=>{if(f.student_name&&f.student_email&&f.student_phone&&f.roll_number&&f.department){u(!0);try{const{error:e}=await tn.from("course_enrollments").insert([{student_name:f.student_name,student_email:f.student_email,student_phone:f.student_phone,roll_number:f.roll_number,department:f.department,course_name:a.title}]);if(e)throw e;alert("\u2705 Enrollment successful! You have been enrolled in the course."),m({student_name:"",student_email:"",student_phone:"",roll_number:"",department:""}),o(!1),s(null)}catch(e){console.error("Error submitting enrollment:",e),alert("\u274c Error submitting enrollment: "+e.message)}finally{u(!1)}}else alert("Please fill all required fields")},disabled:l,className:"flex-1 py-3 rounded-lg font-semibold text-white transition shadow-lg ".concat(l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"),children:l?"Submitting...":"Submit Enrollment"}),(0,E.jsx)("button",{onClick:()=>{o(!1),s(null),m({student_name:"",student_email:"",student_phone:"",roll_number:"",department:""})},disabled:l,className:"flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-400 font-semibold transition disabled:opacity-50",children:"Cancel"})]})]})]}),(0,E.jsx)("div",{className:"mb-6",children:(0,E.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Available Courses"})}),(0,E.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{id:1,title:"Python Programming",description:"Master Python from basics to advanced concepts including OOP, data structures, and real-world applications.",instructor:"Gaddam Venu",duration:"8 weeks",image_url:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c3/Python-logo-notext.svg/1200px-Python-logo-notext.svg.png",syllabus:["Python Basics & Syntax","Data Types & Variables","Control Flow & Loops","Functions & Modules","Object-Oriented Programming","File Handling","Exception Handling","Libraries & Frameworks"]},{id:2,title:"Java Programming",description:"Learn Java programming, OOP concepts, collections, multithreading, and enterprise application development.",instructor:"Gaddam Venu",duration:"8 weeks",image_url:"https://logos-world.net/wp-content/uploads/2022/07/Java-Logo.png",syllabus:["Java Fundamentals","OOP Concepts","Collections Framework","Exception Handling","Multithreading","File I/O & Serialization","JDBC & Database","Spring Framework Basics"]},{id:3,title:"Generative AI",description:"Explore Gen AI, LLMs, prompt engineering, ChatGPT, and build AI-powered applications.",instructor:"Gaddam Venu",duration:"12 weeks",image_url:"https://www.unite.ai/wp-content/uploads/2023/03/Generative-AI.png",syllabus:["Introduction to AI & ML","Neural Networks Basics","Large Language Models (LLMs)","Prompt Engineering","ChatGPT & GPT Models","Image Generation (DALL-E, Stable Diffusion)","Fine-tuning Models","Embeddings & Vector Databases","RAG (Retrieval Augmented Generation)","AI Ethics & Safety","Building AI Applications","Project Development"]},{id:4,title:"Data Analytics",description:"Learn data analysis, statistics, Excel, SQL, and data visualization techniques for business insights.",instructor:"Gaddam Venu",duration:"8 weeks",image_url:"https://www.simplilearn.com/ice9/free_resources_article_thumb/Data-Analytics-vs-Data-Science.jpg",syllabus:["Introduction to Data Analytics","Excel for Data Analysis","Statistics & Probability","SQL & Database Queries","Data Cleaning & Preprocessing","Data Visualization","Business Intelligence","Analytics Projects"]},{id:5,title:"Power BI",description:"Master Power BI for data visualization, DAX formulas, creating interactive dashboards and reports.",instructor:"Gaddam Venu",duration:"8 weeks",image_url:"https://powerbi.microsoft.com/pictures/shared/social/social-default-image.png",syllabus:["Power BI Desktop Basics","Data Import & Transformation","Data Modeling","DAX Formulas & Calculations","Visual Design & Charts","Interactive Dashboards","Power BI Service","Advanced Analytics"]},{id:6,title:"C Programming",description:"Learn C programming fundamentals, pointers, memory management, and system-level programming.",instructor:"Gaddam Venu",duration:"8 weeks",image_url:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/C_Programming_Language.svg/1200px-C_Programming_Language.svg.png",syllabus:["C Basics & Syntax","Data Types & Operators","Control Structures","Functions","Arrays & Strings","Pointers","Structures & Unions","File Handling"]},{id:7,title:"Full Stack Development",description:"Complete full stack web development: HTML, CSS, JavaScript, React, Node.js, databases, and deployment.",instructor:"Gaddam Venu",duration:"8 weeks",image_url:"https://www.spec-india.com/wp-content/uploads/2020/06/Full_Stack.png",syllabus:["HTML5 & CSS3","JavaScript Fundamentals","React.js","Node.js & Express","MongoDB & Databases","RESTful APIs","Authentication & Security","Deployment & DevOps"]},{id:8,title:"Machine Learning",description:"Learn ML algorithms, supervised/unsupervised learning, model training, evaluation, and deployment.",instructor:"Gaddam Venu",duration:"8 weeks",image_url:"https://www.simplilearn.com/ice9/free_resources_article_thumb/Future_of_Machine_Learning.jpg",syllabus:["ML Fundamentals","Python for ML","Supervised Learning","Unsupervised Learning","Model Evaluation","Feature Engineering","Scikit-learn","ML Projects"]},{id:9,title:"Deep Learning",description:"Master neural networks, CNN, RNN, transformers, PyTorch/TensorFlow, and advanced AI models.",instructor:"Gaddam Venu",duration:"8 weeks",image_url:"https://www.simplilearn.com/ice9/free_resources_article_thumb/Deep-Learning-vs-Machine-Learning.jpg",syllabus:["Neural Networks Basics","Deep Learning Frameworks","Convolutional Neural Networks (CNN)","Recurrent Neural Networks (RNN)","LSTM & GRU","Transfer Learning","Transformers","Advanced DL Projects"]},{id:10,title:"Git & Version Control",description:"Master Git, GitHub, version control, branching, merging, collaboration, and DevOps workflows.",instructor:"Gaddam Venu",duration:"8 weeks",image_url:"https://git-scm.com/images/logos/downloads/Git-Logo-2Color.png",syllabus:["Git Fundamentals","Repository Management","Branching & Merging","GitHub & Remote Repos","Collaboration Workflows","Git Best Practices","CI/CD Basics","Advanced Git Techniques"]}].map(e=>(0,E.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2",children:[(0,E.jsx)("div",{className:"h-48 overflow-hidden bg-gray-100",children:(0,E.jsx)("img",{src:e.image_url,alt:e.title,className:"w-full h-full object-contain p-4",onError:e=>{e.target.src="https://via.placeholder.com/400x200?text=Course+Image"}})}),(0,E.jsxs)("div",{className:"p-6",children:[(0,E.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-3",children:e.title}),(0,E.jsx)("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:e.description}),(0,E.jsxs)("div",{className:"space-y-2 text-sm text-gray-700 mb-4",children:[(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)(Bh,{size:16,className:"text-blue-600"}),(0,E.jsx)("span",{className:"font-medium",children:"Instructor:"})," ",e.instructor]}),(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)(S,{size:16,className:"text-green-600"}),(0,E.jsx)("span",{className:"font-medium",children:"Duration:"})," ",e.duration]})]}),(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsxs)("button",{onClick:()=>{return t=e.id,void h(e=>c(c({},e),{},{[t]:!e[t]}));var t},className:"flex items-center justify-between w-full text-left text-sm font-semibold text-indigo-700 hover:text-indigo-900 transition",children:[(0,E.jsx)("span",{children:"\ud83d\udcda Course Syllabus"}),d[e.id]?(0,E.jsx)(Hh,{size:18}):(0,E.jsx)(Wh,{size:18})]}),d[e.id]&&(0,E.jsx)("div",{className:"mt-3 bg-gray-50 rounded-lg p-4 border border-gray-200",children:(0,E.jsx)("ul",{className:"space-y-2",children:e.syllabus.map((e,t)=>(0,E.jsxs)("li",{className:"text-sm text-gray-700 flex items-start gap-2",children:[(0,E.jsxs)("span",{className:"text-indigo-600 font-bold",children:[t+1,"."]}),(0,E.jsx)("span",{children:e})]},t))})})]}),(0,E.jsxs)("button",{onClick:()=>(e=>{s(e),o(!0),window.scrollTo({top:0,behavior:"smooth"})})(e),className:"w-full flex items-center justify-center gap-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-3 rounded-lg hover:from-blue-700 hover:to-indigo-700 transition shadow-md font-semibold",children:[(0,E.jsx)(S,{size:18})," Enroll Now"]})]})]},e.id))})]})})}function Gh(){const[e,t]=(0,n.useState)(null),[r,a]=(0,n.useState)("home"),[s,i]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(()=>{const e=localStorage.getItem("examPortalUser"),r=localStorage.getItem("coursePortalUser");if(e){const r=JSON.parse(e);t(r),"admin"===r.type?a("admin-dashboard"):a("student-dashboard")}else if(r){const e=JSON.parse(r);t(e),a("course-dashboard")}i(!1)})()},[]);const o=e=>{a(e)},l=(e,r)=>{t(e),localStorage.setItem("examPortalUser",JSON.stringify(c(c({},e),{},{type:r}))),a("admin"===r?"admin-dashboard":"student-dashboard")},u=e=>{t(e),localStorage.setItem("coursePortalUser",JSON.stringify(e)),a("course-dashboard")},d=()=>{t(null),localStorage.removeItem("examPortalUser"),localStorage.removeItem("coursePortalUser"),a("home")};if(s)return(0,E.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-600 mx-auto"}),(0,E.jsx)("p",{className:"mt-4 text-gray-600 font-medium",children:"Loading Portal..."})]})});return(0,E.jsx)("div",{className:"App",children:(()=>{switch(r){case"home":default:return(0,E.jsx)(T,{onNavigate:o});case"portal-selector":return(0,E.jsx)(N,{onNavigate:o});case"exam-login":return(0,E.jsx)(rn,{onLogin:l,onNavigate:o});case"course-login":return(0,E.jsx)(nn,{onLogin:u,onNavigate:o});case"course-signup":return(0,E.jsx)(sn,{onLogin:u,onNavigate:o});case"forgot-password":return(0,E.jsx)(ln,{onNavigate:o});case"admin-dashboard":return(0,E.jsx)(jh,{user:e,onLogout:d});case"student-dashboard":return(0,E.jsx)(Uh,{user:e,onLogout:d});case"course-dashboard":return(0,E.jsx)(Vh,{user:e,onLogout:d,onNavigate:o})}})()})}a.createRoot(document.getElementById("root")).render((0,E.jsx)(n.StrictMode,{children:(0,E.jsx)(Gh,{})}))})();
//# sourceMappingURL=main.e8de5ea6.js.map